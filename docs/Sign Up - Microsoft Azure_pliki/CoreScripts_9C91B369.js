/*!
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
function auxAjax(n){var t=n.error,r=function(n,i,r){var u=n.status;u==0||u==12017?window.location=window.location:t&&t(n,u,r)},i=$.extend({},n);return i.error=r,$.ajax(i)}function auxGet(n,t,i){var r={url:n,success:t,error:i};return auxAjax(r)}function auxPost(n,t,i,r){var u={url:n,type:"POST",data:r,success:t,error:i};return auxAjax(u)}function auxPostWithRetry(n,t,i,r,u){function e(){setTimeout(o,i)}function o(){f++;f<t?auxPost(n,function(n){r(n)||e()},e):u()}var f=0;o()}function getUriParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+n+"=([^&#]*)",r=new RegExp(i),t=r.exec(window.location.href);return t==null?null:decodeURIComponent(t[1].replace(/\+/g," "))}function joinKeyValuePairs(n,t,i){var r=$.map(i||"",function(n,i){return i+t+n});return r.join(n)}function buildQueryString(n){var t=$.extend(!0,{},n);for(var i in t)t[i]||delete t[i];return $.param(t)}function buildWindowFeatures(n){return joinKeyValuePairs(",","=",n)}function appendQueryString(n,t){var u=buildQueryString(t),i,r;return n?(r=n.lastIndexOf("?"),i=r<0?"?":r==n.length-1?"":"&"):(n="",i="?"),n+i+u}function auxQuerySiteStatus(n,t){t&&$.ajax({type:"GET",url:"/Status?l="+(n||""),success:function(n){t(n)},error:function(){t(null)}})}function showLiveLoginPopupWindow(n,t){var i,u;n.preventDefault();i={width:525,height:475,offset:{}};i.offset.left=$(window).width()/2-i.width/2;i.offset.top=$(window).height()/2-(i.height+50)/2;var r={left:n.screenX-n.pageX+i.offset.left,top:n.screenY-n.pageY+i.offset.top,width:i.width,height:i.height},f=appendQueryString(t.livePopupUrl,{popupui:1}),e=buildWindowFeatures({scrollbars:"yes",resizable:"yes",width:r.width,height:r.height,left:r.left,top:r.top});window.auxmaster=!0;u=window.open(f,null,e);u?refreshIfWindowIsClosed(u,t.redirectUrl):window.location=t.liveThisUrl}function refreshIfWindowIsClosed(n,t){n&&setTimeout(function(){n.closed?window.document.location=t?t:window.document.location.href.split("#")[0]:refreshIfWindowIsClosed(n)},1e3)}function onLogOnComplete(n){var t,i;window.opener&&window.opener.opener&&!window.opener.opener.closed&&window.opener.opener.auxmaster?(t=window.opener.opener,window.opener.closed||window.opener.close()):window.opener&&!window.opener.closed&&(t=window.opener);t&&(i=getUriParameterByName("redirectUrl"),i||(i=t.document.location.href.split("#")[0]),t.setupForLongTimeout(n),t.document.location=i);self.close()}function continuePurchase(n){$(window).unbind("resize",resizePcsWindow);$("#the-pcs-container").hide();$("#dialog").fadeTo(350,1,function(){$.wizard()&&$.wizard().showProgress()});auxGet(n.returnUrl,function(n){$(".wizard-step:visible").html(n)});jQuery.auxAnalytics.track.pcsComplete()}function setUpPcs(){}function dismissSelfAndWizard(){this.window.parent?this.window.parent.dismissSelfAndWizardHelper():(resizePcsWindow&&$(window).unbind("resize",resizePcsWindow),removePCSOnEscapeHandler&&$(document).bind("keypress",removePCSOnEscapeHandler))}function dismissSelfAndWizardHelper(){$("#the-pcs-container").hide();$.wizard()&&$.wizard().close();resizePcsWindow&&$(window).unbind("resize",resizePcsWindow);removePCSOnEscapeHandler&&$(document).bind("keypress",removePCSOnEscapeHandler);jQuery.auxAnalytics.track.pcsCancel()}function reloadIframe(){var n=$("#the-pcs");loadIframe(n.attr("src"))}function loadIframe(n,t){(t==null||t==!1)&&$.wizard()&&$.wizard().showProgress();$(window).bind("resize",resizePcsWindow);$(document).bind("keypress",removePCSOnEscapeHandler);var i=$("#the-pcs-container");$("#the-pcs",i).attr("src",n);$("#the-pcs",i).load(function(){setTimeout(function(){i.css("margin-left")===OUTSIDE_SCREEN_PIXELS&&resizePcsWindow()},1e4)});i.css("margin-left",OUTSIDE_SCREEN_PIXELS).css("margin-top",OUTSIDE_SCREEN_PIXELS).show()}function ensurePcsHeight(n){var t=Math.max(n,$("#the-pcs").height());setPcsHeight(t)}function setPcsHeight(n){$.wizard()&&$.wizard().hide();$("#the-pcs").height(n);var t=$("#the-pcs-container"),e=t.css("margin-left"),o=t.css("margin-top"),u=t.width()>$(window).width()?$(window).width():t.width(),f=t.height()>$(window).height()?$(window).height():t.height(),i=-(u/2)+$(window).scrollLeft(),r=-(f/2)+$(window).scrollTop();t.css("margin-left")==OUTSIDE_SCREEN_PIXELS&&t.css("margin-top")==OUTSIDE_SCREEN_PIXELS?t.hide().css("margin-left",i).css("margin-top",r).css("z-index",99999).fadeIn(250):t.css("margin-left",i).css("margin-top",r).css("z-index",99999)}function GEId(n){return document.getElementById(n)}function exists(n){return n?!0:n===0||n===!1||n===""}function isString(n){return typeof n=="string"}function isFunction(n){return"function"==typeof n}function arrExists(n,t){var r,u,i;if(!exists(n))return!1;for(r=isArray(t)?t:arguments,u=isArray(t)?0:1,i=u;i<r.length;i++){if(!exists(r[i])||!exists(n[r[i]]))return!1;n=n[r[i]]}return!0}function isArray(n){return n instanceof Array}function getSessionCookie(n){var t=new RegExp(n+"=[^;]+","i");return document.cookie.match(t)?document.cookie.match(t)[0].split("=")[1]:""}function setSessionCookie(n,t){document.cookie=n+"="+t+"; path=/"}function setupForLongTimeout(n){clearTimeout(timeoutId);var t=(new Date).getTime();setSessionCookie(timeoutStartCookieName,t.toString());setSessionCookie(isLongTimeoutCookieName,"1");setupSetTimeout(n)}function authCheck(n){auxPost(n,function(){});var t=(new Date).getTime();setSessionCookie(timeoutStartCookieName,t.toString(),1);setupSetTimeout(n)}function startTimeoutCheckPolling(n){var r=getSessionCookie(timeoutStartCookieName),t=!1,i;getUriParameterByName("wa")=="wsignin1.0"?(isLongTimeout="1",t=!0):r==""&&(isLongTimeout="",t=!0);t&&(i=(new Date).getTime(),setSessionCookie(timeoutStartCookieName,i.toString(),1),setSessionCookie(isLongTimeoutCookieName,isLongTimeout,1));setupSetTimeout(n)}function setupSetTimeout(n){var r=parseInt(getSessionCookie(timeoutStartCookieName)),u=getSessionCookie(isLongTimeoutCookieName),f=(new Date).getTime(),t,i;t=u!=""?6e5:6e4;i=Math.max(r+t-f,0);timeoutId=setTimeout(function(){authCheck(n)},i)}function WebTrends(){var t=this,n;this.dcsid=typeof gDcsId!="undefined"&&gDcsId?gDcsId:"not_a_valid_dcsid";this.domain=typeof gDomain!="undefined"&&gDomain?gDomain:"m.webtrends.com";this.timezone=typeof gTimeZone!="undefined"&&gTimeZone?gTimeZone:-8;this.fpcdom=typeof gFpcDom!="undefined"&&gFpcDom?gFpcDom:/microsoft.com$/.test(window.location.hostname)?".microsoft.com":window.location.hostname;typeof gOffsite!="undefined"&&gOffsite&&(gOffsite==!0||gOffsite=="true")&&(this.fpcdom="");this.navigationtag="div,table";this.trackevents=typeof gTrackEvents!="undefined"&&gTrackEvents&&(gTrackEvents==1||gTrackEvents=="1")?!0:!0;this.trackanchor=typeof gTrackAnchor!="undefined"&&gTrackAnchor&&(gTrackAnchor==1||gTrackAnchor=="1")?!0:!0;this.onsitedoms="www.microsoft.com";this.evi={cookie:"MC1, A",qp:"WT.dcsvid, WT.z_Acookie",crumb:"",sep:""};this.enabled=!0;this.i18n=!0;this.fpc="WT_FPC";this.paidsearchparams="gclid";this.DCS={};this.WT={};n=this.dcsGetCookie("hp");this.DCSext={PUID:n};this.DCSdir={};this.images=[];this.index=0;this.qp=[];this.exre=function(){return window.RegExp?new RegExp("dcs(uri)|(ref)|(aut)|(met)|(sta)|(sip)|(pro)|(byt)|(dat)|(p3p)|(cfg)|(redirect)|(cip)","i"):""}();this.re=function(){return window.RegExp?t.i18n?{"%25":/\%/g,"%23":/\#/g,"%26":/\&/g}:{"%09":/\t/g,"%20":/ /g,"%23":/\#/g,"%26":/\&/g,"%2B":/\+/g,"%3F":/\?/g,"%5C":/\\/g,"%22":/\"/g,"%7F":/\x7F/g,"%A0":/\xA0/g}:""}();this.gTempWtId="";this.gWtId="";this.gWtAccountRollup="";this.q=function(){return typeof dcsQ!="undefined"?dcsQ:[{cmd:"collect"}]}()}function dcsMultiTrack(){if(typeof _tag!="undefined")return _tag.dcsMultiTrack()}function dcsEscape(n){if(typeof _tag!="undefined")return _tag.dcsEscape(n)}function dcsEncode(n){if(typeof _tag!="undefined")return _tag.dcsEncode(n)}function dcsSetVar(){if(window._tag&&_tag.dcsMSSetVar)return _tag.dcsMSSetVar()}function dcsCallback(n){typeof n!="undefined"&&(_tag.gTempWtId=n.gTempWtId,_tag.gWtId=n.gWtId,_tag.gWtAccountRollup=n.gWtAccountRollup);_tag.q.push=function(n){Array.prototype.push.call(this,n);_tag.dcsDQ()};_tag.dcsDQ()}var resizePcsWindow,removePCSOnEscapeHandler,OUTSIDE_SCREEN_PIXELS,timeoutStartCookieName,isLongTimeoutCookieName,timeoutId,_tag;jQuery.cookie=function(n,t,i){var f,r,e,o,u,s;if(typeof t!="undefined"){i=i||{};t===null&&(t="",i.expires=-1);f="";i.expires&&(typeof i.expires=="number"||i.expires.toUTCString)&&(typeof i.expires=="number"?(r=new Date,r.setTime(r.getTime()+i.expires*864e5)):r=i.expires,f="; expires="+r.toUTCString());var h=i.path?"; path="+i.path:"",c=i.domain?"; domain="+i.domain:"",l=i.secure?"; secure":"";document.cookie=[n,"=",encodeURIComponent(t),f,h,c,l].join("")}else{if(e=null,document.cookie&&document.cookie!="")for(o=document.cookie.split(";"),u=0;u<o.length;u++)if(s=jQuery.trim(o[u]),s.substring(0,n.length+1)==n+"="){e=decodeURIComponent(s.substring(n.length+1));break}return e}},function(n){n.extend(n.fn,{validate:function(t){if(this.length){var i=n.data(this[0],"validator");return i?i:(this.attr("novalidate","novalidate"),i=new n.validator(t,this[0]),n.data(this[0],"validator",i),i.settings.onsubmit&&(t=this.find("input, button"),t.filter(".cancel").click(function(){i.cancelSubmit=!0}),i.settings.submitHandler&&t.filter(":submit").click(function(){i.submitButton=this}),this.submit(function(t){function r(){if(i.settings.submitHandler){if(i.submitButton)var t=n("<input type='hidden'/>").attr("name",i.submitButton.name).val(i.submitButton.value).appendTo(i.currentForm);return i.settings.submitHandler.call(i,i.currentForm),i.submitButton&&t.remove(),!1}return!0}return(i.settings.debug&&t.preventDefault(),i.cancelSubmit)?(i.cancelSubmit=!1,r()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):r():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(n(this[0]).is("form"))return this.validate().form();var t=!0,i=n(this[0].form).validate();return this.each(function(){t&=i.element(this)}),t},removeAttrs:function(t){var i={},r=this;return n.each(t.split(/\s/),function(n,t){i[t]=r.attr(t);r.removeAttr(t)}),i},rules:function(t,i){var r=this[0],e;if(t){var u=n.data(r.form,"validator").settings,o=u.rules,f=n.validator.staticRules(r);switch(t){case"add":n.extend(f,n.validator.normalizeRule(i));o[r.name]=f;i.messages&&(u.messages[r.name]=n.extend(u.messages[r.name],i.messages));break;case"remove":return i?(e={},n.each(i.split(/\s/),function(n,t){e[t]=f[t];delete f[t]}),e):(delete o[r.name],f)}}return r=n.validator.normalizeRules(n.extend({},n.validator.metadataRules(r),n.validator.classRules(r),n.validator.attributeRules(r),n.validator.staticRules(r)),r),r.required&&(u=r.required,delete r.required,r=n.extend({required:u},r)),r}});n.extend(n.expr[":"],{blank:function(t){return!n.trim(""+t.value)},filled:function(t){return!!n.trim(""+t.value)},unchecked:function(n){return!n.checked}});n.validator=function(t,i){this.settings=n.extend(!0,{},n.validator.defaults,t);this.currentForm=i;this.init()};n.validator.format=function(t,i){return arguments.length==1?function(){var i=n.makeArray(arguments);return i.unshift(t),n.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!=Array&&(i=n.makeArray(arguments).slice(1)),i.constructor!=Array&&(i=[i]),n.each(i,function(n,i){t=t.replace(RegExp("\\{"+n+"\\}","g"),i)}),t)};n.extend(n.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:n([]),errorLabelContainer:n([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(n){this.lastActive=n;this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,n,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(n)).hide())},onfocusout:function(n){!this.checkable(n)&&(n.name in this.submitted||!this.optional(n))&&this.element(n)},onkeyup:function(n){(n.name in this.submitted||n==this.lastElement)&&this.element(n)},onclick:function(n){n.name in this.submitted?this.element(n):n.parentNode.name in this.submitted&&this.element(n.parentNode)},highlight:function(t,i,r){t.type==="radio"?this.findByName(t.name).addClass(i).removeClass(r):n(t).addClass(i).removeClass(r)},unhighlight:function(t,i,r){t.type==="radio"?this.findByName(t.name).removeClass(i).addClass(r):n(t).removeClass(i).addClass(r)}},setDefaults:function(t){n.extend(n.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:n.validator.format("Please enter no more than {0} characters."),minlength:n.validator.format("Please enter at least {0} characters."),rangelength:n.validator.format("Please enter a value between {0} and {1} characters long."),range:n.validator.format("Please enter a value between {0} and {1}."),max:n.validator.format("Please enter a value less than or equal to {0}."),min:n.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function i(t){var i=n.data(this[0].form,"validator"),r="on"+t.type.replace(/^validate/,"");i.settings[r]&&i.settings[r].call(i,this[0],t)}var r,t;this.labelContainer=n(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||n(this.currentForm);this.containers=n(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();r=this.groups={};n.each(this.settings.groups,function(t,i){n.each(i.split(/\s/),function(n,i){r[i]=t})});t=this.settings.rules;n.each(t,function(i,r){t[i]=n.validator.normalizeRule(r)});n(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",i).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",i);this.settings.invalidHandler&&n(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),n.extend(this.submitted,this.errorMap),this.invalid=n.extend({},this.errorMap),this.valid()||n(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var n=0,t=this.currentElements=this.elements();t[n];n++)this.check(t[n]);return this.valid()},element:function(t){this.lastElement=t=this.validationTargetFor(this.clean(t));this.prepareElement(t);this.currentElements=n(t);var i=this.check(t);return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){n.extend(this.errorMap,t);this.errorList=[];for(var i in t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=n.grep(this.successList,function(n){return!(n.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){n.fn.resetForm&&n(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(n){var t=0;for(var i in n)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{n(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&n.grep(this.errorList,function(n){return n.element.name==t.name}).length==1&&t},elements:function(){var t=this,i={};return n(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return(!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!t.objectLength(n(this).rules()))?!1:i[this.name]=!0})},clean:function(t){return n(t)[0]},errors:function(){return n(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=n([]);this.toHide=n([]);this.currentElements=n([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(n){this.reset();this.toHide=this.errorsFor(n)},check:function(t){var i,r,u,f,e;t=this.validationTargetFor(this.clean(t));i=n(t).rules();r=!1;for(u in i){f={method:u,parameters:i[u]};try{if(e=n.validator.methods[u].call(this,t.value.replace(/\r/g,""),t,f.parameters),e=="dependency-mismatch")r=!0;else{if(r=!1,e=="pending"){this.toHide=this.toHide.not(this.errorsFor(t));return}if(!e)return this.formatAndAdd(t,f),!1}}catch(o){this.settings.debug&&window.console&&console.log("exception occured when checking element "+t.id+", check the '"+f.method+"' method",o);throw o;}}if(!r)return this.objectLength(i)&&this.successList.push(t),!0},customMetaMessage:function(t,i){if(n.metadata){var r=this.settings.meta?n(t).metadata()[this.settings.meta]:n(t).metadata();return r&&r.messages&&r.messages[i]}},customMessage:function(n,t){var i=this.settings.messages[n];return i&&(i.constructor==String?i:i[t])},findDefined:function(){for(var n=0;n<arguments.length;n++)if(arguments[n]!==undefined)return arguments[n]},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customMetaMessage(t,i),!this.settings.ignoreTitle&&t.title||undefined,n.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"<\/strong>")},formatAndAdd:function(n,t){var i=this.defaultMessage(n,t.method),r=/\$?\{(\d+)\}/g;typeof i=="function"?i=i.call(this,t.parameters,n):r.test(i)&&(i=jQuery.format(i.replace(r,"{$1}"),t.parameters));this.errorList.push({message:i,element:n});this.errorMap[n.name]=i;this.submitted[n.name]=i},addWrapper:function(n){return this.settings.wrapper&&(n=n.add(n.parent(this.settings.wrapper))),n},defaultShowErrors:function(){for(var t,n=0;this.errorList[n];n++)t=this.errorList[n],this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(n=0;this.successList[n];n++)this.showLabel(this.successList[n]);if(this.settings.unhighlight)for(n=0,t=this.validElements();t[n];n++)this.settings.unhighlight.call(this,t[n],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return n(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var r=this.errorsFor(t);r.length?(r.removeClass(this.settings.validClass).addClass(this.settings.errorClass),r.attr("generated")&&r.html(i)):(r=n("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:!0}).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(r).length||(this.settings.errorPlacement?this.settings.errorPlacement(r,n(t)):r.insertAfter(t)));!i&&this.settings.success&&(r.text(""),typeof this.settings.success=="string"?r.addClass(this.settings.success):this.settings.success(r));this.toShow=this.toShow.add(r)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return n(this).attr("for")==i})},idOrName:function(n){return this.groups[n.name]||(this.checkable(n)?n.name:n.id||n.name)},validationTargetFor:function(n){return this.checkable(n)&&(n=this.findByName(n.name).not(this.settings.ignore)[0]),n},checkable:function(n){return/radio|checkbox/i.test(n.type)},findByName:function(t){var i=this.currentForm;return n(document.getElementsByName(t)).map(function(n,r){return r.form==i&&r.name==t&&r||null})},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return n("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(n,t){return this.dependTypes[typeof n]?this.dependTypes[typeof n](n,t):!0},dependTypes:{boolean:function(n){return n},string:function(t,i){return!!n(t,i.form).length},"function":function(n,t){return n(t)}},optional:function(t){return!n.validator.methods.required.call(this,n.trim(t.value),t)&&"dependency-mismatch"},startRequest:function(n){this.pending[n.name]||(this.pendingRequest++,this.pending[n.name]=!0)},stopRequest:function(t,i){this.pendingRequest--;this.pendingRequest<0&&(this.pendingRequest=0);delete this.pending[t.name];i&&this.pendingRequest==0&&this.formSubmitted&&this.form()?(n(this.currentForm).submit(),this.formSubmitted=!1):!i&&this.pendingRequest==0&&this.formSubmitted&&(n(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return n.data(t,"previousValue")||n.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor==String?this.classRuleSettings[t]=i:n.extend(this.classRuleSettings,t)},classRules:function(t){var i={};return(t=n(t).attr("class"))&&n.each(t.split(" "),function(){this in n.validator.classRuleSettings&&n.extend(i,n.validator.classRuleSettings[this])}),i},attributeRules:function(t){var r={},i,u;t=n(t);for(i in n.validator.methods)(u=i==="required"&&typeof n.fn.prop=="function"?t.prop(i):t.attr(i))?r[i]=u:t[0].getAttribute("type")===i&&(r[i]=!0);return r.maxlength&&/-1|2147483647|524288/.test(r.maxlength)&&delete r.maxlength,r},metadataRules:function(t){if(!n.metadata)return{};var i=n.data(t.form,"validator").settings.meta;return i?n(t).metadata()[i]:n(t).metadata()},staticRules:function(t){var i={},r=n.data(t.form,"validator");return r.settings.rules&&(i=n.validator.normalizeRule(r.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return n.each(t,function(r,u){if(u===!1)delete t[r];else if(u.param||u.depends){var f=!0;switch(typeof u.depends){case"string":f=!!n(u.depends,i.form).length;break;case"function":f=u.depends.call(i,i)}f?t[r]=u.param!==undefined?u.param:!0:delete t[r]}}),n.each(t,function(r,u){t[r]=n.isFunction(u)?u(i):u}),n.each(["minlength","maxlength","min","max"],function(){t[this]&&(t[this]=Number(t[this]))}),n.each(["rangelength","range"],function(){t[this]&&(t[this]=[Number(t[this][0]),Number(t[this][1])])}),n.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t.messages&&delete t.messages,t},normalizeRule:function(t){if(typeof t=="string"){var i={};n.each(t.split(/\s/),function(){i[this]=!0});t=i}return t},addMethod:function(t,i,r){n.validator.methods[t]=i;n.validator.messages[t]=r!=undefined?r:n.validator.messages[t];i.length<3&&n.validator.addClassRules(t,n.validator.normalizeRule(t))},methods:{required:function(t,i,r){if(!this.depend(r,i))return"dependency-mismatch";switch(i.nodeName.toLowerCase()){case"select":return(t=n(i).val())&&t.length>0;case"input":if(this.checkable(i))return this.getLength(t,i)>0;default:return n.trim(t).length>0}},remote:function(t,i,r){var f,u,e;return this.optional(i)?"dependency-mismatch":(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=typeof r=="string"&&{url:r}||r,this.pending[i.name])?"pending":f.old===t?f.valid:(f.old=t,u=this,this.startRequest(i),e={},e[i.name]=t,n.ajax(n.extend(!0,{url:r,mode:"abort",port:"validate"+i.name,dataType:"json",data:e,success:function(r){var o,e;u.settings.messages[i.name].remote=f.originalMessage;o=r===!0;o?(e=u.formSubmitted,u.prepareElement(i),u.formSubmitted=e,u.successList.push(i),u.showErrors()):(e={},r=r||u.defaultMessage(i,"remote"),e[i.name]=f.message=n.isFunction(r)?r(t):r,u.showErrors(e));f.valid=o;u.stopRequest(i,o)}},r)),"pending")},minlength:function(t,i,r){return this.optional(i)||this.getLength(n.trim(t),i)>=r},maxlength:function(t,i,r){return this.optional(i)||this.getLength(n.trim(t),i)<=r},rangelength:function(t,i,r){return t=this.getLength(n.trim(t),i),this.optional(i)||t>=r[0]&&t<=r[1]},min:function(n,t,i){return this.optional(t)||n>=i},max:function(n,t,i){return this.optional(t)||n<=i},range:function(n,t,i){return this.optional(t)||n>=i[0]&&n<=i[1]},email:function(n,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(n)},url:function(n,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(n)},date:function(n,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(n))},dateISO:function(n,t){return this.optional(t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(n)},number:function(n,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(n)},digits:function(n,t){return this.optional(t)||/^\d+$/.test(n)},creditcard:function(n,t){var r;if(this.optional(t))return"dependency-mismatch";if(/[^0-9 -]+/.test(n))return!1;var f=0,i=0,u=!1;for(n=n.replace(/\D/g,""),r=n.length-1;r>=0;r--)i=n.charAt(r),i=parseInt(i,10),u&&(i*=2)>9&&(i-=9),f+=i,u=!u;return f%10==0},accept:function(n,t,i){return i=typeof i=="string"?i.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||n.match(RegExp(".("+i+")$","i"))},equalTo:function(t,i,r){return r=n(r).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){n(i).valid()}),t==r.val()}}});n.format=n.validator.format}(jQuery),function(n){var t={},i;n.ajaxPrefilter?n.ajaxPrefilter(function(n,i,r){i=n.port;n.mode=="abort"&&(t[i]&&t[i].abort(),t[i]=r)}):(i=n.ajax,n.ajax=function(r){var u=("port"in r?r:n.ajaxSettings).port;return("mode"in r?r:n.ajaxSettings).mode=="abort"?(t[u]&&t[u].abort(),t[u]=i.apply(this,arguments)):i.apply(this,arguments)})}(jQuery),function(n){jQuery.event.special.focusin||jQuery.event.special.focusout||!document.addEventListener||n.each({focus:"focusin",blur:"focusout"},function(t,i){function r(t){return t=n.event.fix(t),t.type=i,n.event.handle.call(this,t)}n.event.special[i]={setup:function(){this.addEventListener(t,r,!0)},teardown:function(){this.removeEventListener(t,r,!0)},handler:function(t){return arguments[0]=n.event.fix(t),arguments[0].type=i,n.event.handle.apply(this,arguments)}}});n.extend(n.fn,{validateDelegate:function(t,i,r){return this.bind(i,function(i){var u=n(i.target);if(u.is(t))return r.apply(u,arguments)})}})}(jQuery),function(n,t){n.extend({auxAnalytics:{track:{welcomeClose:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Close-Abandon","WT.z_iLinks_targetcampaign","src-suint"),t.dcsMultiTrack())},welcomeNext:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-suint"),t.dcsMultiTrack())},verifyClose:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Close-Abandon","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack())},verifyNext:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack())},verifyCreateOrUpdateAccount:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Azure Account Created","WT.z_iLinks_actionoffer","Text-Continue","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=300","ms.scvalue="+n+" | step 300 : Azure-Account-Created")},addSubscription:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(dcsSetVar("WT.z_iLinks","add subscription","WT.z_iLinks_actionoffer","add-subscription-wizard","WT.z_iLinks_targetcampaign","src-acctsub"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct=Add-Subscription","ms.scnum=70","ms.scvalue=Add-Subscription | step 70 : Add Subscription")},selectSupportOptions:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Select Support Options","WT.z_iLinks_actionoffer","Select-Explore-Support-Offers","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct=Azure_Support","ms.scnum=80","ms.scvalue=Azure_Support | step 80 : Select-Explore-Support-Offers")},displayOfferCatalog:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Display SignupCatalogPage","WT.z_iLinks_actionoffer","Show-Signup-Catalog-Page:"+n,"WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=90","ms.scvalue="+n+" | step 90 : Show-Signup-Catalog-Page")},displaySignupPage:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Display SignupPage","WT.z_iLinks_actionoffer","Show-Signup-Page","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=100","ms.scvalue="+n+" | step 100 : Show-Signup-Page")},displaySmsChallenge:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Display SmsChallenge","WT.z_iLinks_actionoffer","Show-Sms-Challenge","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=201","ms.scvalue="+n+" | step 201 : Show-Sms-Challenge")},verifySmsSend:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Send Text Button","WT.z_iLinks_actionoffer","Text-Continue","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=202","ms.scvalue="+n+" | step 202 : Sms-Send-Text-Button")},verifySmsCode:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Verify Code Button","WT.z_iLinks_actionoffer","Verify-Continue","WT.z_iLinks_targetcampaign","src-suver"),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=203","ms.scvalue="+n+" | step 203 : Verify-Sms-Code-Button")},pcsCancel:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_iLinks","Cancel Button","WT.z_iLinks_actionoffer","Close-Abandon","WT.z_iLinks_targetcampaign","src-supay"),t.dcsMultiTrack())},pcsComplete:function(){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Submit  Information","WT.z_ea_actionoffer","Signup-Complete","WT.z_ea_targetcampaign","src-supay"),t.dcsMultiTrack())},displayNewPI:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Display New Payment Information","WT.z_ea_actionoffer","Display-New-PI","WT.z_ea_targetcampaign","src-supay","WT.z_iLinks","","WT.z_iLinks_actionoffer","","WT.z_iLinks_targetcampaign",""),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=401","ms.scvalue="+n+" | step 401 : Display-New-PI")},completeAddNewPI:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Complete Adding New Payment Information","WT.z_ea_actionoffer","Complete-Add-New-PI","WT.z_ea_targetcampaign","src-supay","WT.z_iLinks","","WT.z_iLinks_actionoffer","","WT.z_iLinks_targetcampaign",""),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=402","ms.scvalue="+n+" | step 402 : Complete-Add-New-PI")},signupComplete:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Submit  Information","WT.z_ea_actionoffer","Signup-Complete","WT.z_ea_targetcampaign","src-supay","WT.z_iLinks","","WT.z_iLinks_actionoffer","","WT.z_iLinks_targetcampaign",""),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=500","ms.scvalue="+n+" | step 500 : Signup-Complete")},purchaseComplete:function(n,i){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Purchase Complete","WT.z_ea_actionoffer","Purchase-Complete","WT.z_ea_targetcampaign","src-supay","DCSext.MSID",n,"WT.z_iLinks","","WT.z_iLinks_actionoffer","","WT.z_iLinks_targetcampaign",""),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+i,"ms.scnum=601","ms.scvalue="+i+" | step 601 : Purchase-Complete")},purchaseIncomplete:function(n){t&&t.dcsSetVar&&t.dcsMultiTrack&&(t.dcsSetVar("WT.z_ea_name","Purchase Not Completed","WT.z_ea_actionoffer","Purchase-Complete","WT.z_ea_targetcampaign","src-supay","WT.z_iLinks","","WT.z_iLinks_actionoffer","","WT.z_iLinks_targetcampaign",""),t.dcsMultiTrack());MscomCustomEvent!==undefined&&MscomCustomEvent&&MscomCustomEvent("ms.scnct="+n,"ms.scnum=602","ms.scvalue="+n+" | step 602 : Purchase-Not-Completed")}}}})}(jQuery,window);$.extend({namespace:{register:function(n,t){var u=$.isArray(n)&&n||n.split("."),r=u.shift(),i;return t=t||window,r&&(i=t[r],i||(i={}),t[r]=$.namespace.register(u,i)),t}}});$.namespace.register("Alert.Index");$.namespace.register("Alert.Form");$.namespace.register("Alert.ListItem");$.namespace.register("LocSelect");$.namespace.register("Profile.Index");$.namespace.register("Profile.EditTaxRecord");$.namespace.register("Signup.BotChallenge");$.namespace.register("Signup.Index");$.namespace.register("Signup.WelcomeToAzure");$.namespace.register("Signup2.Index");$.namespace.register("Signup2.MonetaryCommitment");$.namespace.register("Signup2.SubscriptionPurchaseTracker");$.namespace.register("Signup2.PaymentStatus");$.namespace.register("Subscriptions.Statement");$.namespace.register("Subscriptions.MonetaryCommitment");$.namespace.register("Subscriptions.Renew");$.namespace.register("Subscriptions.RemoveSpendingLimit");$.namespace.register("Subscriptions.Index");$.namespace.register("Subscriptions.EditDetails");$.namespace.register("Subscriptions.ChangeRenewalDetails");$.namespace.register("Subscriptions.ChangeUnits");$.namespace.register("Subscriptions.ChangePaymentMethod");$.namespace.register("Subscriptions.Cancel");$.namespace.register("Subscriptions.ActivateAzure");$.namespace.register("Subscriptions.AddFunds");$.namespace.register("Subscriptions.ReloadPrepaidBalance");$.namespace.register("Subscriptions.ChangeSpendingLimit");$.namespace.register("Subscriptions.PartnerInformation");$.namespace.register("BetaFeatures.Index");$.namespace.register("BetaFeatures.SignupForBetaFeature");$.namespace.register("Tenant.CreateTenant");$.namespace.register("CustomerFeedback");$.namespace.register("Address.Change");$.namespace.register("Tenant.SelectList");window.console||(window.console={log:function(){}});String.prototype.format=function(){for(var n=this,t=arguments.length;t--;)n=n.replace(new RegExp("\\{"+t+"\\}","gm"),arguments[t]);return n},function(n){n(function(){var t=n(".site-search");t.length>0&&t.find("input:text").focus(function(){n(this).closest("form").addClass("focus")}).blur(function(){n(this).closest("form").removeClass("focus")})})}(jQuery);OUTSIDE_SCREEN_PIXELS="-10000px";resizePcsWindow=function(){setPcsHeight($("#the-pcs").height())};removePCSOnEscapeHandler=function(n){(n.keyCode||n.which)===27&&$("#the-pcs-container").hide()},function(n,t,i,r){"use strict";var u=t.prototype,f="aux-pcsv2",o="<div class='aux-pcsv2-content'><img class='aux-pcsv2-loading hide' src='' alt=''/><iframe frameborder='0' data-bind='attr: { src: data.pcsUrl }'><\/iframe><\/div>",s=25,e="performNextCallback";n.widget("aux.auxPcsv2",t,{options:{error:n.noop,navigation:n.noop,loaded:n.noop,heightChanged:n.noop,pcsUrl:"",loadingImageUrl:"",waitText:""},_viewModel:null,_subscriptions:[],_initialHeightSet:!1,_content:null,_iframe:null,_pcsDomain:"",_deferred:null,_performingNext:!1,_addEventListenerFunction:null,_attachEventFunction:null,_mostRecentHeight:null,_create:function(){var t=this;this._setViewModel(new n.aux.auxPcsv2.ViewModel);this._viewModel.pcsUrl.subscribe(function(n){if(this._pcsDomain=null,n){t._initialHeightSet=!1;var i=n.match(/^https?:\/\/[^:\/]*/i);i&&i.length===1&&(t._pcsDomain=i[0])}});this._setOption("pcsUrl",this.options.pcsUrl);this._setOption("loadingImageUrl",this.options.loadingImageUrl);this._setOption("waitText",this.options.waitText);r.addEventListener?(this._addEventListenerFunction=function(n){t._onMessageFromPcs.call(t,n)},r.addEventListener("message",this._addEventListenerFunction,!1)):r.attachEvent&&(this._attachEventFunction=function(n){t._onMessageFromPcs.call(t,n)},r.attachEvent("onmessage",this._attachEventFunction));this._iframe=this.element.addClass(f).html(o).find(".aux-pcsv2-content iframe").one("load",function(){n(this).addClass("aux-pcsv2-iframe-loaded")})[0];this._content=this.element.find(".aux-pcsv2-content");this.options.loadingImageUrl&&this._content.find(".aux-pcsv2-loading").attr({src:this.options.loadingImageUrl,alt:this.options.waitText}).removeClass("hide");i.applyBindings({data:this._viewModel,func:this},this.element[0]);u._create.call(this)},destroy:function(){this.element.empty().removeClass(f);this._addEventListenerFunction&&r.removeEventListener&&r.removeEventListener("message",this._addEventListenerFunction);this._attachEventFunction&&r.detachEvent&&r.detachEvent("onmessage",this._attachEventFunction);u.destroy.call(this)},getViewModel:function(){return this._viewModel},performNext:function(){var u=this,t,i,r;return this._performingNext!==!0?(this._performingNext=!0,this._deferred=n.Deferred(),t=this._deferred.promise(),t.always(function(){u._performingNext=!1}),i={Method:"Next",Callback:e,Parameter:""},r=JSON.stringify(i),this._postMessageToPCS(r),t):this._deferred?this._deferred.promise():void 0},_showPcsAndHideSpinner:function(){this._iframe&&n(this._iframe).css("visibility","visible");this.options.loadingImageUrl&&this._content.find(".aux-pcsv2-loading").attr({src:this.options.loadingImageUrl,alt:this.options.waitText}).addClass("hide")},_postMessageToPCS:function(n){var t=this._iframe.contentWindow;t&&t.postMessage(n,"*")},_onMessageFromPcs:function(t){var i="";if("domain"in t&&(i=t.domain),"origin"in t&&(i=t.origin),this._pcsDomain&&i.toLowerCase()===this._pcsDomain.toLowerCase()){var r=n.parseJSON(t.data),u=r.type?r.type:"",f=n.parseJSON(r.data);typeof u=="string"&&(u.toLowerCase()==="message"?this._handlePcsMessage(f):u.toLowerCase()==="api_return"&&this._handlePcsApiCallback(f))}},_handlePcsMessage:function(n){n.method==="pcs_onheightchange"?this._onPcsHeightChange(n):n.method==="pcs_onpagerenderednotify"?this._onPcsRenderedNotify(n):n.method==="pcs_onsuccess"?this._onPcsSuccess(n):n.method==="pcs_onerror"?this._onPcsError(n):n.method==="pcs_onnavigationrequired"&&this._onPcsNavigationRequired(n)},_handlePcsApiCallback:function(n){n.method===e&&n.Result==="invalid"&&this._deferred&&this._deferred.reject()},_onPcsRenderedNotify:function(n){n.errorcode&&n.errorcode!==""&&this._deferred&&this._deferred.reject();this._initialHeightSet=!1},_onPcsHeightChange:function(t){t&&t.height===this._mostRecentHeight||(this._mostRecentHeight=t.height,this._content.height(t.height+s),this.options.heightChanged&&this.options.heightChanged(t.height),this._initialHeightSet||(this._initialHeightSet=!0,n(this._iframe).css("visibility","visible"),this.options.loaded&&this.options.loaded(),this._showPcsAndHideSpinner()))},_onPcsSuccess:function(n){var t={piid:n.piid,accountid:n.accountid};this._deferred&&this._deferred.resolve(t)},_onPcsError:function(n){this.options.error&&this.options.error(n.errorcode)},_onPcsNavigationRequired:function(n){this.options.navigation&&this.options.navigation(n.redirecturl)},_setViewModel:function(n){this._viewModel=n},_setOption:function(n,t){var i=u._setOption.apply(this,arguments);return n==="pcsUrl"?this._viewModel.pcsUrl(t):n==="waitText"?this._viewModel.waitText=t:n==="loadingImageUrl"&&(this._viewModel.loadingImageUrl=t),i}});n.aux.auxPcsv2.ViewModel=function(){this.pcsUrl=i.observable();this.waitText="";this.loadingImageUrl=""}}(jQuery,jQuery.Widget,ko,this),function(n,t){"use strict";var i=t.prototype,r="aux-displaypibrief",u="<div class='aux-displaypibrief-content'><span class='aux-displaypibrief-text'><\/span><a href='#'><\/a><\/div>";n.widget("aux.auxDisplayPiBrief",t,{options:{changePaymentMethod:n.noop,cancelChangePaymentMethod:n.noop,changePaymentMethodPcsUrl:"",piBrief:{},creditCardText:"",changePaymentMethodText:"",cancelChangePaymentMethodText:""},_viewModel:null,_inChangeMode:!0,_create:function(){var t=this,n;n=this.options.piBrief&&this.options.piBrief.brand?this.options.creditCardText.replace("{0}",this.options.piBrief.brand).replace("{1}",this.options.piBrief.friendlyName):this.options.piBrief.friendlyName;this.element.addClass(r).html(u).find(".aux-displaypibrief-text").text(n).end().find(".aux-displaypibrief-content").find("a").text(this.options.changePaymentMethodText).on("click",function(n){n.preventDefault();t._operationLinkClicked()}).end().end();ko.applyBindings({data:this._viewModel,func:this},this.element[0]);i._create.call(this)},destroy:function(){this.element.empty().removeClass(r);i.destroy.call(this)},getViewModel:function(){return this._viewModel},_operationLinkClicked:function(){this._inChangeMode?(this.element.find(".aux-displaypibrief-content").find("a").text(this.options.cancelChangePaymentMethodText),this.options.changePaymentMethod&&this.options.changePaymentMethod(),this._inChangeMode=!1):(this.element.find(".aux-displaypibrief-content").find("a").text(this.options.changePaymentMethodText),this.options.cancelChangePaymentMethod&&this.options.cancelChangePaymentMethod(),this._inChangeMode=!0)}});n.aux.auxDisplayPiBrief.PiBrief=function(){this.brand="";this.friendlyName=""}}(jQuery,jQuery.Widget,this),function(n){n(function(){Modernizr.input.placeholder||(n(":input[placeholder]").each(function(){var t=n(this);t.val()===""&&t.val(t.attr("placeholder")).addClass("placeholderd")}).live("focus",function(){var t=n(this);t.val()===t.attr("placeholder")&&t.val("").removeClass("placeholderd")}).live("blur",function(){var t=n(this);t.val()===""&&t.val(t.attr("placeholder")).addClass("placeholderd")}),n("form").live("submit",function(){n(":input[placeholder].placeholderd").val("")}))})}(jQuery);LocSelect={LOCALE_VALUE:"",getUrlWithQueryStringParameter:function(n,t,i){n=n||"";var f=new RegExp("([?&])"+t+"=.*?(&|$)","i"),u=n.indexOf("#"),r=u>=0?n.substr(0,u):n,o=u>=0?n.substr(u):"",e;return(r.split("/").length===3&&(r+="/"),t=encodeURIComponent(t),i=encodeURIComponent(i),r)?(e=r.indexOf("?")!==-1?"&":"?",r=r.match(f)?r.replace(f,"$1"+t+"="+i+"$2"):r+e+t+"="+i,r+o):null},init:function(){var i=this,r=function(){$(".locale-selector").find(".site-flag").fadeIn(200)},t=function(){$(".locale-selector").find(".site-flag").fadeOut(200)},n;(function(){var n=LocSelect.LOCALE_VALUE;n&&$(".locale-selector a[data-loc='"+n.toLowerCase()+"']").each(function(n,t){$item=$(t);$item.addClass("selected");$(".locale-selector .current-locale").text($item.text())})})();n=$(".locale-selector");n.css("position","relative").find(".current-locale").click(function(n){var i,e,u,f;n.preventDefault();n.stopPropagation();i=$(this);e=i.data("panel");e.css("top",-e.outerHeight()-10);u=function(n){(n.keyCode||n.which)===27&&(t(),i=null,$(document).unbind("keyup",u),u=null)};$(document).bind("keyup",u);f=function(){t();i=null;$("html").unbind("click",f);f=null};$("html").bind("click",f);r()}).data("panel",n.find(".site-flag"));n.find("close").click(function(n){n.preventDefault();t()});n.find(".site-flag a").click(function(n){n.preventDefault();var t=$(this),r=t.data("loc"),u=i.getUrlWithQueryStringParameter(window.document.location.href,"l",r);window.document.location=u});n.find(".site-flag tr:last-child").addClass("last")}};var Visibility={Visible:["block","visible"],Hidden:["","hidden"],Removed:["none",""],Default:["",""]},NodeType={Element:1,Attribute:2,Text:3,CDATA:4,EntityRef:5,Entity:6,ProcInst:7,Comment:8,Doc:9,DocType:10,DocFrag:11,Notation:12},DOM={create:function(n,t){var i=null,r,u;if(exists(t)&&(t.name||t.type))try{r="<"+n;t.type&&(r+=' type="'+t.type+'"');t.name&&(r+=' name="'+t.name+'"');r+=">";i=document.createElement(r);t.type=null;t.name=null}catch(f){i=null}if(exists(i)||(i=document.createElement(n)),exists(t))for(u in t)exists(t[u])&&(i[u]=t[u]);return i},text:function(n){return document.createTextNode(n)},clear:function(n){while(exists(n)&&n.hasChildNodes())n.removeChild(n.firstChild)},isElement:function(n,t){return exists(n)&&n.nodeType==NodeType.Element&&(!isString(t)||n.tagName.equals(t,!0))},visible:function(n,t){return DOM.isElement(n)&&(n.style.visibility=t[1],n.style.display=t[0]),n}},EVENT={NamePrefix:"on",Name:{OnAbort:"abort",OnBlur:"blur",OnChange:"change",OnClick:"click",OnError:"error",OnFocus:"focus",OnKeyPress:"keypress",OnLoad:"load",OnMouseOut:"mouseout",OnMouseOver:"mouseover",OnMouseMove:"mousemove",OnSubmit:"submit",OnResize:"resize",OnKeyDown:"keydown",OnReadyStateChange:"readystatechange",OnKeyDown:"keydown",OnKeyUp:"keyup"},Key:{Enter:13,Caps:20,Escape:27,Spacebar:32,ArrowUp:38,ArrowDown:40,Delete:46,ArrowUp_alt:63232,ArrowDown_alt:63233},getTarget:function(n){return n.srcElement},add:function(n,t,i,r){$(n).bind(t,r,i)},remove:function(n,t,i){$(n).unbind(t,i)},end:function(n){return n.preventDefault(),!1},getKey:function(n){return n.which},isLowerCaseKey:function(n){var t=EVENT.getKey(n);return t>=97&&t<=122},isUpperCaseKey:function(n){var t=EVENT.getKey(n);return t>=65&&t<=90},isShiftDown:function(n){return n.shiftKey},isNumberKey:function(n){if(EVENT.isMetaKey(n))return!1;var t=EVENT.getKey(n);return t>95&&t<106?!0:!1},isVkProcessKey:function(n){if(EVENT.isMetaKey(n))return!1;var t=EVENT.getKey(n);return t==229?!0:!1},isMetaKey:function(n){return n.altKey||n.ctrlKey||n.metaKey},isCharKey:function(n){if(EVENT.isMetaKey(n))return!1;var t=EVENT.getKey(n);return t>57&&t<112||t>188?!0:!1}};PhoneControl=function(n,t,i,r,u,f){this.countryInfo=n;this.countryDropDownId=r;this.phoneInputId=u;this.phoneHintId=f;this.previousPhoneValue="";this.selectedCountry="US";this.phoneFormatMap=[];this.initializePhoneHint();this.initializeCountryDropDown(t,i);this.initializePhoneInput()};PhoneControl.prototype={getPhoneNumber:function(){var n=this.getPhoneInput().value;return n=n.replace(/[^0-9]/g,""),!n,n},getCountryISO:function(){var n=this.getCountryDropDown();return n.options[n.selectedIndex].value.toUpperCase()},isMobileEmail:function(){return!1},getPhoneCountryCode:function(){return this.countryInfo[this.selectedCountry].PhoneCountryCode},getFullPhoneNumber:function(){var n=this.getPhoneNumber(),t;return n?(t=this.countryInfo[this.selectedCountry].PhoneCountryCode,!t)?n:t+n:n},getDeliveryType:function(){return this.countryInfo[this.selectedCountry].DeliveryType},validate:function(n,t){var n=this.getCountryISO(),t=this.getPhoneNumber(),i;return t?exists(this.countryInfo[n])?(i=new RegExp(this.countryInfo[n].PhoneRegEx,"i"),t.match(i)):!0:!0},getCountryDropDown:function(){return this.GEId(this.countryDropDownId)},getPhoneInput:function(){return this.GEId(this.phoneInputId)},supportPlaceHolderForHint:function(){return!this.phoneHintId},getPhoneHint:function(){return this.phoneHintId?this.GEId(this.phoneHintId):null},GEId:function(n){return document.getElementById(n)},strEquals:function(n,t,i){return!isString(n)||!isString(t)?!1:i?n.toLowerCase()==t.toLowerCase():n===sString},initializeCountryDropDown:function(n,t){for(var i=this.getCountryDropDown(),r=0;r<n.length;r++){var u=n[r],f=this.strEquals(u,t,!0),e=DOM.create("option",{value:u,selected:f,defaultSelected:f});e.innerHTML=this.countryInfo[u].DropDownText;i.appendChild(e)}this.setSelectedCountry(i);EVENT.add(i,EVENT.Name.OnChange,$.proxy(this.evt_country_onchange,this),this)},evt_country_onchange:function(){this.setSelectedCountry()},setSelectedCountry:function(){var n=this.getCountryDropDown();this.selectedCountry=n.options[n.selectedIndex].value.toUpperCase();this.getPhoneInput().value="";this.supportPlaceHolderForHint()?this.getPhoneInput().placeholder=this.getHintText():(this.getPhoneHint().innerHTML=this.getHintText(),DOM.visible(this.getPhoneHint(),Visibility.Default))},initializePhoneHint:function(){this.supportPlaceHolderForHint()||EVENT.add(this.getPhoneHint(),EVENT.Name.OnClick,$.proxy(this.evt_hint_onclick,this),this)},evt_hint_onclick:function(){this.getPhoneInput().focus()},getHintText:function(){var n=this.countryInfo[this.selectedCountry].PhoneNumberExample;return n?n:""},initializePhoneInput:function(){var n=this.getPhoneInput();EVENT.add(n,EVENT.Name.OnKeyDown,$.proxy(this.evt_onkeydown,this),this);EVENT.add(n,EVENT.Name.OnFocus,$.proxy(this.evt_onfocus,this),this);EVENT.add(n,EVENT.Name.OnBlur,$.proxy(this.evt_onblur,this),this);EVENT.add(n,EVENT.Name.OnKeyUp,$.proxy(this.evt_onkeyup,this),this)},evt_onkeydown:function(n){return this.validateKey(n)},evt_onfocus:function(){this.updatePhoneFormatMap();this.supportPlaceHolderForHint()||DOM.visible(this.getPhoneHint(),Visibility.Removed);EVENT.add(this.getPhoneInput(),EVENT.Name.OnMouseMove,$.proxy(this.evt_onmousemove,this),this)},evt_onblur:function(){this.formatPhoneNumber();this.getPhoneNumber()||(this.supportPlaceHolderForHint()?this.getPhoneInput().placeholder=this.getHintText():DOM.visible(this.getPhoneHint(),Visibility.Default));EVENT.remove(this.getPhoneInput(),EVENT.Name.OnMouseMove,this.evt_onmousemove)},evt_onkeyup:function(){this.formatPhoneNumber()},evt_onmousemove:function(){this.formatPhoneNumber()},validateKey:function(n){return EVENT.isNumberKey(n)||EVENT.isVkProcessKey(n)||!EVENT.isCharKey(n)?!0:(EVENT.end(n),!1)},updatePhoneFormatMap:function(){var i,n,t;if((this.phoneFormatMap=null,i=this.countryInfo[this.selectedCountry].PhoneFormat,i)&&(n=i.split(","),n.length>0))for(this.phoneFormatMap=[],t=0;t<n.length;t++){var u=n[t].split("="),r=u[0],f=parseInt(u[1]);r==""&&(r=" ");this.phoneFormatMap[f]=r}},formatPhoneNumber:function(){var i=this.getPhoneNumber(),r=this.getPhoneInput().value,t,n;if(this.phoneFormatMap&&this.previousPhoneValue!=r){for(t="",n=0;n<i.length;n++)arrExists(this.phoneFormatMap,n)&&(t+=this.phoneFormatMap[n]),t+=i.charAt(n);this.getPhoneInput().value=t;this.previousPhoneValue=t}}};PhoneFields=function(n,t,i,r,u,f,e){this.m_elementId=n;this.m_countryDDId=t;this.m_phoneHintId=i;this.m_mobilePhoneHelpStringId=r;this.m_mobileEmailHelpStringId=u;this.m_mobilePhoneLabelId=f;this.m_mobileEmailLabelId=e};PhoneFields.prototype={initialize:function(n,t,i){var u=this.getCountryDD(),r;EVENT.add(u,EVENT.Name.OnFocus,$.proxy(this.evt_Phone_SMSCountry_onfocus,this),this);EVENT.add(u,EVENT.Name.OnChange,$.proxy(this.evt_Phone_SMSCountry_onchange,this),this);r=this.getElement();EVENT.add(r,EVENT.Name.OnChange,$.proxy(this.evt_onchange,this),this);EVENT.add(r,EVENT.Name.OnFocus,$.proxy(this.evt_onfocus,this),this);EVENT.add(r,EVENT.Name.OnBlur,$.proxy(this.evt_onblur,this),this);this.m_phoneControl=new PhoneControl(n,t,i,this.m_countryDDId,this.m_elementId,this.m_phoneHintId)},getElement:function(){return this.m_elementId},getValue:function(){return this.m_phoneControl.getPhoneNumber()},getCountryDD:function(){return GEId(this.m_countryDDId)},getCountryDDSelected:function(){return this.m_phoneControl.getCountryISO()},getMobilePhoneLabel:function(){return GEId(this.m_mobilePhoneLabelId)},getMobileEmailLabel:function(){return GEId(this.m_mobileEmailLabelId)},getPhoneControl:function(){return this.m_phoneControl},validate:function(){return this.m_phoneControl.validate()},showHelp:function(){},setFocus:function(){},evt_Phone_SMSCountry_onfocus:function(){},evt_Phone_SMSCountry_onchange:function(){this.m_phoneControl.isMobileEmail()?(DOM.visible(this.getMobilePhoneLabel(),Visibility.Removed),DOM.visible(this.getMobileEmailLabel(),Visibility.Visible)):(DOM.visible(this.getMobileEmailLabel(),Visibility.Removed),DOM.visible(this.getMobilePhoneLabel(),Visibility.Visible))},evt_onfocus:function(){},evt_onchange:function(n){SignUp.ValidateField(EVENT.getTarget(n))},evt_onblur:function(n){SignUp.ValidateField(EVENT.getTarget(n))}},function(n){var t="paymentInstrumentsDropDown",o="drop-entry-index",k="selectionChanged",d={visibleRowsCount:5,headerClass:"pi-dropdown-header",headerWithDropDownClass:"pi-dropdown-header-with-dropdown",dropDownImagePath:"/Content/Images/dropdown-arrow.png",dropDownImageClass:"pi-dropdown-header-image",rowClass:"pi-dropdown-row",selectedClass:"pi-dropdown-selected",clickableClass:"pi-dropdown-clickable",containerSelector:"#pi-container"},r="pi-dropdown-list-container",g=function(t){n.extend(t,{paymentInstruments:[],selectedIndex:-1,isDropDownShown:!1})},nt=function(n){l(n)},tt=function(n){if(n.paymentInstruments.length>1){var t=n.target.find("."+n.settings.headerClass);t.find("a").focus()}},y=function(n,t){n.paymentInstruments=t;n.selectedIndex=-1;c(n);l(n);s(n,0)},it=function(n,t){var i=n.paymentInstruments.length+1;i>1?(n.paymentInstruments.push(t),c(n),l(n),s(n,n.paymentInstruments.length-1)):(e(n,!1),n.paymentInstruments.push(t),ft(n),s(n,n.paymentInstruments.length-1))},s=function(n,t){t>=0&&t<n.paymentInstruments.length&&t!=n.selectedIndex&&(u(n,t),e(n,!0))},c=function(n){n!=null&&n.target!=null&&(n.target.find("."+n.settings.headerWithDropDownClass).unbind("click keydown"),n.target.empty())},l=function(t){var s,c,l,v;if(t.paymentInstruments.length==0)n(t.settings.containerSelector).hide(),s=rt(t),s.addClass(t.settings.headerClass),t.target.append(s);else if(n(t.settings.containerSelector).show(),t.paymentInstruments.length==1)s=b(t,t.paymentInstruments[0]),s.addClass(t.settings.headerClass),t.target.append(s);else{for(t.target.addClass(t.settings.clickableClass),s=p(t,t.paymentInstruments[t.selectedIndex],t.paymentInstruments.length>1),s.addClass(t.settings.headerClass).addClass(t.settings.headerWithDropDownClass),c=n("<div class='"+r+"' tabindex='0' />"),l=n("<ul />"),c.append(l),i=0;i<t.paymentInstruments.length;i++)v=w(t,i),l.append(v);c.hide();s.bind("click keydown",t,function(i){var g=i.type=="keydown",v=!1,w,s,l,d,b,k,p,c;if(g)switch(i.keyCode){case 9:i.data.isDropDownShown&&e(i.data,!1);break;case 13:v=!0;i.data.isDropDownShown&&(s=i.data.target.find("."+r),w=h(i.data,s),u(i.data,w),e(t,!0));break;case 33:case 34:s=i.data.target.find("."+r);l=i.keyCode==33?0:i.data.paymentInstruments.length-1;u(i.data,l);f(i.data,s,l);v=!0;break;case 38:if(i.altKey)a(i.data,!0),v=!0;else{var s=i.data.target.find("."+r),w=h(i.data,s),l=w-1;l>=0&&(u(i.data,l),f(i.data,s,l));v=!0}break;case 40:if(i.altKey)a(i.data,!0),v=!0;else{var s=i.data.target.find("."+r),w=h(i.data,s),l=w+1;l<i.data.paymentInstruments.length&&(u(i.data,l),f(i.data,s,l));v=!0}break;default:var s=i.data.target.find("."+r),nt=s.find("."+i.data.settings.rowClass),y=nt.find("span").filter(function(){return n(this).text().toLowerCase().indexOf(String.fromCharCode(i.keyCode).toLowerCase())!=-1});if(y.length>0)if(d=h(i.data,s),y.length==1)p=y.closest("."+i.data.settings.rowClass),c=p.data(o),u(i.data,c),f(i.data,s,c);else{for(b=0,k=!1;b<y.length;)if(p=n(y[b]).closest("."+i.data.settings.rowClass),c=p.data(o),c>d){u(i.data,c);f(i.data,s,c);k=!0;break}else b++;k||(p=n(y[0]).closest("."+i.data.settings.rowClass),c=p.data(o),u(i.data,c),f(i.data,s,c))}}else a(i.data,!1),v=!0;v&&(i.preventDefault(),i.stopPropagation())});t.target.append(s);t.target.append(c)}},p=function(t,i,r){var f,e=n("<div />"),u,o;return f=typeof t.settings.onCreateEntry=="function"?t.settings.onCreateEntry(i):i.toString(),r?(u=n("<a href='javascript:(void);' />"),o=n("<img />").attr("src",t.settings.dropDownImagePath).attr("class",t.settings.dropDownImageClass),e.append(u),u.append(f),u.append(o)):e.append(f),e},w=function(t,i){var r=b(t,t.paymentInstruments[i]).addClass(t.settings.rowClass);return r.data(o,i),n("<li />").append(r)},rt=function(t){var i=n("<div />");return typeof t.settings.onCreateEmptyEntry=="function"?i.append(t.settings.onCreateEmptyEntry()):i.append("No element"),i},b=function(t,i){var r=n("<div />");return typeof t.settings.onCreateEntry=="function"?r.append(t.settings.onCreateEntry(i)):r.append(i.toString()),r},u=function(n,t){if(t!=n.selectedIndex){n.selectedIndex=t;var i=n.target.find("."+n.settings.headerClass),r=p(n,n.paymentInstruments[n.selectedIndex],n.paymentInstruments.length>1);i.empty();i.append(r);n.paymentInstruments.length>1&&i.find("a").focus();n.target.trigger(k,{newSelectionIndex:n.selectedIndex,newItem:n.paymentInstruments[n.selectedIndex]})}},a=function(n,t){n.isDropDownShown?e(n,t):ut(n)},ut=function(i){var s,c,l,a,h;i.isDropDownShown||(s=i.target.find("."+r),s.css("width",i.target.width()-2),i.settings.visibleRowsCount!=-1?(c=s.find("."+i.settings.rowClass).first(),s.css("height",25),s.show(),l=i.settings.visibleRowsCount*c.height(),s.css("height",l)):s.show(),i.isDropDownShown=!0,f(i,s,i.selectedIndex),a=i.target.find("."+i.settings.headerClass),a.find("a").focus(),h=i.target.find("."+i.settings.rowClass),h.mouseover(function(i){var u=n(i.target),e=u.closest("."+r),s=e.parent().data(t),h=u.closest("."+s.settings.rowClass);f(s,e,h.data(o))}),h.click(function(i){var s=n(i.target),f=s.closest("."+r).parent().data(t),h=s.closest("."+f.settings.rowClass),c=h.data(o);u(f,c);e(f,!0)}),n(document).bind("click."+t,i,function(t){t.data.target.find(n(t.target)).length==0&&e(t.data,!1)}),n(document).bind("keyup."+t,i,function(n){switch(n.keyCode){case 27:e(n.data,!0)}}))},ft=function(n){var t=n.target.find("."+r),i=w(n,n.paymentInstruments.length-1);t.append(i)},h=function(n,t){var i=t.find("."+n.settings.selectedClass);return i.data(o)},f=function(n,t,i){t.find("."+n.settings.selectedClass).removeClass(n.settings.selectedClass);var r=t.find("."+n.settings.rowClass+":eq("+i.toString()+")");r.addClass(n.settings.selectedClass)},e=function(i,u){var f,e;i.isDropDownShown&&(f=i.target.find("."+r),f.hide(),i.isDropDownShown=!1,e=i.target.find("."+i.settings.rowClass),e.unbind("mouseover click"),n(document).unbind("click."+t),n(document).unbind("keyup."+t),u&&i.target.find("."+i.settings.headerWithDropDownClass+" a").focus())},v={init:function(i){return this.each(function(){var u=n(this),r=u.data(t);r||(r={target:u,settings:n.extend({},d,i)},u.data(t,r));g(r)})},open:function(){return this.each(function(){var i=n(this),r=i.data(t);nt(r)})},focus:function(){return this.each(function(){var i=n(this),r=i.data(t);tt(r)})},setItems:function(i){return this.each(function(){var r=n(this),u=r.data(t);y(u,i)})},appendItem:function(i){return this.each(function(){var r=n(this),u=r.data(t);it(u,i)})},removeItem:function(i){var r=null,f=n(this),u=f.data(t);this.first().each(function(){r=n.grep(u.paymentInstruments,function(n){var t=!0;return i.IsInvoice===!0?t=n.IsInvoice===!1:i.IsInvoice===!1&&(t=n.IsInvoice===!0),t})});r.length!=u.paymentInstruments.length&&y(u,r)},containsItem:function(i){for(var r,f,o=n(this),e=o.data(t),u=0;u<e.paymentInstruments.length;u++)if(r=!0,f=e.paymentInstruments[u],i.IsInvoice===!0?r=f.IsInvoice===!0:i.IsInvoice===!1&&(r=f.IsInvoice===!1),r)return!0;return!1},getSelectedItem:function(){var i=null;return this.first().each(function(){var u=n(this),r=u.data(t);i=r.paymentInstruments[r.selectedIndex]}),i},getSelectedIndex:function(){var i=null;return this.first().each(function(){var r=n(this),u=r.data(t);i=u.selectedIndex}),i},setSelectedIndex:function(i){return this.each(function(){var r=n(this),u=r.data(t);s(u,i)})},destroy:function(){return this.each(function(){var i=n(this),r=i.data(t);c(r);n(window).unbind("."+t);i.removeData(t)})}};n.fn.paymentInstrumentsDropDown=function(i){if(v[i])return v[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery."+t);else return v.init.apply(this,arguments)}}(jQuery);Tenant.CreateTenant={Model:{},Resources:{},updateDomain:!0,errorMessage:"",currentDomain:"",verifyDomainAvailability:function(){var n=$("#DomainName"),t={domainName:n.val()},i=appendQueryString(this.Model.VerifyDomainURL,t);n.removeClass("fx-validation-invalid").addClass("fx-validation-deferred-pending");auxPost(i,function(t){if(t.available){n.removeClass("fx-validation-deferred-pending").addClass("fx-validation-valid").addClass("fx-validation-deferred-valid");var i=n.val(),r=$("#second-level-domain").text();$("#createorg-domain").text("@"+i+r);$("#createorg-hidden").show();Tenant.CreateTenant.errorMessage=""}else Tenant.CreateTenant.errorMessage=t.errorMessage,n.fxTextBox("validate")},function(){Tenant.CreateTenant.errorMessage=Tenant.CreateTenant.Resources.DomainVerificationDown;n.fxTextBox("validate")})},createTenant:function(){var i=$("#createorg-form form"),r=i.serialize(),u=this.Model.CreateTenantURL,n=$("#accept-and-continue"),t=$("#createorg-form img.createorg-wait");MsPortalFx.UI.Validation.validateContainer(i)&&(n.hide(),t.show(),Tenant.CreateTenant.errorMessage="",$("#error").text(""),auxPost(u,function(i){i.success?window.location.href=i.url:(i.elementName&&i.elementName.length>0?(Tenant.CreateTenant.errorMessage=i.errorMessage,$("[name='"+i.elementName+"']").fxTextBox("validate")):$("#error").text(i.errorMessage),n.show(),t.hide())},function(){$("#error").text(Tenant.CreateTenant.CreateTenantDown);n.show();t.hide()},r))},automaticDomainUpdate:function(){if(Tenant.CreateTenant.updateDomain){var i=$("#FirstName").val().trim(),r=$("#LastName").val().trim(),t=$("#OrganizationName").val().trim(),n;n=t.length>0?t:i+r;n=n.replace(/[^A-Za-z0-9]/g,"").toLowerCase();$("#DomainName").val(n).change()}},disableAutomaticDomainUpdate:function(){Tenant.CreateTenant.updateDomain=!1;Tenant.CreateTenant.hideDetailsOnDomainChange()},validateDomain:function(){var n=$("#DomainName").fxTextBox("validate");n==="valid"?$("#check-domain-available").prop("disabled",!1):$("#check-domain-available").prop("disabled",!0)},validateCreateTenantResult:function(){var n,t=Tenant.CreateTenant.errorMessage;return Tenant.CreateTenant.errorMessage="",n=t.length>0?!1:!0,{message:t,valid:n}},hideDetailsOnDomainChange:function(){var n=$("#DomainName").val();n!==this.currentDomain&&(this.currentDomain=n,$("#createorg-hidden").hide(),this.validateDomain())},init:function(){var n=$("#FirstName"),t=$("#LastName"),i=$("#OrganizationName"),r=$("#DomainName"),u=$("#Password");n.keyup(this.automaticDomainUpdate);t.keyup(this.automaticDomainUpdate);i.keyup(this.automaticDomainUpdate);n.change(this.automaticDomainUpdate);t.change(this.automaticDomainUpdate);i.change(this.automaticDomainUpdate);r.keyup(this.disableAutomaticDomainUpdate);r.change(this.validateDomain);$("#check-domain-available").click(function(){Tenant.CreateTenant.verifyDomainAvailability()});$("#accept-and-continue").click(function(){Tenant.CreateTenant.createTenant()});MsPortalFx.UI.Validation.addValidationCallback("#DomainName",this.validateCreateTenantResult);MsPortalFx.UI.Validation.addValidationCallback("#Password",this.validateCreateTenantResult);$.each(["data-val-required","data-val-length","data-val-regex","data-val-combinedlength","data-val-equalto"],function(n,t){$("["+t+"]").each(function(n,i){$(i).attr(t,MsPortalFx.Base.Utilities.htmlDecode($(i).attr(t)))})});$("#createorg-form form").submit(function(){return!1});$("#countrycode-what").fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:this.Resources.CountryHelp}});$("#domain-what").fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:this.Resources.DomainNameHelp}});$("#userid-what").fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:this.Resources.UserNameHelp}})}};CustomValidators={init:function(){MsPortalFx.UI.Validation.addValidator("combinedlength",["maxlength","otherpropertyname"],function(n,t,i){var r=parseInt(i.maxlength,10),u=$("[name='"+i.otherpropertyname+"']").val();return n.length+u.length<=r})}},function(n){var t=17;n.fn.auxScrollbar=function(){return this.each(function(){var i,e,u,o,s,r=n(this),f=r.data("scrollbar");if(f)e=f.handle,i=f.container,o=f.trackcontainer,s=f.adjacentDiv,u=f.track;else{e=n("<div/>",{"class":"aux-scrollbar-handle"});u=n("<div/>",{"class":"aux-scrollbar-track"});o=n("<div/>",{"class":"aux-scrollbar-trackcontainer",css:{width:t}});u.append(e);o.append(u);i=n("<div/>",{"class":"aux-scrollbar-container",css:{width:"100%",height:"100%"}});r.wrapInner(i);i=r.find(".aux-scrollbar-container");r.append(o);s=n("<div/>",{css:{height:"0px",clear:"both"}});s.appendTo(i);r.data("scrollbar",f={container:i,handle:e,track:u,trackcontainer:o,adjacentDiv:s,heightRatio:0});i.scroll(function(){var t=r.data("scrollbar"),i=t.handle,u=t.heightRatio;i.css("top",n(this).scrollTop()/u)});u.click(function(t){var u=r.data("scrollbar"),a=u.handle,o=u.container,f=u.heightRatio,s=t.pageY-n(this).offset().top,e=parseInt(a.height(),10);s-=e/2;var i=s*f,h=o.scrollTop(),c=h+e*f,l=h-e*f;return i>c&&(i=c),i<l&&(i=l),o.scrollTop(i),!1});e.click(!1);e.mousedown(function(t){var i=r.data("scrollbar"),u=i.handle,f=t.pageY,e=u.position().top;return n("html").bind("mousemove.scrollcapture",function(n){var t=r.data("scrollbar"),i=t.container,u=t.heightRatio;return i.scrollTop(u*(n.pageY-f+e)),!1}).mouseup(function(){return n("html").unbind("mousemove.scrollcapture"),!1}),!1});function c(){r.auxScrollbar();window.setTimeout(c,50)}window.setTimeout(c,50)}var a=s.position().top,v=i.children().position().top,y=a-v,l=i.height(),h=y/l;f.heightRatio=h;h<=1?u.hide():(u.show(),e.css({height:Math.round(l/h),top:i.scrollTop()/h}))})};n(function(){n(".aux-scrollbar").auxScrollbar()})}(jQuery),function(n){n(function(){"use strict";var u=jQuery.Widget,r=u.prototype,t="dropDownMenu-inactive",i="dropDownMenu-expanded",f="<a class='dropDownMenu-tray clearfix' href=''><span class='dropDownMenu-tray-link'><\/span><div class='dropDownMenu-icon-wrapper'><\/div><\/a><div class='dropDownMenu-dropDown'><div class='pointer'><\/div><\/div>";n.widget("custom.dropDownMenu",{options:{animationDurationMs:300,url:"",text:"",textColor:"",textLink:"#",content:"list",dropdownColor:"dropDown-gray",dropdownPointerPosition:"",pointer:!0,elementsOnDropDownMenu:[]},_isDropDownOpening:!1,_dropDownElement:null,_globalClickHandler:null,_create:function(){this.element.addClass("dropDownMenu").html(f).find(".dropDownMenu-tray").attr("href",this.options.textLink).end().find(".dropDownMenu-tray-link").addClass(this.options.textColor).html(this.options.text).end().find(".dropDownMenu-dropDown").addClass(this.options.dropdownColor+" "+this.options.dropdownPointerPosition+" "+this.options.dropdownPointerPosition+"-corner");this.options.url&&this.element.find(".dropDownMenu-icon-wrapper").append(n("<img />").addClass("dropDownMenu-icon").attr({src:this.options.url,alt:this.options.text}));this.options.pointer&&!this.options.pointer!="false"||this.element.find(".dropDownMenu-dropDown").addClass("no-pointer");this._initializeControlsAndEventHandlers();r._create.call(this)},destroy:function(){this.element.removeClass("dropDownMenu").empty();this._destroyGlobalClickHandler();r.destroy.call(this)},_initializeControlsAndEventHandlers:function(){var n=this;this.element.find(".dropDownMenu-tray").on("click",function(){n._trayClicked.apply(n,arguments)});this._dropDownElement=this.element.find(".dropDownMenu-dropDown").addClass(t);this._createItemsPicker()},_createItemsPicker:function(){var u=this,i=n("<ul />"),t,r;if(this.options.content=="list"){for(t=0;t<this.options.elementsOnDropDownMenu.length;t++)r=n("<li />").append(n("<a />").attr("href",this.options.elementsOnDropDownMenu[t].Link).html(this.options.elementsOnDropDownMenu[t].Text)),i.append(r);this._dropDownElement.append(i)}else this._dropDownElement.append(this.options.elementsOnDropDownMenu)},_onDropDownClick:function(n){this._closeDropDownMenu();n.preventDefault();n.stopPropagation()},_trayClicked:function(r){var u=this;if(!this.element.hasClass(i)){this.element.addClass(i);this._dropDownElement.slideDown(this.options.animationDurationMs).removeClass(t);this._isDropDownOpening=!0;this._destroyGlobalClickHandler();n("body").on("click",this._globalClickHandler=function(){u._closeDropDownMenu.apply(u,arguments)})}r.preventDefault()},_closeDropDownMenu:function(){this._isDropDownOpening?this._isDropDownOpening=!1:(this.element.removeClass(i),this._dropDownElement.slideUp(this.options.animationDurationMs).addClass(t),this._destroyGlobalClickHandler())},_destroyGlobalClickHandler:function(){this._globalClickHandler&&(n("body").off("click",this._globalClickHandler),this._globalClickHandler=null)}})})}(jQuery,this,jQuery.Widget),function(n){n(function(){"use strict";var i=jQuery.Widget,t=i.prototype,r="<select><\/select>";n.widget("custom.itemListPicker",{options:{animationDurationMs:300,url:"",urlOnError:"",list:[]},_tenantSelectBox:null,_create:function(){this.element.addClass("itemListPicker").html(r);this._setList(this.options.list);this._initializeControlsAndEventHandlers();t._create.call(this)},_setList:function(t){var r=this,i=this.element.find("select");n.each(t,function(t,r){var u=r.Selected==!0;i.append(n("<option>",{value:r.ValueItem,selected:u,defaultSelected:u}).text(r.DisplayTextItem))})},_initializeControlsAndEventHandlers:function(){var t=this;this.element.find("select").on("change",function(i){t._onItemChange(i,n(this).val())})},_onItemChange:function(n,t){var i=this,u=this.options.url,r={};this._showSpinner(!0);t!==undefined?(r.valueItem=t,auxPost(u,function(n){try{n.Data.returnUrl!=undefined&&n.Data.returnUrl!=null?(document.location=n.Data.returnUrl,i._showSpinner(!1)):n.Data.success===!1&&i._redirectToErrorPage()}catch(t){i._redirectToErrorPage()}},function(){i._redirectToErrorPage()},r)):i._redirectToErrorPage()},_redirectToErrorPage:function(){this.options.urlOnError!==undefined&&this.options.urlOnError!==null&&(document.location=this.options.urlOnError,this._showSpinner(!1))},_showSpinner:function(t){var i=n("#overlay-page");t?i.delay(100).fadeIn(250):i.fadeOut(250)},_destroy:function(){this.element.removeClass("itemListPicker").empty();this._destroyEventsHandler();t.destroy.call(this)},_destroyEventsHandler:function(){this.element.find("select").off("click")}})})}(jQuery,this,jQuery.Widget);Subscriptions.MonetaryCommitment={Resources:{},Model:{},FwLinks:{},CombinedTotalSelector:"#mc-monthly-combined-total",CommitmentAmountSelector:"#monetary-commitment-amount",DurationSelector:"#duration",PaymentTimeSelector:"#paymentTime",WarningMessageSelector:"#warning-message",getMinAmount:function(n){var t=null;return $.each(n.discounts,function(n,i){(t===null||i.minValue<t)&&(t=i.minValue)}),t},showCommitmentAmountError:function(n){var t=this;$(this.CommitmentAmountSelector).each(function(i,r){var f=$(t.CommitmentAmountSelector).attr("data-val-regex-pattern"),e=$(t.CommitmentAmountSelector).val(),s=parseFloat(e),u,o;if(f&&!e.match("^"+f+"$")&&(u=t.Resources.CommitmentAmountInvalidCharacters),!u)if(s>t.Model.MaxCommitmentAmount)u=t.Resources.CommitmentAmountTooHigh;else{if(n===undefined)try{n=parseInt($(r).attr("min"))}catch(h){n=0}o=t.Model.CurrencyFormat.replace("{0}",n);u=t.Resources.CommitmentAmountTooLow.replace("{0}",o)}$.wizard().showErrorInNotificationBar(u,null)})},hideCommitmentAmountError:function(){var n=this;$(this.CommitmentAmountSelector).each(function(){$.wizard().hideNotificationBar()})},updateDiscountAndOffer:function(){for(var f,e,o,c,l,u=$(this.PaymentTimeSelector).val()==="true",a=parseInt($(this.DurationSelector).val(),10),i=this.Model.MonetaryCommitmentMap,s=$(this.CommitmentAmountSelector).val(),r=isNaN(parseFloat(s))?0:parseFloat(s),h=this,n,t=0;t<i.length;++t)if(i[t].months===a&&i[t].isPayNow===u){n=i[t];break}if(n){for($("input:hidden[name=offerGuid]").each(function(t,i){$(i).val(n.offerGuid)}),$("#view-charges-rate").attr("href",n.ratePlanUrl),f=this.getMinAmount(n),r<f?(r=f,$(this.CommitmentAmountSelector).val(r),$(this.CommitmentAmountSelector).attr("min",this.getMinAmount(n)),$(this.CommitmentAmountSelector).keyup()):$(this.CommitmentAmountSelector).attr("min",this.getMinAmount(n)),$(this.CommitmentAmountSelector).prop("disabled")||$(this.CommitmentAmountSelector).focus().blur(),$.wizard().enableComplete(),t=0;t<n.discounts.length;t++)r>=n.discounts[t].minValue&&(o===undefined||o<n.discounts[t].minValue)&&(o=n.discounts[t].minValue,e=n.discounts[t]);c=e?e.discount:0;l=this.Model.PercentageFormat.replace("{0}",c);$("#mcDiscount").text(l);$("#offerDescription").text(n.description);u?$(this.CombinedTotalSelector).hide():$(this.CombinedTotalSelector).show();$(this.WarningMessageSelector).each(function(n,t){var i=u?h.Resources.PayNowWarning:h.Resources.PayMonthlyWarning;$(t).text(i)});this.updateLabel("#mcAmount",n.isPayNow,this.Resources.CommitmentAmountPaidNow,this.Resources.CommitmentAmountMonthly);this.updateLabel("#mcTax",n.isPayNow,this.Resources.TaxPaidNow,this.Resources.TaxMonthly);this.updateLabel("#mcTotal",n.isPayNow,this.Resources.TotalPaidNow,this.Resources.TotalMonthly)}else n=1,$.wizard().showErrorInNotificationBar(this.Resources.InvalidMCTerms,null)},updateLabel:function(n,t,i,r){var u=t?i:r;$(n).text(u)},estimateMonetaryCommitmentChanges:function(){var n=$("#monetaryCommitmentForm"),t=$.wizard().spinner();return auxAjax({url:n.attr("action"),type:"POST",data:n.serialize()}).always(function(){t.resolve()})},displayInvoiceChanges:function(n){$("#invoice-tax .amount").text(n.DisplayInvoiceTax);$("#invoice-total .amount").text(n.DisplayInvoiceTotal);$("#invoice-combined-total .amount").text(n.DisplayCombinedTotal)},displayMonetaryCommitmentChanges:function(n){Subscriptions.MonetaryCommitment.displayInvoiceChanges(n);Subscriptions.MonetaryCommitment.updateDiscountAndOffer()},monitorDurationChanges:function(){this.monitorSelectBoxChange(Subscriptions.MonetaryCommitment.shouldRefreshOnDurationChange,Subscriptions.MonetaryCommitment.estimateMonetaryCommitmentChanges,Subscriptions.MonetaryCommitment.displayInvoiceChanges,this.DurationSelector)},monitorPaymentTimeChanges:function(){this.monitorSelectBoxChange(Subscriptions.MonetaryCommitment.shouldRefreshOnPaymentTimeChange,Subscriptions.MonetaryCommitment.estimateMonetaryCommitmentChanges,Subscriptions.MonetaryCommitment.displayInvoiceChanges,this.PaymentTimeSelector)},shouldRefreshOnDurationChange:function(){return $(this.PaymentTimeSelector).val()!=="true"},shouldRefreshOnPaymentTimeChange:function(){return!0},monitorSelectBoxChange:function(n,t,i,r){var u=this;$(r).change(function(){var r,f;u.updateDiscountAndOffer();n.call(u)&&(r=u.CommitmentAmountSelector+", #add-payment-method, #new-invoice, #duration, #paymentTime",$.wizard().getButton("complete").isEnabled()&&(r+=", #wizard-button-complete"),f=$.wizard().spinner(r),$.when(t.call(u)).then(function(n){i.call(u,n)}).then(function(n){f.resolve(n)}).fail(function(){f.reject()}))})},init:function(){this.Model.WarnDiscountsEndingSoon?$.wizard().showInfoInNotificationBar(this.Resources.DiscountsEndingSoon,this.FwLinks.RateChargesFwLink):$.wizard().hideNotificationBar();this.updateDiscountAndOffer();this.monitorDurationChanges();this.monitorPaymentTimeChanges()}};Signup.BotChallenge={countryInfo:null,offer:null,countryCode:null,dropDownList:null,dropDownListDefaultItem:null,phoneFields:new PhoneFields("phoneNumberText","countrySelector","phoneNumberHint","Mobile phone","Mobile e-mail","mobileNumberLabel","mobileEmailLabel"),shouldUpdateCountrySelector:!0,GetCssPhoneNumberURL:"",GetCountryCodeByIpAddressURL:"",BeginSmsChallengeURL:"",CompleteSmsChallengeURL:"",ContactLocalSupportFormat:"",SmsMessageSuccessfullySent:"",PhoneCallSuccessfullyMade:"",SendText:"",CallMe:"",Verified:"",MobileContactNotValidButSmsSentAnyway:"",MobileContactNotValidButPhoneCallMadeAnyway:"",ContactSupportText:"",SupportPageURL:"",SeeSupportPageText:"",ConfirmationGuid:"",init:function(){var n=this;$("#sendChallenge").click(Signup.BotChallenge.beginSmsChallengeRoot);$("#confirmChallenge").click(Signup.BotChallenge.completeSmsChallengeRoot);this.ConfirmationGuid=$("#ConfirmationGuid").val();this.phoneFields.initialize(this.countryInfo,this.dropDownList,this.dropDownListDefaultItem);this.updateCssSupportNumber();this.updateDeliveryType(this.phoneFields.getPhoneControl().getDeliveryType());$("#countrySelector").children().length>1?($("#smsChallengeForm").addClass("showMultipleCountryContainer"),$("#countrySelector").change(function(){n.updateCssSupportNumber();n.updateDeliveryType()}).focus(function(){n.shouldUpdateCountrySelector=!1})):$("#smsChallengeForm").addClass("showOneCountryContainer").find(".hasSingleCountryContainer.countryContainer .countrySelector").text($("#countrySelector").children("option:selected").text());$("#phoneNumberText").keydown(function(){n.shouldUpdateCountrySelector=!1});$("#phoneNumberText").click(function(){n.shouldUpdateCountrySelector=!1});$("#phoneNumberText").bind("keypress",function(n){(n.keyCode||n.which)===13&&(n.preventDefault(),$("#sendChallenge").trigger("click"))});$("#confirmationText").bind("keypress",function(n){(n.keyCode||n.which)===13&&($("#sendChallenge").data("autoadvance",1),$("#confirmChallenge").trigger("click"))});$("#wizard-button-next").unbind("click.ed");$("#wizard-button-next").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-acctwiz2")});$("#wizard-button-close").unbind("click.ed");$("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel -Abandon","WT.z_iLinks_targetcampaign","src-acctwiz2")})},setSendTextDeliveryType:function(){this.setDeliveryTypeLabels(this.SendText)},setCallMeDeliveryType:function(){this.setDeliveryTypeLabels(this.CallMe)},setDeliveryTypeLabels:function(n){$("#sendChallengeText").html(n)},updateDeliveryType:function(){var n=this;n.selectDeliveryType(n.phoneFields.getPhoneControl().getDeliveryType())},showOnlyContactSupportForm:function(){var n=this;$("#smsChallengeFormDisabled").show();$("#smsChallengeForm").hide();this.showContactSupportInNotificationBar()},showContactSupportInNotificationBar:function(){$.wizard?$.wizard().showInfoInNotificationBar(this.ContactSupportText,this.SupportPageURL):($("#errorCallSupport p").html('<a target="_blank" href="'+this.SupportPageURL+'">'+this.ContactSupportText+"<\/a>"),$("#errorCallSupport").show())},updateCssSupportNumber:function(){var n=this,t=n.GetCssPhoneNumberURL+$("#countrySelector").val();auxPost(t,function(t){n.ContactSupportText=t?n.ContactLocalSupportFormat.format(t):n.SeeSupportPageText})},stripNonDigit:function(n){return n.replace(/[^0-9]/g,"")},setBeginSmsChallengeStatus:function(n){$.wizard&&$.wizard().showInfoInNotificationBar(n,null)},showNeedHelpWithVerification:function(){$("#contactSupportForm").is(":visible")||$("#needHelpWithAccountVerification").show()},getSelectedDeliveryType:function(){return $("#sendTextRadio").attr("checked")==="checked"?Signup.SmsChallengeDeliveryType.TextMessage:$("#callMeRadio").attr("checked")==="checked"?Signup.SmsChallengeDeliveryType.VoicePin:Signup.SmsChallengeDeliveryType.TextMessage},selectDeliveryType:function(n){var t=this;$("#deliveryTypeContainer").show();switch(n){case t.DeliveryType.SmsAndVoice:$(".textRadio").show();$(".callRadio").show();$("#sendTextRadio").click();break;case t.DeliveryType.Voice:$(".textRadio").hide();$(".callRadio").show();$("#callMeRadio").click();break;case t.DeliveryType.Sms:$(".textRadio").show();$(".callRadio").hide();$("#sendTextRadio").click()}},beginSmsChallenge:function(){var i=this,e=this.offer,o=this.countryCode,s=setTimeout(function(){$("#sendChallenge").prop("disabled",!1)},3e4),t=$("#phoneNumberText").val(),h=$("#countrySelector").val(),n=this.getSelectedDeliveryType(),r,u,f;$("#errorCallSupport").hide();$("#confirmCodeDiv").hide();t===""?this.showContactSupportInNotificationBar():(t=this.stripNonDigit(this.phoneFields.getPhoneControl().getPhoneNumber()),r=this.phoneFields.validate(),r?n===Signup.SmsChallengeDeliveryType.TextMessage?this.setBeginSmsChallengeStatus(this.SmsMessageSuccessfullySent):n===Signup.SmsChallengeDeliveryType.VoicePin&&this.setBeginSmsChallengeStatus(this.PhoneCallSuccessfullyMade):n===Signup.SmsChallengeDeliveryType.TextMessage?this.setBeginSmsChallengeStatus(this.MobileContactNotValidButSmsSentAnyway):n===Signup.SmsChallengeDeliveryType.VoicePin&&this.setBeginSmsChallengeStatus(this.MobileContactNotValidButPhoneCallMadeAnyway),u={phoneCountryCode:this.phoneFields.getPhoneControl().getPhoneCountryCode(),phoneNumber:t,offer:e,countryCode:o,deliveryType:n.toString()},f=appendQueryString(this.BeginSmsChallengeURL,u),$("#sendChallenge").prop("disabled",!0),auxPost(f,function(n){n===!0?($("#confirmCodeDiv").show(),$("#confirmChallenge").show(),$("#confirmationText").focus()):i.showOnlyContactSupportForm()},function(n){var t=null,r;n&&n.status!=500&&n.responseText&&(t=$.parseJSON(n.responseText))&&t.message?(r=t.message,$.wizard?$.wizard().showErrorInNotificationBar(r):($("#errorCallSupport p").html(r),$("#errorCallSupport").show())):i.showOnlyContactSupportForm()}))},iAmInAWizard:function(){return $.wizard&&$.wizard()&&$.wizard().isControlling("#smsChallengeForm")},completeSmsChallenge:function(){var n=this,t=$("#confirmationText").val(),i;t&&t!=""&&n.stripNonDigit(t)==t?(i=n.CompleteSmsChallengeURL,auxPost(i,function(t){var i=$("#confirmChallenge");t==!0?($(i).trigger("smsChallengeCompleted",{phoneCountryCode:$("#countrySelector").val(),phoneNumber:n.stripNonDigit(n.phoneFields.getPhoneControl().getPhoneNumber())}),$.wizard?(i.wizardButton().disable().hide(),$("#sendChallenge").wizardButton().disable(),$.wizard().showInfoInNotificationBar(n.Verified)):($("#sendChallenge").attr("disabled","disabled"),i.hide()),$("#confirmationText").addClass("input-success-watermark"),$("#accept-and-continue").removeAttr("disabled"),n.iAmInAWizard()&&($("#sendChallenge").data("autoadvance")?$.wizard().goNext():$.wizard().enableNext()),$("#errorCallSupport").hide()):($("#sendChallenge").data("autoadvance",0),$.wizard?$.wizard().showInfoInNotificationBar(n.NotVerified+" "+n.ContactSupportText,n.SupportPageURL):($("#errorCallSupport p").html(n.NotVerified+' <a target="_blank" href="'+n.SupportPageURL+'">'+n.ContactSupportText+"<\/a>"),$("#errorCallSupport").show()))},function(){n.showOnlyContactSupportForm()},{confirmCode:t,confirmationGuid:this.ConfirmationGuid,offer:this.offer,countryCode:this.countryCode})):$.wizard?$.wizard().showErrorInNotificationBar(n.NotVerified):($("#errorCallSupport p").html(n.InvalidVerificationCode),$("#errorCallSupport").show())},beginSmsChallengeRoot:function(){typeof Signup.BotChallenge.customValidator=="function"?Signup.BotChallenge.customValidator()&&beginSmsChallenge():beginSmsChallenge()},completeSmsChallengeRoot:function(){typeof Signup.BotChallenge.customValidator=="function"?Signup.BotChallenge.customValidator()&&completeSmsChallenge():completeSmsChallenge()}};Signup.Index={steps:null,queryObject:null,init:function(){var n=this;$(".sign-up").wizard({steps:n.steps,itemToHide:"#page #main-container #main"});$("#wizard-button-next").data("queryString",n.queryObject);$(".sign-up").trigger("click")}};Signup.WelcomeToAzure={Model:{},Resources:{},FwLinks:{},userOfferInfo:null,showMainOffer:!0,shouldUpdateCountrySelector:!1,getCountryCodeInitialValue:function(){var t=this,n=getQueryStringValue(_QS_COUNTRY_CODE);return n||(n=t.Model.CountryCode),n.toUpperCase()},initializeCountryDropDown:function(){var n=this,t=n.Model.CountryDropDownListItemsJson,r=n.Model.CountryInfoJson,i=n.getCountryCodeInitialValue();!n.MintAccountExists&&t.length>1&&$.inArray(i,t)!=-1&&(n.shouldUpdateCountrySelector=!0,$("#offer-country-sel-container").show(),getQueryStringValue(_QS_COUNTRY_CODE)&&(n.shouldUpdateCountrySelector=!1),$("#country-selector").focus(function(){n.shouldUpdateCountrySelector=!1}),$.each(t,function(n,t){var u=t==i;$("#country-selector").append($("<option>",{value:t,selected:u,defaultSelected:u}).text(r[t].Name))}))},showMarketingInfo:function(n,t){var u=this,i,r;$("#loading-offer").hide();$("#offer-info-mktg").html(n).show().data(window._DK_OFFER,t.OfferId);i=u.Model.PhoneNumberRequired;r=t.PaymentInstrumentRequired;t.IsAzureChina?$(".what-we-need").hide():(i||r?$(".what-we-need").show():$(".what-we-need").hide(),i?$(".need-phone").show():$(".need-phone").hide(),r?$(".need-card").show():$(".need-card").hide());$("#offer-info-container").show()},getCountryCode:function(){var i=this,n,t;return n=$("#country-selector").is(":visible")?$("#country-selector").val():i.getCountryCodeInitialValue(),t=getQueryStringObj(),t&&(t[_QS_COUNTRY_CODE]=n),n},toggleOffer:function(){var n=this;n.shouldUpdateCountrySelector=!1;n.showMainOffer=!n.showMainOffer;n.refreshUiOnOfferChange()},showAlternateOffer:function(){var n=this;n.shouldUpdateCountrySelector=!1;n.showMainOffer=!1;n.refreshUiOnOfferChange()},getEnglishUrl:function(){var t=this,i=t.getCountryCode(),n={},t=this;return n[_QS_OFFER]=getQueryStringValue(_QS_OFFER),n[_QS_COUNTRY_CODE]=i,n[_QS_LOCALE]="en-US",appendQueryString(t.Url.SignUp,n)},switchToEnglish:function(){var n=this,t=n.getEnglishUrl();window.location=t},refreshUiOnCountryChange:function(){var n=this,i,t,r;$("#switch-to-english").hide();$("#offer-error").hide();$("#alt-offer-suggestion").hide();$("#offer-info-container").show();$("#loading-offer").show();$.wizard().hideNotificationBar();i=n.getCountryCode();t={};t[_QS_OFFER]=getQueryStringValue(_QS_OFFER);t[_QS_COUNTRY_CODE]=i;t[_QS_PROMOCODE]=getQueryStringValue(_QS_PROMOCODE);r=appendQueryString(n.Url.GetOfferStatus,t);auxPost(r,function(t){n.userOfferInfo=$.parseJSON(t);var i=n.userOfferInfo.SelectedOffer;$("#loading-offer").hide();n.refreshUiOnOfferChange()})},setup:function(){var n=this,t=n.Model.CountryDropDownListItemsJson;$("#enable-account-scroll-region").auxScrollbar&&$("#enable-account-scroll-region").auxScrollbar().find(":first").focus();n.initializeCountryDropDown();$("#country-selector").change(function(){n.refreshUiOnCountryChange()});$("#alt-offer-suggestion").click(function(){n.toggleOffer()});$("#switch-to-english").click(function(){n.switchToEnglish()});n.shouldUpdateCountrySelector?auxPost(n.Url.GetCountryCodeByUserIpAddress,function(i){i&&(i=i.toUpperCase(),n.shouldUpdateCountrySelector&&$.inArray(i,t)!=-1&&$("#country-selector").val(i).change())},function(){n.refreshUiOnCountryChange()}):n.refreshUiOnCountryChange()},refreshUiOnOfferChange:function(){var n=this,r,t=n.userOfferInfo,f=n.showMainOffer,c,a,v,w,b,k,h,u,i,o,d,y,g,e,p,s,nt,tt;if($.wizard&&$.wizard().disableNext(),$("#offer-error").hide(),$("#alt-offer-suggestion").hide(),c=getQueryStringObj(),a=c.fid,!!a&&n.MintAccountExists)s={fid:a},v=appendQueryString(n.Url.BetaFeatures,s),window.location=v;else{if(f?t.SelectedOfferAvailabilityState==n.OfferingInfoAvailabilityState.Available&&(r=t.SelectedOffer):r=t.AlternateOffer,r&&c&&(c.offerGuid=r.OfferGuid),r&&(w=r.OfferId,$("#offer-info-container").show(),$("#loading-offer").show(),b=n.Url.GetSignUpMarketingContent+"&"+window._QS_OFFER+"="+w+"&"+window._QS_COUNTRY_CODE+"="+n.getCountryCode()+"&"+window._QS_PROMOCODE+"="+(getQueryStringValue(_QS_PROMOCODE)||""),auxGet(b,function(t){n.showMarketingInfo(t,r)},function(){n.showMarketingInfo(r.ShortDescription,r)})),f&&t.SelectedOfferAvailabilityState!=n.OfferingInfoAvailabilityState.Available){if($("#fix-suggestion").hide(),h=!1,t.EnglishAvailability==n.OfferingInfoEnglishAvailability.Yes){$("#offer-error-title").text(n.Resources.OfferNotAvailable);var it=n.getCountryCode(),ft=t.UILanguage.indexOf("("),rt=n.Model.CountryInfoJson[it].Name;$("#offer-error-why").text(n.Resources.OfferNotAvailableInGivenCountryLocale.format(t.UILanguage,rt));$("#fix-suggestion").text(n.Resources.VerifyCountry);h=!0;var v=n.getEnglishUrl(),e=$("<a/>").attr({href:v}).text(n.Resources.SignupForOfferInEnglish),l=$("#alternate-offer a");l.length>0?l.replaceWith(e):$("#alternate-offer").append(e);$("#alternate-offer a").click(function(){return n.switchToEnglish(),!1})}else{o=t.SelectedOffer?t.SelectedOffer.ShortDescription:t.RequestedOffer;t.SelectedOfferAvailabilityState==n.OfferingInfoAvailabilityState.FreeTrialNotAvailable?$("#offer-error-title").text(n.Resources.FreeTrialOfferNotAvailableTitle):$("#offer-error-title").text(n.Resources.OfferNotAvailableWithOfferText.format(o));u=n.StateToResourceMap[t.SelectedOfferAvailabilityState];i=!1;k=n.Resources.SignupForAlternateOffer;switch(t.SelectedOfferAvailabilityState){case n.OfferingInfoAvailabilityState.UnableToDetermineEntitlementEligibility:t.OfferEntitlementCategory==n.MSDNEntitlementCategory?$("#offer-error-why").text(n.Resources.UnableToDetermineMsdnSubscription):$("#offer-error-why").text(u.format(t.OfferEntitlementCategory,t.OfferEntitlementCategory));$("#fix-suggestion").text(n.Resources.RefreshPageToVerify);h=!0;i=!0;break;case n.OfferingInfoAvailabilityState.FreeTrialNotAvailable:$("#offer-error-why").text(u);break;case n.OfferingInfoAvailabilityState.FreeTrialNotEligible:$("#offer-error-why").text(u);break;case n.OfferingInfoAvailabilityState.NotEntitled:$("#offer-error-why").text(u.format(t.OfferEntitlementCategory));i=!0;break;case n.OfferingInfoAvailabilityState.NotEligible:t.OfferEntitlementCategory==n.MSDNEntitlementCategory?$("#offer-error-why").text(n.Resources.NotEligibleForMsdn):$("#offer-error-why").text(u.format(t.OfferEntitlementCategory));i=!0;break;case n.OfferingInfoAvailabilityState.Redeemed:t.OfferEntitlementCategory==n.MSDNEntitlementCategory?$("#offer-error-why").text(n.Resources.MsdnRedeemed):$("#offer-error-why").text(u);i=!0;break;case n.OfferingInfoAvailabilityState.NotMemberOffer:o=u.format(t.OfferEntitlementCategory,t.OfferEntitlementCategory,t.OfferEntitlementCategory);t.OfferEntitlementCategory==n.EAEntitlementCategory?(d=n.EntitlementToMembershipPageMap[t.OfferEntitlementCategory],o=o+" "+n.Resources.EASupportMessage.format(d),$("#offer-error-why").html(o)):$("#offer-error-why").text(o);i=!0;break;case n.OfferingInfoAvailabilityState.NotAvailable:$("#offer-error-why").text(u.format(t.RequestedOffer))}i&&t.OfferEntitlementCategory!=null?(y=n.EntitlementToMembershipPageMap[t.OfferEntitlementCategory],y!=null?(g=t.OfferEntitlementCategory==n.MSDNEntitlementCategory?n.Resources.VerifyMSDNSubscription:n.Resources.VerifyMembership.format(t.OfferEntitlementCategory),e=$("<a/>").attr({href:y}).text(g),p=$("#verify-membership-suggestion a"),p.length>0?p.replaceWith(e):$("#verify-membership-suggestion").append(e)):i=!1):i=!1}if(t.AlternateOffer){s={};n=this;s[_QS_OFFER]=t.AlternateOffer.OfferId;var ut=appendQueryString(n.Url.SignUp,s),e=$("<a/>").attr({href:ut}).text(k.format(t.AlternateOffer.ShortDescription)),l=$("#alternate-offer a");l.length>0?l.replaceWith(e):$("#alternate-offer").append(e);$("#alternate-offer a").click(function(){return n.showAlternateOffer(),!1})}}(f&&t.SelectedOfferAvailabilityState==n.OfferingInfoAvailabilityState.Available||!f&&t.AlternateOffer)&&$.wizard&&$.wizard().enableNext();f&&t.SelectedOfferAvailabilityState!=n.OfferingInfoAvailabilityState.Unknown&&t.SelectedOfferAvailabilityState!=n.OfferingInfoAvailabilityState.Available&&($("#enable-account h1").hide(),$("#offer-info-mktg").hide(),$("#offer-info-container").hide(),h&&$("#fix-suggestion").show(),i||t.AlternateOffer||h||$("#offer-error-what").hide(),$("#offer-error").show());f&&t.AlternateOffer?t.SelectedOfferAvailabilityState==n.OfferingInfoAvailabilityState.Available&&$.wizard().showInfoInNotificationBar(n.Resources.ClickHereToGetSuggestedAlternateOffer,function(){$.wizard().hideNotificationBar();n.toggleOffer()}):f||t.SelectedOfferAvailabilityState!=n.OfferingInfoAvailabilityState.Available||$.wizard().showInfoInNotificationBar(n.Resources.ClickHereToReturnToMainOffer,function(){$.wizard().hideNotificationBar();n.toggleOffer()});nt&&(tt=!0,$("#alt-offer-suggestion").show(),$("#alt-offer-suggestion-para").text(nt));tt&&$(".enable-account-scroll-region").css("height","285px")}},init:function(){var n=this;window._DK_OFFER="offer";n.setup();$("#wizard-button-next").unbind("click.ed");$("#wizard-button-next").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-acctwiz1")});$("#wizard-button-close").unbind("click.ed");$("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer"," Cancel-Abandon","WT.z_iLinks_targetcampaign","src-acctwiz1")})}},function(n,t){"use strict";var r={},u={},ot,s,dt,g,fr,er=!1,ci,li,gt,st,ni=!0,ht="ActionsOnSmsChallenge",h="CreateOrUpdateAccount",nt="ValidateCommitmentDetails",e="AddPI",c="ExistingPI",ai="ChangePI",or="AddCommitmentDetails",sr="AddPrepaidAmount",hr="AddPrepaidToken",a="ValidatePrepaidToken",tt=".about-you-container #CountryCode",rf=".about-you-container #CustomerInfo_CnpjCpfSelector",o=".single-signup .about-you-container",uf=".single-signup #offer-error .country",vi=".single-signup #CountryCodeOnErrorMessage",ff=".mobile-info-container .content-container",cr=".mobile-info-container .sms-challenge",ct=".mobile-info-container .phone-number-save",ef="#workphoneContainer",lr=".mobile-info-container .mobileVerificationBalloon",ar=".mobile-info-container .PhoneNumberBalloon",yi=".single-signup .mobile-info-container .retry-message",vr=".single-signup #confirmChallenge",of=".single-signup #confirmationText",sf=".single-signup .agreement-container",v=".single-signup input, .single-signup select",yr=".single-signup .select-offer-container",lt=".single-signup .purchase",pr=".single-signup .purchase .description",wr=".single-signup #checkbox-rateplan",hf=".payment-info-container .content-container",it=".payment-info-container .savePI",ti=".payment-info-container .savePI-spinner",ii=".payment-info-container .saveChangePI",at=".payment-info-container .saveChangePI .save",ri=".payment-info-container .saveChangePI .saveChangePI-spinner",pi=".payment-info-container .payment-info-changePI .progress",f=".payment-info-container .pcs-iframe-container",rt=".payment-info-container .existing-pi-container",vt=".single-signup .error",cf=".single-signup .offer-error-message-section",br=".single-signup .loading-page",lf=".special-fields",wi="#CustomerInfo_FirstName",bi="#CustomerInfo_LastName",y="#CustomerInfo_VatId",yt="#CustomerInfo_Cnpj",p="#CustomerInfo_Cpf",kr="#CustomerInfo_CnpjCpfSelector",ui="#CustomerInfo_FirstNamePronunciation",fi="#CustomerInfo_LastNamePronunciation",w="#CustomerInfo_Ccm",pt="#CustomerInfo_TaxId",b="#CustomerInfo_BusinessRegistrationNumber",dr=".vatId",gr=".cnpj",nu=".cpf",tu=".first-name-pronunciation",iu=".last-name-pronunciation",ru=".ccm",uu=".taxId",fu=".businessRegistrationNumber",eu=".cnpjCpfSelector",ou=".phone-number-save .phone-no-countrySelector",ki=".single-signup .signup-spinner",di=".single-signup .commitment-container-spinner",wt=".single-signup .phone-number-save .phone-number-spinner",su=".single-signup #rate-plan span",af=".single-signup .agreement-container",ut=".single-signup .offer-name",ei=".single-signup .single-signup-form",i="hide",hu="showCatalog",gi="promoCode",nr="offerCategory",cu="defaultContactEmail",lu=!1,oi="-10000px",au=".single-signup .about-you-container .cpf .optional-hint",vu=".single-signup .about-you-container .ccm .optional-hint",vf=".single-signup .about-you-container .vatId .optional-hint",yu=!1,yf="CustomerInfo.VatId",pf="CustomerInfo.TaxId",wf="CustomerInfo.BusinessRegistrationNumber",pu="CustomerInfo.Cnpj",wu="CustomerInfo.Cpf",bu="CustomerInfo.Ccm",tr="#CustomerInfo_ContactEmail",ft="#CustomerInfo_CompanyName",ir=".single-signup .about-you-container .company-name .optional-hint",bf=".single-signup .about-you-container .businessRegistrationNumber .optional-hint",kf="#phone-no-countrySelector",ku=".phone-no-countrySelector",si=".single-signup .payment-info-container .prepaid-amount-container",l="#prepaid-amount",du="PrepaidAmount",rr=".single-signup .prepaid-token-container .prepaid-token-content",k="#prepaid-token-text",et=".single-signup .prepaid-token-container .validate-prepaid-token-button",bt=".single-signup .prepaid-token-container .token-validation-message",hi=".single-signup .prepaid-token-container .token-validation-error-message",ur=".single-signup .purchase-button-section .token-activation-error-message",kt="#partner-contact-email",gu="#checkbox-marketing-phone",nf=".single-signup .agreement-container .consent-items .marketing-phone-container",tf=".single-signup .prepaid-token-container .partner-contact-email",d=function(){var t=n.Deferred().promise();return function(n,i){return(!t||n)&&(t=auxAjax({url:i,type:"POST",dataType:"json"})),t}}();t.Signup2.Index={Model:{},OfferResources:{},Resources:{},Url:{},FwUrl:{},phoneFields:new PhoneFields("phone-no-text","phone-no-countrySelector","phone-no-hint","Mobile phone","Mobile e-mail","mobileNumberLabel","mobileEmailLabel"),workphoneFields:new PhoneFields("work-phone-no-text","phone-no-countrySelector","workphone-no-hint","Work phone","Work e-mail","WorkNumberLabel","WorkEmailLabel"),showMainOffer:!0,displayedOfferWithPaymentInfo:null,AccountFieldsType:{},MarketingPreferences:{},CreateOrUpdateAccountValidationError:{},Widget:{},errorMessage:"",getPIRequiredStatus:function(t){var i=n.Deferred(),e=i.promise(),r=this,o=this.displayedOfferWithPaymentInfo.Offer.PaymentInstrumentRequired,f=this.displayedOfferWithPaymentInfo.Offer,u;return o?i.resolve(!0):this.displayedOfferWithPaymentInfo.AcceptsPI!==!0?i.resolve(!1):t.OfferStatus.ShowCatalog!==!0&&r.showMainOffer?i.resolve(t.RiskStatus.PIChallengeRequired):(this.showSpinner(),u={},u[_QS_OFFER]=f.OfferId,u[nr]=f.Categories,u[_QS_COUNTRY_CODE]=t.CountryCode,auxPost(this.Url.RiskChallengeStatusUrl,function(n){r.hideSpinner();n?i.resolve(n.PIChallengeRequired===!0):(r.hidePageAndShowError(r.Resources.SignUpGenericError),i.reject())},function(){r.hideSpinner();r.hidePageAndShowError(r.Resources.SignUpGenericError);i.reject()},u)),e},hideAllSections:function(){n(".single-signup .section").addClass(i);n(ei).addClass(i);n(vt,cf).addClass(i);n(cr).addClass(i);n(ct).addClass(i);n(lr).addClass(i);n(ar).addClass(i);n("#offer-error").addClass(i);n(wt).addClass(i);n(yi).addClass(i)},resetSpecialField:function(n,t,r){n.find(t).addClass(i);n.find(r).val("");n.find(r).removeAttr("disabled")},hideAndClearSpecialFieldsSection:function(n){var r=this,t=n.find(lf);t.addClass(i);t.find(eu).addClass(i);r.resetSpecialField(t,dr,y);r.resetSpecialField(t,gr,yt);r.resetSpecialField(t,nu,p);r.resetSpecialField(t,ru,w);r.resetSpecialField(t,uu,pt);r.resetSpecialField(t,tu,ui);r.resetSpecialField(t,iu,fi);r.resetSpecialField(t,fu,b)},hidePageAndShowError:function(t){n(ei).addClass(i);n(vt).html(t).removeClass(i)},showAlternateOfferNotification:function(t){var e=t.OfferStatus,o=this,r=n("#offer-error"),u,f;this.initializeErrorSection();r.find("#fix-suggestion").addClass(i);r.find("#fix-suggestion-with-action").addClass(i);r.find("#verify-membership-suggestion").addClass(i);r.find("#offer-error-why").addClass(i);r.find(".title h2").text(this.OfferResources.UpgradeTitle);r.find("#offer-error-title").text(this.OfferResources.EligibleForUpgrade);t.HasAzureAccount||this.showCountryDropDownInErrorContainer(t.CountryCode);u=n("#alternate-offer");this.setLinkForOffer(e.AlternateOffer.Offer,u,this.OfferResources.ChooseUpgradeOffer,function(n){return n.preventDefault(),o.showAlternateOffer(),!1});u.removeClass(i);f=n("#selected-offer");this.setLinkForOffer(e.SelectedOffer.Offer,f,this.OfferResources.ChooseCurrentOffer,function(n){return n.preventDefault(),o.refreshUiOnOfferChange(!0,!1),!1});f.removeClass(i);r.find("#offer-error-what").removeClass(i);r.removeClass(i)},setLinkForOffer:function(t,i,r,u){var o={},h=this,s,f,e;o[_QS_OFFER]=t.OfferId;s=appendQueryString(h.Url.SignUp,o);f=n("<a/>").attr({href:s}).text(r.format(t.ShortDescription));e=i.find("a");e.length>0?e.replaceWith(f):i.append(f);i.find("a").on("click",u)},showCountryDropDownInErrorContainer:function(t){this.updateCountryCodeDropDownValue(vi,t);n(uf).removeClass(i)},initializeErrorSection:function(){var t=n("#offer-error-what"),r=t.find("#fix-suggestion"),u=t.find("#fix-suggestion-with-action");r.text("");r.addClass(i);u.text("");u.addClass(i);t.find("#alternate-offer a").remove();t.find("#verify-membership-suggestion a").remove();t.addClass(i)},showOfferErrorPage:function(t){var r=this,u=t.OfferStatus,ut,w=!1,k=!1,d=!1,g=!1,y=n("#offer-error-title"),f=n("#offer-error"),e="#offer-error-why",b,nt,tt="#fix-suggestion",v,ft="#alternate-offer",o,et,ot,l,h,s,st,ht,c,a,it,ct,lt,rt,at,p={},vt;if(this.initializeErrorSection(),t.HasAzureAccount||u.SelectedOfferAvailabilityState==r.OfferingInfoAvailabilityState.NotAvailableForThisAccountType||this.showCountryDropDownInErrorContainer(t.CountryCode),u.EnglishAvailability==r.OfferingInfoEnglishAvailability.Yes)y.text(r.OfferResources.OfferNotAvailable),et=r.getCountryCode(),ot=r.Model.CountryInfoJson[et].Name,f.find(e).text(r.OfferResources.OfferNotAvailableInGivenCountryLocale.format(u.UILanguage,ot)),f.find(tt).text(r.OfferResources.VerifyCountry),w=!0,st=r.getEnglishUrl(u.RequestedOffer),c=n("<a/>").attr({href:st}).text(r.OfferResources.SignupForOfferInEnglish),v=f.find(ft),a=n("#alternate-offer a"),a.length>0?a.replaceWith(c):n("#alternate-offer").append(c),n("#alternate-offer a").click(function(n){return n.preventDefault(),r.switchToEnglish(u.RequestedOffer),!1}),v.removeClass(i);else{u.DoesUserHaveAnySubscriptions==!0&&(g=!0);l=u.SelectedOffer&&u.SelectedOffer.Offer&&u.SelectedOffer.Offer.ShortDescription?u.SelectedOffer.Offer.ShortDescription:u.RequestedOffer;u.SelectedOfferAvailabilityState==r.OfferingInfoAvailabilityState.FreeTrialNotAvailable?y.text(r.OfferResources.FreeTrialOfferNotAvailableTitle):u.SelectedOfferAvailabilityState==r.OfferingInfoAvailabilityState.DreamSparkOfferNotAvailable?y.text(r.OfferResources.DreamSparkOfferNotAvailableTitle):u.SelectedOfferAvailabilityState==r.OfferingInfoAvailabilityState.NotAvailableForThisAccountType?y.html(r.OfferResources.OfferNotAvailableForThisAccount.format(l,r.Url.SignupFailureSupportFwUrl)):y.text(r.OfferResources.OfferNotAvailableWithOfferText.format(l));u.OfferEntitlementCategory?(o=r.EntitlementToDescriptionMap[u.OfferEntitlementCategory],o||(o=u.OfferEntitlementCategory)):o="";s=r.StateToResourceMap[u.SelectedOfferAvailabilityState];h=!1;ut=r.OfferResources.SignupForAlternateOffer;switch(u.SelectedOfferAvailabilityState){case r.OfferingInfoAvailabilityState.UnableToDetermineEntitlementEligibility:u.OfferEntitlementCategory==r.MSDNEntitlementCategory?f.find(e).text(r.OfferResources.UnableToDetermineMsdnSubscription):f.find(e).text(s.format(o,o));f.find(tt).text(r.OfferResources.RefreshPageToVerify);w=!0;h=!0;break;case r.OfferingInfoAvailabilityState.FreeTrialNotAvailable:f.find(e).text(s);break;case r.OfferingInfoAvailabilityState.FreeTrialNotEligible:f.find(e).text(s);break;case r.OfferingInfoAvailabilityState.NotEntitled:f.find(e).text(s.format(o));h=!0;break;case r.OfferingInfoAvailabilityState.NotEligible:u.OfferEntitlementCategory==r.MSDNEntitlementCategory?f.find(e).text(r.OfferResources.NotEligibleForMsdn):u.OfferEntitlementCategory==r.AADEntitlementCategory?f.find(e).html(r.OfferResources.NotEligibleForAAD):f.find(e).text(s.format(o));h=!0;break;case r.OfferingInfoAvailabilityState.Redeemed:u.OfferEntitlementCategory==r.MSDNEntitlementCategory?f.find(e).text(r.OfferResources.MsdnRedeemed):f.find(e).text(s);h=!0;break;case r.OfferingInfoAvailabilityState.NotMemberOffer:l=s.format(o,o,o);u.OfferEntitlementCategory==r.EAEntitlementCategory?(ct=r.EntitlementToMembershipPageMap[u.OfferEntitlementCategory],l=l+" "+r.OfferResources.EASupportMessage.format(ct),f.find(e).html(l)):f.find(e).text(l);h=!0;break;case r.OfferingInfoAvailabilityState.NotAvailable:f.find(e).text(s.format(u.RequestedOffer));break;case r.OfferingInfoAvailabilityState.NotAvailableForThisAccountType:u.SelectedOffer&&u.SelectedOffer.Offer&&u.SelectedOffer.Offer.IsAzureInOpen?(f.find(e).text(r.OfferResources.AzureInOpenOfferNotAvailableForThisAccount),p.offer=u.SelectedOffer.Offer.OfferId,vt=appendQueryString(r.Url.RedeemAzureInOpenTokenFwUrl,p),rt=n("<a/>").attr({href:vt}).text(r.OfferResources.RedeemAzureInOpenTokenMessage),at=n("#fix-suggestion-with-action a"),at.length>0?a.replaceWith(rt):n("#fix-suggestion-with-action").append(rt),k=!0,d=!0):f.find(e).text(s.format(u.RequestedOffer));break;case r.OfferingInfoAvailabilityState.DreamSparkOfferNotAvailable:f.find(e).text(s)}h&&u.OfferEntitlementCategory!=null?(it=r.EntitlementToMembershipPageMap[u.OfferEntitlementCategory],it!=null?(lt=u.OfferEntitlementCategory==r.MSDNEntitlementCategory?r.OfferResources.VerifyMSDNSubscription:r.OfferResources.VerifyMembership.format(o),c=n("<a/>").attr({href:it,target:"_blank"}).text(lt),b=f.find("#verify-membership-suggestion"),nt=b.find("a"),nt.length>0?nt.replaceWith(c):b.append(c),b.removeClass(i)):h=!1):h=!1}u.AlternateOffer&&(p={},p[_QS_OFFER]=u.AlternateOffer.Offer.OfferId,ht=appendQueryString(r.Url.SignUp,p),c=n("<a/>").attr({href:ht}).text(ut.format(u.AlternateOffer.Offer.ShortDescription)),v=f.find(ft),a=v.find("a"),a.length>0?a.replaceWith(c):v.append(c),a.click(function(n){return n.preventDefault(),r.showAlternateOffer(),!1}),v.removeClass(i));w&&f.find(tt).removeClass(i);k&&f.find("#fix-suggestion-with-action").removeClass(i);d&&f.find("#contact-support").removeClass(i);(h||u.AlternateOffer||w||k||d||g)&&f.find("#offer-error-what").removeClass(i);g&&f.find("#subscriptions-link").removeClass(i);f.removeClass(i)},displayAboutYouSection:function(t,i){var f=this,r=n(o),u=i.AccountInfo;this.updateCountryCodeDropDownValue(tt,i.CountryCode);r.find(wi).val(u.FirstName);r.find(bi).val(u.LastName);r.find(tr).val(u.ContactEmail);r.find(ft).val(u.CompanyName);n(o).find(ft).val()?f.hideOptionalHint(n(ir)):f.showOptionalHint(n(ir));this.displaySpecialFieldsSection(r,i);this.setSectionNumberAndShowSection(t,r)},populateTaxExemptionInfoItem:function(n,t,r,u){var e=this,f=u.find(".optional-hint");n&&r?(t.val(r),t.attr("disabled","disabled"),f.length!=0&&e.hideOptionalHint(f)):f.length!=0&&e.showOptionalHint(f);u.removeClass(i)},displayCnpjCpfCcmTaxFields:function(t,r){var e=this,l=r.find(yt),s=r.find(gr),a=r.find(p),h=r.find(nu),v=r.find(w),c=r.find(ru),y=r.find(kr),b=r.find(eu),u=t.AccountInfo,f=t.AccountId,k=n(au),d=n(vu),o;f&&u.Cnpj?(e.populateTaxExemptionInfoItem(f,l,u.Cnpj,s),e.populateTaxExemptionInfoItem(f,v,u.Ccm,c)):f&&u.Cpf?e.populateTaxExemptionInfoItem(f,a,u.Cpf,h):(o=e.getCnpjCpfSelectedValue(kr),l.val(""),a.val(""),v.val(""),y.val(o),b.removeClass(i),o=="CNPJ"?(h.addClass(i),s.removeClass(i),c.removeClass(i)):o=="CPF"&&(s.addClass(i),c.addClass(i),h.removeClass(i)))},displaySpecialFieldsSection:function(n,t){var i=this,r=t.AccountInfo,e=r.SpecialFields,u=t.AccountId,o=n.find(y),s=n.find(dr),h=n.find(pt),c=n.find(uu),l=n.find(ui),a=n.find(tu),v=n.find(fi),p=n.find(iu),w=n.find(b),k=n.find(fu),f;for(this.hideAndClearSpecialFieldsSection(n),f=0;e!=null&&f<e.length;f++)switch(e[f]){case i.AccountFieldsType.VatId:i.populateTaxExemptionInfoItem(u,o,r.VatId,s);break;case i.AccountFieldsType.CnpjCpfCcm:i.displayCnpjCpfCcmTaxFields(t,n);break;case i.AccountFieldsType.FirstNamePronunciation:i.populateTaxExemptionInfoItem(u,l,r.FirstNamePronunciation,a);break;case i.AccountFieldsType.LastNamePronunciation:i.populateTaxExemptionInfoItem(u,v,r.LastNamePronunciation,p);break;case i.AccountFieldsType.TaxId:i.populateTaxExemptionInfoItem(u,h,r.TaxId,c);break;case i.AccountFieldsType.BusinessRegistrationNumber:i.populateTaxExemptionInfoItem(u,w,r.BusinessRegistrationNumber,k)}},setSectionNumberAndShowSection:function(n,t){t.find(".item-number").text(n);t.removeClass(i)},showSaveButtonInMobileSection:function(){var t=n(ct).find(".saveAndCreateAccount");t.removeAttr("disabled")},displaySmsOrPhoneInfoSection:function(t,r,u){var f=n(".single-signup .mobile-info-container"),e,o;r?(n(cr).removeClass(i),f.find(".title h2").text(this.Resources.MobileVerificationTitle),n(ef).removeClass(i),n(lr).removeClass(i)):(e=n(ct),f.find(".title h2").text(this.Resources.PhoneNumberTitle),n(ar).removeClass(i),o=e.find(".saveAndCreateAccount"),u?o.removeClass(i):o.addClass(i),e.removeClass(i));this.setSectionNumberAndShowSection(t,f)},showPrepaidTokenValidateButton:function(){var t=this;t.setPurchaseButtonState(!1);r[a]=!0;t.setEnableStateOfSelectedFormElements(n(et),!0)},displayPrepaidTokenSection:function(t){var i=n(".single-signup .prepaid-token-container");t===1&&this.expandPrepaidTokenSection();this.setSectionNumberAndShowSection(t,i)},displayPaymentSection:function(t){var i=n(".single-signup .payment-info-container");t===1&&this.expandPISection();this.setSectionNumberAndShowSection(t,i)},displayCommitmentInfo:function(t){var i=n(".single-signup .commitment-detail-container");this.setSectionNumberAndShowSection(t,i)},displayAgreement:function(r,u,f){var o=this,c=n(".single-signup .agreement-container"),s=n(lt),p=n(nf),e=n(gu),h,l={},a={},v,y;a.country=u.CountryCode;v=appendQueryString(this.Url.SubscriptionAgreementFwUrl,a);l.offer=this.displayedOfferWithPaymentInfo.Offer.OfferId;y=appendQueryString(this.Url.RatePlanFwUrl,l);f?n(su).html(this.Resources.AzureInOpenAgreement.format(this.Url.PrivacyStatementFwUrl)):n(su).html(this.Resources.MicrosoftAzureAgreementMessage.format(v,y,this.Url.PrivacyStatementFwUrl));ni=u.ShowSignAgreement;ni||n(af).hide();h=o.Model.CountryInfoJson[u.CountryCode].MarketingPreferences;h===o.MarketingPreferences.Notice?(e.attr("checked",!0),e.addClass(i)):h===o.MarketingPreferences.OptOut?(e.removeClass(i),e.attr("checked",!0)):(e.removeClass(i),e.attr("checked",!1));u.AccountInfo.HasMarketingPreference&&p.addClass(i);c.find(".consent-items").removeClass(i);f?(s.children(pr).text(this.Resources.Activate),gt=this.Resources.Activate,st=this.Resources.ActivateToolTipOnDisable):u.HasAzureAccount?(s.children(pr).text(this.Resources.Purchase),gt=this.Resources.Purchase,st=this.Resources.PurchaseToolTipOnDisable):(gt=this.Resources.SignUp,st=this.Resources.SignupToolTipOnDisable);s.attr("title",st).removeClass(i);n("#rate-plan a").on("click",function(){var i=n(this).attr("href");return t&&t.open(i,"_blank"),!1});this.displayedOfferWithPaymentInfo&&this.displayedOfferWithPaymentInfo.Offer&&this.displayedOfferWithPaymentInfo.Offer.IsEaOffer&&n(".agreement-container .consent-items #rate-plan span").text(this.Resources.MicrosoftAzureAgreementMessageForEA);this.setSectionNumberAndShowSection(r,c);this.enablePurchaseIfApplicable()},initializeStepsBeforeEnablingPurchase:function(n,t,i){r={};t.HasAzureAccount?t.RiskStatus.SmsChallengeRequired&&(r[ht]=!0):t.RiskStatus.SmsChallengeRequired?r[h]=!0:(n||i)&&(r[h]=!0);this.displayedOfferWithPaymentInfo.Offer.IsMonetaryCommitment&&(r[nt]=!0);i&&(r[a]=!0);n&&(this.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument===null?r[e]=!0:r[c]=!0)},initializePurchaseSteps:function(n,t,i){t.HasAzureAccount||t.RiskStatus.SmsChallengeRequired||n||i||(u[h]=!0);i&&(u[a]=!0,u[hr]=!0);n&&(this.displayedOfferWithPaymentInfo.Offer.IsMonetaryCommitment||(this.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument===null?u[e]=!0:this.displayedOfferWithPaymentInfo.Offer.IsPrepaid&&(u[c]=!0)),(this.displayedOfferWithPaymentInfo.Offer.IsPrepaid||this.displayedOfferWithPaymentInfo.Offer.IsPrepaidFreeTrial)&&(u[sr]=!0));this.displayedOfferWithPaymentInfo.Offer.IsMonetaryCommitment&&(u[or]=!0)},showPage:function(t){var r=this,h,s,o,c,l,e=1,u=this.displayedOfferWithPaymentInfo.Offer,a=n(".paymentInformationBalloon"),v=n(".paymentInformationForMonetaryCreditBalloon"),f,y;n.auxAnalytics.track.displaySignupPage(u.OfferId);yu=!0;f=u.PrepaidTokensSupported;this.updateOfferTitleAndContent(u.OfferId,u.ShortDescription,u.LongDescription);this.updateGenericTitle(t,f);n.when(this.getPIRequiredStatus(t)).then(function(p){if(o=p,r.initializeStepsBeforeEnablingPurchase(o,t,f),r.initializePurchaseSteps(o,t,f),h=t.HasAzureAccount?!1:!0,t.RiskStatus.SmsChallengeBanned){r.hidePageAndShowError(r.Resources.SignUpUnauthorizeGenericError);return}t.RiskStatus.SmsChallengeRequired?(n.auxAnalytics.track.displaySmsChallenge(u.OfferId),r.registerSmsShownKpi(u.OfferId,t.CountryCode),s=!0):s=t.HasAzureAccount?!1:!0;c=u.IsMonetaryCommitment;l=!0;h&&r.displayAboutYouSection(e++,t);s&&(y=o||f,r.displaySmsOrPhoneInfoSection(e++,t.RiskStatus.SmsChallengeRequired,y));f&&r.displayPrepaidTokenSection(e++);o&&(u.IsMonetaryCredit?(a.addClass(i),v.removeClass(i)):(v.addClass(i),a.removeClass(i)),r.displayPaymentSection(e++));c&&r.displayCommitmentInfo(e++);l&&r.displayAgreement(e++,t,f);n(ei).removeClass(i)})},getCountryCode:function(t){var i;return i=t?n(t).is(":visible")?n(t).val():this.Model.CountryCode:li?li:this.Model.CountryCode,li=i,i},getCnpjCpfSelectedValue:function(t){return n(t).is(":visible")?n(t).val():this.Model.CnpjCpfSelector},updateCountryCodeDropDownValue:function(t,i){n(t)&&n(t).val(i)},displayCreateOrUpdateAccountError:function(i,r){var u=this,f="",e="";switch(i){case u.CreateAccountValidationError.InvalidVatId:r==="KR"?(f=wf,e=u.Resources.InvalidBusinessRegistrationNumber):(f=yf,e=u.Resources.InvalidVatId);break;case u.CreateAccountValidationError.InvalidTaxId:f=pf;e=u.Resources.InvalidTaxId;break;case u.CreateAccountValidationError.InvalidCnpj:f=pu;e=u.Resources.InvalidCnpj;break;case u.CreateAccountValidationError.InvalidCcm:f=bu;e=u.Resources.InvalidCcm;break;case u.CreateAccountValidationError.InvalidCpf:f=wu;e=u.Resources.InvalidCpf;break;default:u.hidePageAndShowError(u.Resources.SignUpGenericError)}f&&e&&(t.Signup2.Index.errorMessage=e,n("[name='"+f+"']").fxTextBox("validate"))},collapseSectionAndCreateOrUpdateAccount:function(t,u,f){var e=this,c,s=n(o),l=s.find("input, select"),a=s.find(wi),v=s.find(bi),k=s.find(tr),nt=s.find(ft),it=s.find(y),rt=s.find(yt),ut=s.find(p),et=s.find(w),ot=s.find(pt),st=s.find(ui),ct=s.find(fi),lt=s.find(b);e.setEnableStateOfSelectedFormElements(l,!1);d().done(function(o){var s;!o.HasAzureAccount&&r[h]?(s=h,c=e.getCountryCode(tt),e.createOrUpdateAccount(o.AccountId,a.val(),v.val(),c,k.val(),nt.val(),u,t,e.displayedOfferWithPaymentInfo.Offer.Locale,it.val(),rt.val(),st.val(),ct.val(),et.val(),ot.val(),ut.val(),lt.val(),function(t){if(t)if(t.AccountId&&t.ValidationError===e.CreateAccountValidationError.None)dt=t.AccountId,g=t.AccountIdForPcs,r[h]=!1,e.refreshUiOnAccountSave(s);else{e.setEnableStateOfSelectedFormElements(l,!0);e.displayCreateOrUpdateAccountError(t.ValidationError,c);var u;f?(n(of).removeClass("input-success-watermark"),n(vr).show(),u=e.Resources.CreateAccountValidationErrorVerifyButton):(n(wt).addClass(i),u=e.Resources.CreateAccountValidationErrorSaveButton);n(yi).text(u).removeClass(i)}else e.hidePageAndShowError(e.Resources.SignUpGenericError)},function(){n(wt).addClass(i);e.hidePageAndShowError(e.Resources.SignUpGenericError)})):(f||n(wt).addClass(i),s=ht,r[ht]&&(r[ht]=!1),e.refreshUiOnAccountSave(s))})},createOrUpdateAccount:function(t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){var g={},nt=this;t&&(g.accountId=t);g.firstName=i;g.lastName=r;g[_QS_COUNTRY_CODE]=u;g.contactEmail=f;g.companyName=e;g.phoneNumber=o;g.phoneCountryCode=s;g.locale=h;g.vatId=c;g.cnpj=l;g.firstNamePronunciation=a;g.lastNamePronunciation=v;g.ccm=y;g.taxId=p;g.cpf=w;g.businessRegistrationNumber=b;auxPost(this.Url.CreateOrUpdateAccountUrl,function(t){n.auxAnalytics.track.verifyCreateOrUpdateAccount(nt.displayedOfferWithPaymentInfo.Offer.OfferId);k(t)},d,g)},refreshUiOnAccountSave:function(t){var r=n(ff),t;r.find(".content").addClass(i);r.find(".complete-step").removeClass(i);this.expandNextSections(t);this.enablePurchaseIfApplicable()},expandNextSections:function(n){(n===h||n===ht)&&(r[e]||r[c]?this.expandPISection():r[a]&&this.expandPrepaidTokenSection())},expandPrepaidTokenSection:function(){n(rr).removeClass(i)},expandPISection:function(){var t=this,h=n.noop,l=t.displayedOfferWithPaymentInfo.Offer.OfferId,o,a;if(n(f).data("auxPcsv2")&&n(f).auxPcsv2("destroy"),r[e]){if(u[e]=!0,r[nt]){n(it).on("click",function(){t.setPIButtonState(!1,n(it),ti);n(f).data("auxPcsv2")&&n(f).auxPcsv2("performNext").done(function(f){n.auxAnalytics.track.completeAddNewPI(l);s=f.piid;t.updateExistingPIFromServer(s,function(f){f?(t.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument=f,t.displayedOfferWithPaymentInfo.AddPcsUrl=t.displayedOfferWithPaymentInfo.AddPcsUrlWithExistingUrl,u[e]=!1,r[e]=!1,r[c]=!0,t.setPIButtonState(!1,n(it),ti),n(it).addClass(i),n(ti).addClass(i),t.expandPISection(),r[nt]===!0&&t.expandMonetaryCommitment()):t.hidePageAndShowError(t.Resources.SignUpGenericError)},function(){t.hideSpinner(pi)})}).fail(function(){t.setPIButtonState(!0,n(it),ti)})});h=function(){n(it).removeClass(i)}}n.auxAnalytics.track.displayNewPI(l);this.loadPcsIframe(h)}else r[c]&&(n(rt).data("auxDisplayPiBrief")&&n(rt).auxDisplayPiBrief("destroy"),s=this.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument.PaymentInstrumentId,n(ii).addClass(i),o=new n.aux.auxDisplayPiBrief.PiBrief,o.brand=this.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument.Brand,o.friendlyName=this.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument.FriendlyName,a=n.extend({},{creditCardText:this.Widget.DisplayPiBrief.CreditCardText,changePaymentMethodText:this.Widget.DisplayPiBrief.ChangePaymentMethodText,cancelChangePaymentMethodText:this.Widget.DisplayPiBrief.CancelChangePaymentMethodText,piBrief:o,changePaymentMethodPcsUrl:this.displayedOfferWithPaymentInfo.AddPcsUrl,changePaymentMethod:function(){s=null;r[ai]=!0;t.enablePurchaseIfApplicable();n(rt).addClass("dashed-border");t.changePaymentMethod.call(t)},cancelChangePaymentMethod:function(){s=t.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument.PaymentInstrumentId;r[e]=!1;r[ai]=!1;t.enablePurchaseIfApplicable();n(ii).addClass(i);n(rt).removeClass("dashed-border");n(f).data("auxPcsv2")&&n(f).auxPcsv2("destroy")}}),n(rt).auxDisplayPiBrief(a),r[c]=!1,r[nt]===!0&&this.expandMonetaryCommitment(),(t.displayedOfferWithPaymentInfo.Offer.IsPrepaid||t.displayedOfferWithPaymentInfo.Offer.IsPrepaidFreeTrial)&&t.showPrepaidAmount());this.enablePurchaseIfApplicable()},updateExistingPIFromServer:function(n,t,i){var r={},u;r.paymentInstrumentId=n;u=appendQueryString(this.Url.GetPaymentInstrumentBriefUrl,r);auxPost(u,function(n){var i;n&&(i=n.piBrief);t&&t(i)},function(){i&&i()})},changePaymentMethod:function(){var t=this;n(at).on("click",function(){n(f).data("auxPcsv2")&&(t.setPIButtonState(!1,n(at),ri),n(f).auxPcsv2("performNext").done(function(u){s=u.piid;n(ii).addClass(i);t.setPIButtonState(!1,n(at),ri);n(f).data("auxPcsv2")&&n(f).auxPcsv2("destroy");t.showSpinner(pi);n(rt).removeClass("dashed-border");t.updateExistingPIFromServer(s,function(n){n&&(t.displayedOfferWithPaymentInfo.ExistingValidPaymentInstrument=n,r[c]=!0,r[ai]=!1);t.expandPISection();t.hideSpinner(pi)},function(){t.hidePageAndShowError(t.Resources.SignUpGenericError)})}).fail(function(){t.setPIButtonState(!0,n(at),ri)}))});this.loadPcsIframe(function(){n(at).attr("disabled",!1);n(ri).addClass(i);n(ii).removeClass(i)})},loadPcsIframe:function(t){var i=this,r=this.displayedOfferWithPaymentInfo.AddPcsUrl,u,e;n(f).data("auxPcsv2")&&n(f).auxPcsv2("destroy");g&&(u={},u.accountid=g,r=appendQueryString(r,u));e=n.extend({},{pcsUrl:r,loadingImageUrl:this.Widget.PcsV2.LoadingImageUrl,waitText:this.Widget.PcsV2.GenericWait,navigaton:function(n){i.onPcsNavigationRequired.call(i,n)},error:function(n){i.onPcsError.call(i,n)},loaded:function(){i.onPcsLoaded.call(i,t)}});n(f).auxPcsv2(e)},onPcsLoaded:function(n){r[e]&&((this.displayedOfferWithPaymentInfo.Offer.IsPrepaid||this.displayedOfferWithPaymentInfo.Offer.IsPrepaidFreeTrial)&&this.showPrepaidAmount(),r[e]=!1);this.enablePurchaseIfApplicable();n&&n()},onPcsError:function(n){var t=this.Widget.PcsV2.ErrorCodes;n===t.NotLoggedIn||n===t.SessionExpired?this.hidePageAndShowError(this.Resources.LoginSessionHasExpired):n===t.UserCancelled||(n===t.DisagreeWithConsent?window.top.location.href=this.Url.SignupDefaultReturnUrl:n===t.GenericError||(n?this.hidePageAndShowError(this.Resources.SignUpGenericError+" ["+n+"]"):this.hidePageAndShowError(this.Resources.SignUpGenericError)))},onPcsNavigationRequired:function(n){n&&(t.location=n)},showPrepaidAmount:function(){var t=this;t.displayedOfferWithPaymentInfo!=null&&t.displayedOfferWithPaymentInfo.Offer.MinimumPrepaidReloadAmount&&n(si).find(l).val(t.displayedOfferWithPaymentInfo.Offer.MinimumPrepaidReloadAmount);t.setEnableStateOfPrepaidAmountElement(!0);n(si).removeClass(i)},expandMonetaryCommitment:function(){var t=this,i={},r;i.offerGuid=ot;i.commitmentAmount=this.Model.CommitmentAmount;r=appendQueryString(this.Url.RetrieveCommitmentDetailsUrl,i);t.showSpinner(di);auxPost(r,function(i){n(".commitment-detail-container .content").html(i);t.hideSpinner(di)},function(){t.hideSpinner(di)})},createRioIframe:function(t){n('<iframe height="1" width="1" frameborder="0" scrolling="no" />').css("margin-left",oi).css("margin-top",oi).appendTo("body").attr("src",this.Url.RioTrackingUrl+"?offerGuid="+t)},createInsideSocialIframe:function(){n('<iframe height="1" width="1" frameborder="0" scrolling="no" />').css("margin-left",oi).css("margin-top",oi).appendTo("body").attr("src","https://cdn1.insidesoci.al/static/js/microsoft/windowsazure/msft-waz-b.html")},proceedWithPurchase:function(){var t=this,nt,r,it,rt,ut,et,wt=n(l),f,ct=n(k),st,lt=n(kt),at=function(){d().done(function(){var r={};u[or]&&(r.commitmentAmount=fr);u[sr]&&(et=n(si).find(l).val(),r.prepaidAmount=et);u[hr]&&(f=n(rr).find(ct).val(),f&&(f=f.trim().toUpperCase()),r.prepaidToken=f,st=n(rr).find(lt).val(),r.partnerContactEmail=st);r["offerGuid"]=ot;!er&&(t.displayedOfferWithPaymentInfo.Offer.PaymentInstrumentRequired&&s||!t.displayedOfferWithPaymentInfo.Offer.PaymentInstrumentRequired)&&(er=!0,t.setPurchaseButtonAndSpinnerState(!1),t.createRioIframe(ot),s&&(r["piId"]=s),ut=n(sf),n(nf).hasClass(i)||(r["allowMarketing"]=n(gu).prop("checked")?!0:!1),ut.find("#checkbox-rateplan").attr("checked")=="checked"&&(r["agreeRatePlan"]=!0),r[gi]=t.Model.PromoCode,auxPost(t.Url.PurchaseUrl,function(i){i.TrackingUrl?(Signup2.SubscriptionPurchaseTracker.startTracking(i.TrackingUrl,i.AsynchronousPaymentUrl,t.displayedOfferWithPaymentInfo.Offer.OfferId),lu=!0,n.auxAnalytics.track.signupComplete(t.displayedOfferWithPaymentInfo.Offer.OfferId),i.IsFreeTrial&&t.createInsideSocialIframe()):t.hidePageAndShowError(t.Resources.SignUpGenericError)},function(i){var u=t.Resources.SignUpGenericError,r=null;t.hideSpinner(ki);i&&i.status!==500&&i.responseText&&(r=n.parseJSON(i.responseText))&&r.message&&(u=r.message);t.hidePageAndShowError(u)},r))})},vt=function(){d().done(function(i){r=n(o);nt=t.getCountryCode(tt);it=n(ou).val();rt=t.stripNonDigit(t.phoneFields.getPhoneControl().getPhoneNumber());t.createOrUpdateAccount(i.AccountId,r.find(wi).val(),r.find(bi).val(),nt,r.find(tr).val(),r.find(ft).val(),rt,it,t.displayedOfferWithPaymentInfo.Offer.Locale,r.find(y).val(),r.find(yt).val(),r.find(ui).val(),r.find(fi).val(),r.find(w).val(),r.find(pt).val(),r.find(p).val(),r.find(b).val(),function(i){i?i.AccountId&&i.ValidationError===t.CreateAccountValidationError.None?(dt=i.AccountId,g=i.AccountIdForPcs,u[h]=!1,t.proceedWithPurchase()):(t.setEnableStateOfAllFormElements(n(v),!0),t.setPurchaseButtonAndSpinnerState(!0),t.displayCreateOrUpdateAccountError(i.ValidationError,nt)):t.hidePageAndShowError(t.Resources.SignUpGenericError)},function(){t.hidePageAndShowError(t.Resources.SignUpGenericError)})})},ht;u[h]?t.validateCreateOrUpdateAccountRequiredFields()?(t.setEnableStateOfAllFormElements(n(v),!1),t.setPurchaseButtonAndSpinnerState(!1),vt()):(t.setEnableStateOfAllFormElements(n(v),!0),t.setPurchaseButtonAndSpinnerState(!0)):u[a]?t.validatePrepaidTokenDuringPurchase():u[e]?t.displayedOfferWithPaymentInfo.Offer.IsPrepaid?(ht=t.validatePrepaidAmount(),ht?(t.setEnableStateOfPrepaidAmountElement(!1),t.addnewPI()):t.setPurchaseButtonAndSpinnerState(!0)):t.addnewPI():u[c]?t.displayedOfferWithPaymentInfo.Offer.IsPrepaid&&(t.validatePrepaidAmount()?(t.setEnableStateOfPrepaidAmountElement(!1),u[c]=!1,t.proceedWithPurchase()):(t.setEnableStateOfPrepaidAmountElement(!0),t.setPurchaseButtonAndSpinnerState(!0))):at()},showPrepaidTokenValidationMessage:function(t,r){var u=this;n(bt).addClass(i);n(hi).addClass(i);t?(n(bt).text(r),n(bt).removeClass(i)):(n(hi).text(r),n(hi).removeClass(i))},validatePrepaidTokenDuringPurchase:function(){var t=this,r=n(k),f,e=n(ur);t.setEnableStateOfSelectedFormElements(n(et),!1);f=t.partnerContactEmailValidation();f?(this.setEnableStateOfSelectedFormElements(n(kt),!1),t.validatePrepaidToken(r.val(),function(f){f.availableCreditsMessage?(u[a]=!1,t.setEnableStateOfAllFormElements(n(v),!1),t.setPurchaseButtonAndSpinnerState(!1),t.proceedWithPurchase()):(n(bt).addClass(i),r.removeClass("fx-validation-valid").addClass("fx-validation-invalid"),e.text(t.Resources.PrepaidTokenActivationFailed),e.removeClass(i),t.setEnableStateOfAllFormElements(n(v),!0),t.setPurchaseButtonAndSpinnerState(!0))},function(n){t._showInvalidPrepaidToken(n)})):(t.setEnableStateOfAllFormElements(n(v),!0),t.setPurchaseButtonAndSpinnerState(!0))},_showInvalidPrepaidToken:function(t,i){var u=this,f=i,e=n(k),r=null;t&&t.responseText&&(r=n.parseJSON(t.responseText))&&r.message&&(f=r.message);e.removeClass("fx-validation-deferred-pending").addClass("fx-validation-invalid");u.setEnableStateOfSelectedFormElements(n(et),!0);u.showPrepaidTokenValidationMessage(!1,f)},addnewPI:function(){var t=this;n(f).data("auxPcsv2")&&n(f).auxPcsv2("performNext").done(function(r){n.auxAnalytics.track.completeAddNewPI(t.displayedOfferWithPaymentInfo.Offer.OfferId);s=r.piid;n(f).auxPcsv2("destroy");u[e]=!1;var o=n(hf);o.find(".content").addClass(i);o.find(".complete-step").removeClass(i);t.proceedWithPurchase()}).fail(function(){t.displayedOfferWithPaymentInfo.Offer.IsPrepaid&&t.setEnableStateOfPrepaidAmountElement(!0);t.setPurchaseButtonAndSpinnerState(!0)})},validatePrepaidToken:function(n,t,i){if(n)auxPost(this.Url.ValidatePrepaidTokenUrl,function(n){t(n)},i,{prepaidTokenCode:n.trim().toUpperCase()});else return!1},validatePrepaidAmount:function(){var i=this,r,u,f=i.displayedOfferWithPaymentInfo.Offer.MinimumPrepaidReloadAmount;return u=parseInt(n(si).find(l).val(),10),isNaN(u)||u>i.Model.MaximumPrepaidReloadAmount?(r=!1,t.Signup2.Index.errorMessage=i.Resources.PrepaidAmountInvalid,n("[name='"+du+"']").fxTextBox("validate")):u<f?(r=!1,t.Signup2.Index.errorMessage=i.Resources.MinimumPrepaidAmountInvalid.replace("{0}",f),n("[name='"+du+"']").fxTextBox("validate")):r=!0,r},enablePurchaseIfApplicable:function(){var t=this,i;i=this.areRequiredStepsCompleted();(ni&&n(wr).prop("checked")||!ni)&&i?t.setPurchaseButtonState(!0):t.setPurchaseButtonState(!1)},areRequiredStepsCompleted:function(){for(var n in r)if(r[n])return!1;return!0},handleMCValidationNotification:function(n){r[nt]=n?!1:!0;this.enablePurchaseIfApplicable()},stripNonDigit:function(n){return n.replace(/[^0-9]/g,"")},registerSmsShownKpi:function(n,t){var u=this,r,i={};i[_QS_OFFER]=n;i[_QS_COUNTRY_CODE]=t;r=appendQueryString(u.Url.RegisterSmsShownKpiUrl,i);auxAjax({url:r,type:"POST",dataType:"json"})},refreshUiOnCountryChange:function(t){var r=this,f,u={},e;r.showMainOffer=!0;r.hideAllSections();r.showSpinner();u[_QS_OFFER]=r.Model.Offer;u[_QS_COUNTRY_CODE]=t;u[hu]=r.Model.ShowCatalog;u[gi]=r.Model.PromoCode;u[nr]=r.Model.offerCategory;u[cu]=r.Model.DefaultContactEmail;f=appendQueryString(r.Url.GetCustomerDataUrl,u);e=d(!0,f);e.done(function(n){n&&(n.AccountId&&(dt=n.AccountId,g=n.AccountIdForPcs),r.hideSpinner(),r.refreshUiOnOfferChange())}).fail(function(){r.hideSpinner();n(vt).html(r.Resources.SignUpGenericError).removeClass(i)})},refreshUiOnOfferChange:function(t,r){var u=this,e,f,v,h=u.showMainOffer,o,c,s={},l,a;d().done(function(y){c=u.Model.DesiredBasFid;!!c&&y.HasAzureAccount?(s={fid:c},l=appendQueryString(u.Url.BetaFeatures,s),window.location=l):(f=y.OfferStatus,n("#offer-error").addClass(i),n(ei).addClass(i),o=f.ShowCatalog===!1?!1:!0,!o||o&&r?!t&&h&&f&&f.AlternateOffer&&f.SelectedOfferAvailabilityState==u.OfferingInfoAvailabilityState.Available?u.showAlternateOfferNotification(y):(o?e=u.displayedOfferWithPaymentInfo:h?f.SelectedOfferAvailabilityState==u.OfferingInfoAvailabilityState.Available&&(e=f.SelectedOffer):e=f.AlternateOffer,e?(u.setOffer(e),ot=e.Offer.OfferGuid,v=e.Offer.OfferId,u.showPage(y)):!o&&h&&f.SelectedOfferAvailabilityState!=u.OfferingInfoAvailabilityState.Available&&(f.SelectedOfferAvailabilityState==u.OfferingInfoAvailabilityState.RedirectToNewOffer?(s[_QS_OFFER]=f.NewOfferForRequestedOffer,a=appendQueryString(u.Url.SignUp,s),window.location=a):u.showOfferErrorPage(y))):(n(ut).children(".offer-name-signup").text(u.Resources.AddNewSubscription),f.OfferCatalog.EligibleOfferings==null||f.OfferCatalog.EligibleOfferings.length<1?n(vt).html(u.Resources.NoOffersAvailable).removeClass(i):(n(yr).removeClass(i),u.showCatalog(f.OfferCatalog))))})},createDropDownMenuOfferContent:function(t,r,u){var f,e=n("#offer-info-container");t!==null&&t.length>0?f=t:r!==undefined&&r!==null&&r.length>0&&(f=n("<div />").addClass("offer-text-title").append(n("<p />").html(r)));e.data("dropDownMenu")&&e.dropDownMenu("destroy");f!==undefined&&e.dropDownMenu({url:"../../Content/images/dropdown-arrow-white.png",text:this.Resources.LearnMore,textColor:"link-text-white",textLink:u,dropdownPointerPosition:"no-pointer",content:"html",elementsOnDropDownMenu:f}).removeClass(i)},updateGenericTitle:function(t,i){i?n(ut).children("span.offer-name-signup").text(this.Resources.Activate):t.HasAzureAccount?n(ut).children("span.offer-name-signup").text(this.Resources.Purchase):n(ut).children("span.offer-name-signup").text(this.Resources.SignUpFor)},updateOfferTitleAndContent:function(t,i,r){var u=this,e={},o,f;u.displayedOfferWithPaymentInfo?(o=u.Url.GetSignUpMarketingContent+"&"+_QS_OFFER+"="+t+"&"+_QS_COUNTRY_CODE+"="+u.getCountryCode(),e.offer=t,f=appendQueryString(u.Url.RatePlanFwUrl,e),auxGet(o,function(n){u.createDropDownMenuOfferContent(n,r,f)},function(){u.createDropDownMenuOfferContent(null,r,f)}),n(ut).children("span.offer-name-signup-azure").text(i)):n(ut).children("span.offer-name-signup-azure").text(this.Resources.MicrosoftAzure)},showAlternateOffer:function(){this.showMainOffer=!1;this.refreshUiOnOfferChange()},showCatalog:function(t){var i=this,r,u=n(".single-signup ul.offerings");r=t.OfferCategory&&t.OfferCategory.length>0?t.OfferCategory:"all";n.auxAnalytics.track.displayOfferCatalog(r);u.empty();n.each(t.EligibleOfferings,function(){var r={},t=this,f,e,o,s,h,c,l,a,v;r.offer=t.Offer.OfferId;f=appendQueryString(i.Url.RatePlanFwUrl,r);e=n("<li />").on("click",function(n){n.preventDefault();i.selectOfferFromCatalog(t)}).addClass(t.Offer.FriendlyCategory);o=n("<div />").addClass("offer-text");s=n("<a />").attr("href","#");h=n("<div />").addClass("offeringHeader");c=n("<h3 />").addClass("offeringTitle").text(t.Offer.ShortDescription);l=n("<div />").addClass("offeringInfo");a=n("<div />").addClass("description").text(t.Offer.LongDescription);v=n("<div />").addClass("learn-more").append(n("<a />").attr({id:"learn-more_"+t.Offer.OfferGuid,href:f,target:"_blank"}).text(i.Resources.LearnMore).off("click").on("click",function(n){n.stopPropagation()}));u.append(e.append(o.append(s.append(h.append(c)).append(l.append(a))).append(v)))});n(".single-signup .viewport").auxScrollbar().find("a:first").focus()},selectOfferFromCatalog:function(t){n(yr).addClass(i);this.setOffer(t);this.refreshUiOnOfferChange(!1,!0)},setOffer:function(n){this.displayedOfferWithPaymentInfo=n},getEnglishUrl:function(n){var i=this.getCountryCode(),t={};return t[_QS_OFFER]=n,t[_QS_COUNTRY_CODE]=i,t[_QS_LOCALE]="en-US",appendQueryString(this.Url.SignUp,t)},switchToEnglish:function(n){var t=this.getEnglishUrl(n);window.location=t},redirectToUrl:function(n){window.location=n},showSpinner:function(t){var r;r=t?t:br;n(r).removeClass(i)},hideSpinner:function(t){var r;r=t?t:br;n(r).addClass(i)},initializeBalloon:function(){this.setUpHelpBalloon(n(".countryCodeBalloon"),this.Resources.CountryHelp);this.setUpHelpBalloon(n(".mobileVerificationBalloon"),this.Resources.MobileVerificationHelp);this.setUpHelpBalloon(n(".PhoneNumberBalloon"),this.Resources.PhoneNumberHelp);this.setUpHelpBalloon(n(".paymentInformationBalloon"),this.Resources.PaymentInformationHelp);this.setUpHelpBalloon(n(".paymentInformationForMonetaryCreditBalloon"),this.Resources.PaymentInformationForMonetaryCreditHelp);this.setUpHelpBalloon(n(".contactEmailBalloon"),this.Resources.ContactEmailHelp);this.setUpHelpBalloon(n(".taxIdBalloon"),this.Resources.TaxIdHelp);this.setUpHelpBalloon(n(".businessRegistrationNumberBalloon"),this.Resources.BusinessRegistrationNumberHelp);this.setUpHelpBalloon(n(".prepaidTokenInformationBalloon"),this.Resources.PrepaidTokenHelp);this.setUpHelpBalloon(n(".partnerContactEmailBalloon"),this.Resources.PartnerContactEmailHelp)},setUpHelpBalloon:function(n,t){n.fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:t}})},aboutYouSectionValidation:function(){return MsPortalFx.UI.Validation.validateContainer(n(o))},partnerContactEmailValidation:function(){return this.setEnableStateOfSelectedFormElements(n(kt),!0),MsPortalFx.UI.Validation.validateContainer(n(tf))},validateCreateOrUpdateAccountRequiredFields:function(){var t=this.aboutYouSectionValidation();return t&MsPortalFx.UI.Validation.validateContainer(n(ct))},validationResultCallback:function(){var n,i=t.Signup2.Index.errorMessage;return t.Signup2.Index.errorMessage="",n=i.length>0?!1:!0,{message:i,valid:n}},setEnableStateOfAllFormElements:function(t,i){var r=this;i?r.displayedOfferWithPaymentInfo.Offer.IsPrepaidFreeTrial?(r.setEnableStateOfSelectedFormElements(t.not(n(l)),!0),r.setEnableStateOfPrepaidAmountElement(i)):r.setEnableStateOfSelectedFormElements(t,!0):r.displayedOfferWithPaymentInfo.Offer.IsPrepaid?r.setEnableStateOfSelectedFormElements(t.not(n(l)),!1):r.setEnableStateOfSelectedFormElements(t,!1)},setEnableStateOfSelectedFormElements:function(n,t){t?n.attr("disabled",!1):n.attr("disabled","disabled")},setEnableStateOfPrepaidAmountElement:function(t){var i=this,r=n(l);t?i.displayedOfferWithPaymentInfo.Offer.IsPrepaidFreeTrial?i.setEnableStateOfSelectedFormElements(r,!1):i.setEnableStateOfSelectedFormElements(r,!0):i.setEnableStateOfSelectedFormElements(r,!1)},setPurchaseButtonAndSpinnerState:function(n){var t=this;t.setPurchaseButtonState(n,!0);n?this.hideSpinner(ki):this.showSpinner(ki)},setPurchaseButtonState:function(t,i){var r;r=i?this.Resources.WaitOperationCompleted:st;t?n(lt).attr({title:gt,disabled:!1}):n(lt).attr({title:r,disabled:"disabled"})},setPIButtonState:function(n,t,i){n?(t.attr("disabled",!1),this.hideSpinner(i)):(t.attr("disabled","disabled"),this.showSpinner(i))},hideOptionalHint:function(n){n.addClass(i)},showOptionalHint:function(n){n.removeClass(i)},initSpecialFields:function(){var t=this,s=n(o),r=n(p),u=n(w),f=n(y),e=n(b),h=n(rf),c=n(au),a=n(vu),v=n(vf),k=n(bf),g=n(l),nt=n(kt);f.fxTextBox();u.fxTextBox();r.fxTextBox();e.fxTextBox();g.fxTextBox();MsPortalFx.UI.Validation.addValidationCallback(y,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(pt,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(yt,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(w,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(p,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(b,this.validationResultCallback);MsPortalFx.UI.Validation.addValidationCallback(l,this.validationResultCallback);h.on("change",function(){d().done(function(r){n("[name='"+pu+"']").fxTextBox("validate");n("[name='"+bu+"']").fxTextBox("validate");n("[name='"+wu+"']").fxTextBox("validate");n(yi).addClass(i);t.displayCnpjCpfCcmTaxFields(r,s)})});t.setOptionalHintEvents(o,r,p,c);t.setOptionalHintEvents(o,u,w,a);t.setOptionalHintEvents(o,f,y,v);t.setOptionalHintEvents(o,e,b,k)},setOptionalHintEvents:function(t,i,r,u){var f=this;i.off("click focus").on("click focus",function(){f.hideOptionalHint(u)});u.off("click").on("click",function(){i.focus()});i.off("blur").on("blur",function(){n(t).find(r).val()||f.showOptionalHint(u)})},init:function(){var f=this,c,e={},b=n(kt),l,y,p,s,w;f.showSpinner();f.hideAllSections();f.initializeBalloon();this.phoneFields.initialize(this.Model.CountryInfoJson,this.Model.CountryDropDownListItemsJson,this.Model.DropDownListDefaultItem);this.workphoneFields.initialize(this.Model.CountryInfoJson,this.Model.CountryDropDownListItemsJson,this.Model.DropDownListDefaultItem);n(kf).children().length===1&&(n(".hasMultipleCountryContainer.countryContainer").hide(),n(".hasSingleCountryContainer.countryContainer").show(ku).find(ku).text(n("#countrySelector").children("option:selected").text()));MsPortalFx.UI.Validation.setValidationContainer(n(o));MsPortalFx.UI.Validation.setValidationContainer(n(ct));MsPortalFx.UI.Validation.setValidationContainer(n(tf));n(".single-signup form").submit(function(){return!1});Signup.BotChallenge.customValidator=this.aboutYouSectionValidation;n.each(["data-val-required","data-val-length","data-val-regex","data-val-combinedlength","data-val-equalto"],function(t,i){n("["+i+"]").each(function(t,r){n(r).attr(i,MsPortalFx.Base.Utilities.htmlDecode(n(r).attr(i)))})});p=n(vr);n(p).on("smsChallengeCompleted",function(n){n.stopPropagation!==undefined&&n.stopPropagation();l=f.getCountryCode(tt);y=f.stripNonDigit(f.workphoneFields.getPhoneControl().getPhoneNumber());f.collapseSectionAndCreateOrUpdateAccount(l,y,!0)});f.setOptionalHintEvents(o,n(ft),ft,n(ir));n("#phone-no-text").keyup(this.showSaveButtonInMobileSection);n("#phone-no-text").change(this.showSaveButtonInMobileSection);n("#phone-no-text").bind("keypress",function(t){var i=n(s);i.is(":visible")&&(t.keyCode||t.which)===13&&i.trigger("click")});s=n(".single-signup .saveAndCreateAccount");n(s).on("click",function(t){if(f.validateCreateOrUpdateAccountRequiredFields()){var r,u;r=n(ou).val();u=f.stripNonDigit(f.phoneFields.getPhoneControl().getPhoneNumber());t.stopPropagation!==undefined&&t.stopPropagation();f.collapseSectionAndCreateOrUpdateAccount(r,u,!1);n(wt).removeClass(i)}});n(tt).on("change",function(){var n=f.getCountryCode(tt);f.refreshUiOnCountryChange(n)});n(vi).on("change",function(){var n=f.getCountryCode(vi);f.refreshUiOnCountryChange(n)});f.initSpecialFields();n(wr).on("change",function(){n(this).prop("checked")?f.enablePurchaseIfApplicable():f.setPurchaseButtonState(!1)});n(lt).on("click",function(){u[h]||(f.setEnableStateOfAllFormElements(n(v),!1),f.setPurchaseButtonAndSpinnerState(!1));f.proceedWithPurchase()});n(lt).on("MCValidation",function(n,t){n.stopPropagation!==undefined&&n.stopPropagation();t.offerGuid&&(ot=t.offerGuid,ci!==t.offerGuid&&(ci!==undefined&&f.updateOfferTitleAndContent(t.offerId,t.offerShortDescription,t.offerLongDescription),ci=t.offerGuid));t.commitmentAmount&&(fr=t.commitmentAmount);f.handleMCValidationNotification(t.isValid)});n(k).on("change keyup input",function(){n(bt).addClass(i);n(hi).addClass(i);n(ur).addClass(i);n(k).removeClass("fx-validation-valid");n(k).removeClass("fx-validation-invalid");n(this).val()&&n(this).val().trim().length?f.showPrepaidTokenValidateButton():f.setEnableStateOfSelectedFormElements(n(et),!1)});n(et).on("click",function(){var t=n(k);t.removeClass("fx-validation-invalid").addClass("fx-validation-deferred-pending");n(ur).addClass(i);f.setEnableStateOfSelectedFormElements(n(et),!1);f.validatePrepaidToken(t.val(),function(n){n.availableCreditsMessage?(t.removeClass("fx-validation-invalid").removeClass("fx-validation-deferred-pending").addClass("fx-validation-valid").addClass("fx-validation-deferred-valid"),f.showPrepaidTokenValidationMessage(!0,n.availableCreditsMessage),r[a]=!1,f.enablePurchaseIfApplicable()):f._showInvalidPrepaidToken(null,f.Resources.GenericError)},function(n){f._showInvalidPrepaidToken(n)})});e[_QS_OFFER]=f.Model.Offer;e[_QS_COUNTRY_CODE]=f.Model.CountryCode;e[hu]=f.Model.ShowCatalog;e[gi]=f.Model.PromoCode;e[nr]=f.Model.offerCategory;e[cu]=f.Model.DefaultContactEmail;c=appendQueryString(f.Url.GetCustomerDataUrl,e);w=d(!0,c);w.done(function(n){n&&(n.AccountId&&(dt=n.AccountId,g=n.AccountIdForPcs),f.hideSpinner(),f.refreshUiOnOfferChange())}).fail(function(){f.hideSpinner();n(vt).html(f.Resources.SignUpGenericError).removeClass(i)}).always(function(){n("#email-details").dropDownMenu({animationDurationMs:0,url:"../../Content/images/dropdown-arrow-blue.png",text:f.Widget.DropDownMenu.EmailId,textColor:"link-text-blue",dropdownColor:"dropDown-blue",dropdownPointerPosition:"pointer-top-right",pointer:"false",elementsOnDropDownMenu:[{Text:f.Widget.DropDownMenu.AuthText,Link:f.Widget.DropDownMenu.AuthUrl}]}).removeClass(i)});n(t).bind("beforeunload",function(){yu&&!lu&&n.auxAnalytics.track.purchaseIncomplete(f.displayedOfferWithPaymentInfo.Offer.OfferId)})}}}(jQuery,this),function(n,t){"use strict";var u="hide",i,l="#mc-monthly-combined-total",r="#monetary-commitment-amount",o="#duration",f="#paymentTime",a="#transactionSummaryForm",s=".mc-detail-summary .mc-notifications",e=".commitment-spinner",h="MCValidation",v=750,c=r+", "+o+", "+f;t.Signup2.MonetaryCommitment={Resources:{},Model:{},FwLinks:{},CompleteButtonSelectorStr:null,timerFunction:null,showNotification:function(t){n(s).html(t).removeClass(u)},hideNotification:function(){var t=n(s);t.addClass(u)},showSpinner:function(t,i){n(t).removeClass(u);i?n(i).prop("disabled",!0):n(c).prop("disabled",!0)},hideSpinner:function(t,i){n(t).addClass(u);i?n(i).prop("disabled",!1):n(c).prop("disabled",!1)},updateLabel:function(t,i,r,u){var f=i?r:u;n(t).text(f)},displayInvoiceChanges:function(t){var u=this,f=n(r),i=f.val(),e=isNaN(parseFloat(i))?0:parseFloat(i);n("#invoice-tax").val(t.DisplayInvoiceTax);n("#invoice-total").val(t.DisplayInvoiceTotal);n("#invoice-combined-total").val(t.DisplayCombinedTotal);u.updateDiscount(e)},updateDiscount:function(t){for(var f,e,o,s,r=i,u=0;r.discounts!==undefined&&u<r.discounts.length;u++)t>=r.discounts[u].minValue&&(e===undefined||e<r.discounts[u].minValue)&&(e=r.discounts[u].minValue,f=r.discounts[u]);o=f?f.discount:0;s=this.Model.PercentageFormat.replace("{0}",o);n("#mcDiscount").text(s)},getMinAmount:function(t){var i=null;return n.each(t.discounts,function(n,t){(i===null||t.minValue<i)&&(i=t.minValue)}),i},setupTransactionSummaryForm:function(){n(a).submit(function(n){return n.preventDefault(),!1})},updateDiscountAndOffer:function(){for(var nt,w,y=n(f).val()==="true",b=parseInt(n(o).val(),10),c=this.Model.MonetaryCommitmentMap,s=n(r),p=s.val(),a=isNaN(parseFloat(p))?0:parseFloat(p),v=this,k=s.closest("form"),u,e,d=this.Resources.CommitmentAmountRange,g=s.attr("data-val-range-max"),h=0;h<c.length;++h)if(c[h].months===b&&c[h].isPayNow===y){u=c[h];break}u?(i=u,n("input:hidden[name=offerGuid]").each(function(t,i){n(i).val(u.offerGuid)}),n("#view-charges-rate").attr("href",u.ratePlanUrl),e=this.getMinAmount(u),n.removeData(s[0],"fxValidatorData"),a<e&&(s.val(e),n("input:hidden[name=commitmentAmount]").each(function(t,i){n(i).val(e)}),a=e),s.attr({"data-val-range-min":e,"data-val-range":d.replace("{0}",e).replace("{1}",g)}),nt=MsPortalFx.UI.Validation.validateContainer(k),v.updateDiscount(a),n("#offerDescription").text(u.description),n(l).hide(),w=y?v.Resources.PayNowWarning:v.Resources.PayMonthlyWarning,this.showNotification(w),this.updateLabel("#mcAmount",u.isPayNow,this.Resources.CommitmentAmountPaidNow,this.Resources.MonthlyAmount),this.updateLabel("#mcTax",u.isPayNow,this.Resources.TaxPaidNow,this.Resources.TaxMonthly),this.updateLabel("#mcTotal",u.isPayNow,this.Resources.TotalPaidNow,this.Resources.TotalMonthly)):t.location.href="/Error/ServerError"},triggerMcValidation:function(t,i,r,u,f,e){var o=this;t?n(o.CompleteButtonSelectorStr).trigger(h,{isValid:t,offerGuid:i,offerId:r,offerShortDescription:u,offerLongDescription:f,commitmentAmount:e}):n(o.CompleteButtonSelectorStr).trigger(h,t)},estimateMonetaryCommitmentChanges:function(){var i=this,t=n("#monetaryCommitmentForm");return auxAjax({url:t.attr("action"),type:"POST",data:t.serialize()})},estimateMonetaryCommitmentChangesResult:function(){var t=this,u=n(r).val();t.showSpinner(e);n.when(t.estimateMonetaryCommitmentChanges.call(t)).then(function(n){t.displayInvoiceChanges.call(t,n)}).then(function(){t.triggerMcValidation(!0,i.offerGuid,i.offerId,i.description,i.longDescription,u);t.hideSpinner(e)}).fail(function(){t.triggerMcValidation(!1);t.hideSpinner(e)})},init:function(){var t=this,u=n(r),e;u.on("keyup",function(i){var e=u.closest("form"),o=u.val(),f,r;t.timerFunction!=null&&window.clearTimeout(t.timerFunction);t.triggerMcValidation(!1);n("input:hidden[name=commitmentAmount]").each(function(t,i){n(i).val(o)});r=function(){f=MsPortalFx.UI.Validation.validateContainer(e);f&&t.estimateMonetaryCommitmentChangesResult()};i.keyCode===undefined?r():t.timerFunction=window.setTimeout(r,v)});n(f).change(function(){t.triggerMcValidation(!1);t.updateDiscountAndOffer();t.estimateMonetaryCommitmentChangesResult()});n.each(["data-val-required","data-val-length","data-val-regex","data-val-combinedlength","data-val-equalto"],function(t,i){n("["+i+"]").each(function(t,r){n(r).attr(i,MsPortalFx.Base.Utilities.htmlDecode(n(r).attr(i)))})});this.Model.WarnDiscountsEndingSoon?(e=n("<a/>").attr({href:this.FwLinks.RateChargesFwLink}).text(this.Resources.DiscountsEndingSoon),this.showNotification(e)):this.hideNotification();t.updateDiscountAndOffer();this.setupTransactionSummaryForm();t.triggerMcValidation(!u.hasClass("fx-validation-invalid"),i.offerGuid,i.offerId,i.description,i.longDescription,n(r).val())}}}(jQuery,this);OUTSIDE_SCREEN_PIXELS="-10000px";Signup2.SubscriptionPurchaseTracker={Model:{},Resources:{},FwLinks:{},CommissionJunctionIframeSelector:"#cj_conversion",spinnerSelectorStr:".single-signup .signup-spinner",TrackingUrl:"",AsynchronousPaymentUrl:"",OfferId:"",checkForProgress:!0,stopChecking:function(){this.checkForProgress=!1},redirect:function(){this.AsynchronousPaymentUrl?document.location.href=this.AsynchronousPaymentUrl:document.location=this.Model.ReturnUrl},keepChecking:function(){var n=this;return this.checkForProgress?(setTimeout(function(){n.runCheck()},2e3),!0):!1},createCommisionJunctionIframe:function(n,t){var i=this;$('<iframe height="1" width="1" frameborder="0" scrolling="no" name="cj_conversion" />').css("margin-left",OUTSIDE_SCREEN_PIXELS).css("margin-top",OUTSIDE_SCREEN_PIXELS).appendTo("body").attr("src",n).load(function(){clearTimeout(t);i.redirect()})},runCheck:function(){var n=this;auxPost(this.TrackingUrl,function(t){if(!t){n.keepChecking()||n.redirect();return}switch(t.PurchaseStatus){case n.PurchaseStatus.Success:case n.PurchaseStatus.CannotConfirmFeatureActivation:if($.auxAnalytics.track.purchaseComplete(t.SubscriptionHashedGuid,n.OfferId),t.CommissionJunctionUrl){var i=setTimeout(function(){n.redirect()},5e3);n.createCommisionJunctionIframe(t.CommissionJunctionUrl,i)}else n.redirect();break;case n.PurchaseStatus.PurchaseFailed:n.showErrorMessage(n.Resources.SubscriptionPurchaseFailed,n.FwLinks.SupportLink);break;case n.PurchaseStatus.ProvisionFailed:n.showErrorMessage(n.Resources.SubscriptionProvisioningFailed,n.FwLinks.SupportLink);break;case n.PurchaseStatus.FeatureActivationFailed:n.showErrorMessage(n.Resources.FeatureActivationFailed,n.FwLinks.SupportLink);break;case n.PurchaseStatus.Purchased:case n.PurchaseStatus.Started:case n.PurchaseStatus.Provisioning:case n.PurchaseStatus.Purchasing:case n.PurchaseStatus.StillRunning:n.AsynchronousPaymentUrl&&(document.location.href=n.AsynchronousPaymentUrl);n.keepChecking()||n.showErrorMessage(n.Resources.SubscriptionProvisioningFailed,n.FwLinks.SupportLink);break;case n.PurchaseStatus.WaitingForFeatureActivation:n.keepChecking()||n.showErrorMessage(n.Resources.FeatureActivationFailed,n.FwLinks.SupportLink);break;case n.PurchaseStatus.None:n.showErrorMessage(n.Resources.SubscriptionProvisioningFailed,n.FwLinks.SupportLink)}})},startTracking:function(n,t,i){var r=this;this.TrackingUrl=n;this.AsynchronousPaymentUrl=t;this.OfferId=i;setTimeout(function(){r.stopChecking();r.redirect()},18e4);this.runCheck()},showErrorMessage:function(n,t){var i=$("<a/>",{href:t}).text(n);Signup2.Index.hidePageAndShowError(i)}},function(n,t){"use strict";var r=".payment-status-content",u=".single-signup .error",i="hide";t.Signup2.PaymentStatus={Model:{},Enums:{},Resources:{},init:function(){var t=this;n(function(){var i;n("#email-details").dropDownMenu({animationDurationMs:0,url:"../../Content/images/dropdown-arrow-blue.png",text:t.Model.Email,textColor:"link-text-blue",dropdownColor:"dropDown-blue",dropdownPointerPosition:"pointer-top-right",pointer:"false",elementsOnDropDownMenu:[{Text:t.Model.AuthText,Link:t.Model.AuthUrl}]});t.Model.Success?i=setInterval(function(){auxPost(t.Model.PaymentStatusUrl,function(n){typeof n=="string"&&n.match("/Error/500")?t.hidePageAndShowError(t.Resources.GenericError):n.status===t.Enums.PrepaidBalanceReloadStatus.Succeeded?(clearInterval(i),document.location.href=t.Model.RedirectUrl):n.status===t.Enums.PrepaidBalanceReloadStatus.Failed&&(clearInterval(i),t.hidePageAndShowRetryError())},function(){clearInterval(i);t.hidePageAndShowError(t.Resources.GenericError)},{prepaidBalanceId:t.Model.PrepaidBalanceId,prepaidBalanceReloadId:t.Model.PrepaidBalanceReloadId})},5e3):t.hidePageAndShowRetryError()})},hidePageAndShowError:function(t){n(r).addClass(i);n(u).html(t).removeClass(i)},hidePageAndShowRetryError:function(){var n=Signup2.PaymentStatus;auxPost(n.Model.RetryUrl,function(t){t.redirectionUrl?n.hidePageAndShowError(n.Resources.RetryError.replace("{0}",t.redirectionUrl)):n.hidePageAndShowError(n.Resources.GenericError)},function(){n.hidePageAndShowError(n.Resources.GenericError)},{piId:n.Model.PiId,offerId:n.Model.OfferId,subscriptionId:n.Model.SubscriptionId,prepaidBalanceReloadId:n.Model.PrepaidBalanceReloadId,amount:n.Model.Amount})}}}(jQuery,this);Profile.Index={WizardURL:"",editLinkSelector:"",initWizard:function(){var n=[{URL:this.WizardURL,State:"incomplete"}];$(this.editLinkSelector).wizard({steps:n,readyToProceed:0,refreshOnFinish:0});$(this.editLinkSelector).click(function(){dcsSetVar("WT.z_iLinks","edit details","WT.z_iLinks_actionoffer","edit-profile","WT.z_iLinks_targetcampaign","src-acctprof")})}},function(n){"use strict";var i="hide",t="#tax-information",r=".vatId",u=".cnpj",f=".taxId",e=".businessRegistrationNumber",o="#wizard-button-complete",s={};Profile.EditTaxRecord={Resources:{},Model:{},Url:{},initializeBalloon:function(t,i){n(t).fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:i}})},setEnableStateOfSelectedElements:function(n,t){t?n.attr("disabled",!1):n.attr("disabled","disabled")},showWizardOnCommitError:function(i){var r=this.Resources.GenericError;i==400&&(r=this.Resources.InvalidTaxId);n.wizard().hideProgress();n.wizard().enableComplete();n.wizard().showErrorInNotificationBar(r,null);n(t).fadeIn("fast")},removeEventHandlers:function(){n(o).off("click")},updateTaxInformation:function(){for(var a=this,c=n(t),i=this.Model.SpecialFieldsJson,o,v,y,p=!1,w=[],l,h=0;i!=null&&h<i.length;h++){y=!0;switch(i[h]){case this.AccountFieldsType.VatId:o=c.find(r);break;case this.AccountFieldsType.TaxId:o=c.find(f);break;case this.AccountFieldsType.CnpjCpfCcm:o=c.find(u);break;case this.AccountFieldsType.BusinessRegistrationNumber:o=c.find(e);break;default:y=!1}y==!0&&(v=o.find("input").val(),v!=s[i[h]]&&(p=!0,l={},l.TaxIdDisplayType=i[h],l.Id=v,w.push(l)))}p===!0?auxAjax({url:this.Url.UpdateTaxIdUrl,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({taxRecords:w}),error:function(n,t){a.showWizardOnCommitError(t)},success:function(t){t&&t.success?(a.removeEventHandlers(),n.wizard().close()):a.showWizardOnCommitError(null)}}):(this.removeEventHandlers(),n.wizard().close())},initializeEventHandlers:function(){var i=this;n(o).on("click",function(){n.wizard().hideNotificationBar();n.wizard().showProgress();n.wizard().disableComplete();n(t).fadeOut("fast");i.updateTaxInformation()})},intializeTaxFields:function(){var c=n(t),l=this.Model.SpecialFieldsJson,y=this.Model.SpecialFieldsToEditAllowedDictJson,o,a,v,h;for(c.find(".section special-fields").addClass(i),h=0;l!=null&&h<l.length;h++){v=!0;switch(l[h]){case this.AccountFieldsType.VatId:o=c.find(r);break;case this.AccountFieldsType.TaxId:o=c.find(f);break;case this.AccountFieldsType.CnpjCpfCcm:o=c.find(u);break;case this.AccountFieldsType.BusinessRegistrationNumber:o=c.find(e);break;default:v=!1}v===!0&&(a=o.find("input"),y[l[h]]===!1&&a.attr("disabled","disabled"),o.removeClass(i),s[l[h]]=a.val())}},init:function(){n.isInWizard(t)&&(n.wizard().enableComplete(),n.wizard().waitToAdvance(),this.intializeTaxFields(),this.initializeEventHandlers())}}}(jQuery,this);Subscriptions.Statement={GetChartDataURL:"",ErrorMessage:"",CreditUsageChartData:null,CurrencyFormatter:"",PeriodStartTimestamp:0,PeriodEndTimestamp:0,ShowUpgrade:"",showTooltip:function(n,t){$('<div id="tooltip" class = "usage-chart-tooltip"><\/div>').css({top:n.pageY-43,left:n.pageX}).append(t).append('<span class="arrow"><\/span>').appendTo("body").fadeIn(200);$("#tooltip").mouseover(function(){$(this).stop().animate({opacity:"100"});clearTimeout(this.timeout)});$("#tooltip").mouseenter(function(){clearTimeout(this.timeout)});$("#tooltip").mouseleave(function(){var n=function(){$("#tooltip").fadeOut(3e3)};this.timeout=setTimeout(n,4e3)})},setupChartButton:function(){var n=this,t={},i=["#7C4B75","#D29A3C","#5A75CF","#B194AD","#5DA7EE","#43A39E"];$(".show-chart").click(function(){var h=[],b=$(this),f=$(this).parents(".display-usage-meters"),e=f.data("meter-id"),y=f.data("is-credit")==="true",p=f.parents(".usage-chart-parent"),r=p.children(".usage-chart"),u=r.children(".usage-chart-graph"),o=r.children(".usage-chart-spinner-container"),c={series:{lines:{show:!0},points:{show:!0}},grid:{hoverable:!0,clickable:!1,borderColor:"#808080",borderWidth:0,aboveData:!0},yaxis:{show:!1},xaxis:{mode:"time",timeformat:"%m/%d",ticks:11},legend:{position:"ne",container:r.children(".usage-chart-legend")}},s,l,a,v;if(r.width(f.width()),r.is(":visible"))r.hide();else if(r.slideDown("slow"),s=null,u.bind("plothover",function(t,i,r){if(r){if(s!=r.dataIndex){s=r.dataIndex;$("#tooltip").remove();var f=new Date(parseInt(r.datapoint[0])),e=Math.abs(r.datapoint[1]).toFixed(2),u=Math.abs(r.datapoint[1]).toFixed(2);n.showTooltip(r,u)}}else $("#tooltip").fadeOut(3500),s=null}),t[e])v=t[e],o.hide(),n.plotGraph(u,v,c);else{o.show();function w(r){var f,s;if(o.hide(),r&&r.length!==0){for(f=0;f<r.length;f++)s={label:r[f].Label,data:r[f].Data,color:i[f]},h.push(s);t[e]=h;n.plotGraph(u,h,c)}else u.text(n.ErrorMessage)}l={subscriptionId:n.subscriptionGuid,uniqueResourceIdentifier:e,isCredit:y};a=appendQueryString(n.GetChartDataURL,l);auxAjax({url:a,type:"POST",dataType:"json",success:w,error:function(){u.text(n.ErrorMessage);o.hide()}})}})},drawMonetaryCreditGraph:function(){var i=$(".show-credit-chart").parents(".display-credit-meters"),r=i.parents(".usage-chart-parent"),n=r.find(".usage-chart"),u=n.children(".usage-chart-spinner-container"),f=$(".credit-usage-meter"),e=n.children(".usage-chart-graph"),o=this,t;n.is(":visible")?n.hide():(options={series:{lines:{show:!0},points:{show:!0,radius:1}},grid:{hoverable:!1,clickable:!1,borderColor:"#808080",borderWidth:0,aboveData:!0},yaxis:{min:0,tickFormatter:function(n){return o.CurrencyFormatter.replace("{0}",n.toString(10))}},xaxis:{mode:"time",timeformat:"%m/%d",min:this.PeriodStartTimestamp,max:this.PeriodEndTimestamp},legend:{position:"ne",container:n.children(".usage-chart-legend")}},t=[{label:this.CreditUsageChartData[0].Label,data:this.CreditUsageChartData[0].Data,color:"#000000"}],this.CreditUsageChartData.length>1&&t.push({label:this.CreditUsageChartData[1].Label,data:this.CreditUsageChartData[1].Data,color:"rgba(128,128,128,0.5)"}),n.width(f.width()),n.slideDown("slow"),u.hide(),this.plotGraph(e,t,options))},plotGraph:function(n,t,i){n.show();$.plot(n,t,i)},init:function(n){var t=this,i=$(".upgrade-now a");this.subscriptionGuid=n;this.setupChartButton();$("#edit-subscription-details").click(function(){dcsSetVar("WT.z_iLinks","Edit Subscription Details","WT.z_iLinks_actionoffer","Edit-SubDetails","WT.z_iLinks_targetcampaign","src-acctsubsum")});$(".subscription-changeShipToAddress").click(function(){dcsSetVar("WT.z_iLinks","Edit Subscription Details","WT.z_iLinks_actionoffer","Edit-SubDetails","WT.z_iLinks_targetcampaign","src-acctsubsum")});$(".subscription-partnerInformation").click(function(){dcsSetVar("WT.z_iLinks","Partner Information","WT.z_iLinks_actionoffer","Edit-SubDetails","WT.z_iLinks_targetcampaign","src-acctsubsum")});$(".subscription-cancel").click(function(){dcsSetVar("WT.z_iLinks","Cancel Subscription","WT.z_iLinks_actionoffer","Cancel-Subscription","WT.z_iLinks_targetcampaign","src-acctsubsum")});$(".subscription-changePaymentMethod").click(function(){dcsSetVar("WT.z_iLinks","Change Payment Method","WT.z_iLinks_actionoffer","Edit-Payment","WT.z_iLinks_targetcampaign","src-acctsubsum")});Subscriptions.Index.setupWizard();$(".show-credit-chart").click(function(){t.drawMonetaryCreditGraph()});i.length!=0&&t.ShowUpgrade==="true"&&i.triggerHandler("click")}};Subscriptions.Renew={GenericError:"",showWizardHideProgress:function(){$.wizard().hideProgress();$.wizard().enableComplete();$("#renew-subscription").fadeIn("fast")},onWizardComplete:function(){$.wizard().showProgress();$.wizard().disableComplete();$("#renew-subscription").fadeOut("fast");$("#renew-subscription form").submit()},init:function(){var n=this;$.isInWizard("#renew-subscription")&&($.wizard().enableComplete(),$.wizard().waitToAdvance(),$("#renew-subscription form").submit(function(t){t.preventDefault();var i=$(this);auxAjax({url:i.attr("action"),type:"POST",data:i.serialize(),success:function(t){if(t.success==!0){var i=$.wizard();$.wizard().waitToAdvance(0);t.returnUrl&&(document.location=t.returnUrl);i.complete()}else n.showWizardHideProgress(),$.wizard().showErrorInNotificationBar(n.GenericError,null)}})}),$("#wizard-button-complete").unbind("click",n.onWizardComplete).bind("click",n.onWizardComplete))}},function(n,t){"use strict";var u="#add-payment-method",f="#change-payment-method",e="#paymentInstrumentBrief",o="#removeSpendingLimit",r="#remove-spending-limit-options",v="#the-pcs-container",s=".add-payment-method",h=".change-payment-method",y=".no-remove-spending-limit input",p=".yes-remove-spending-limit input",c=".payment-spending-limit-options",l=".remove-spending-limit-waiting-message",a=".yes-content",i="hide",w=350,b=250;t.Subscriptions.RemoveSpendingLimit={GenericError:"",spinner:null,Model:{},Resources:{},init:function(){var t=this;t.Model.PaymentInstrumentId?(n(h).removeClass(i),t.showPaymentBriefFormat(t.Model.UsedPaymentInstrumentBrief)):t.Model.AddPaymentInstrumentUrl&&n(s).removeClass(i);n(p).on("click",function(){n(a).removeClass(i);n(c).removeClass(i);t.Model.PaymentInstrumentId||n.wizard&&n.wizard().disableComplete()});n(y).on("click",function(){n(a).addClass(i);n(c).addClass(i);t.Model.PaymentInstrumentId||n.wizard&&n.wizard().enableComplete()});n(u).on("click",function(n){t.addPaymentMethod(n)});n(f).on("click",function(n){t.changePaymentMethod(n)});if(n.isInWizard(r)){n.wizard().enableComplete();n.wizard().waitToAdvance();n(o).on("submit",function(i){i.preventDefault();var r=n(this);auxAjax({url:r.attr("action"),type:"POST",data:r.serialize(),success:function(i){if(i.success==!0){var r=n.wizard();n.wizard().waitToAdvance(0);i.returnUrl&&(document.location=i.returnUrl);r.complete()}else t.showWizardHideProgress(),n.wizard().showErrorInNotificationBar(t.GenericError,null)}})});if(t.Model.HasEmptyPIdAndNoValidPi)n("#wizard-button-complete").off("click",t.onWizardComplete).off("click",t.onWizardNoActionAndClose).on("click",t.onWizardNoActionAndClose);else n("#wizard-button-complete").off("click",t.onWizardNoActionAndClose).off("click",t.onWizardComplete).on("click",t.onWizardComplete)}},addPaymentMethod:function(){var n=this,t=n.Model.AddPaymentInstrumentUrl;return n.launchPcsFrame(t),!1},changePaymentMethod:function(){var n=this,t=n.Model.ChangePaymentInstrumentUrl;return n.launchPcsFrame(t),!1},showWizardHideProgress:function(){n.wizard&&(n.wizard().hideProgress(),n.wizard().enableComplete());n(r).removeClass(i)},onWizardComplete:function(){n.wizard&&(n.wizard().showProgress(),n.wizard().disableComplete());n(u).off("click");n(f).off("click");n(r).addClass(i);n(o).submit()},onWizardNoActionAndClose:function(){n.wizard&&n.wizard().close()},launchPcsFrame:function(t){var i=this;i.spinner=n.wizard().spinner();loadIframe(t,!0)},_exchangeDataSync:function(t){var i=this,r;i.spinner!=null&&i.spinner.resolve();i.fadeInWizardInsteadOfPcs();t!=null&&(t.status=="Success"?(r=t.result.paymentInstrumentId,i.setNewPayment(r)):n.wizard&&n.wizard().showErrorInNotificationBar(i.Resources.BillingFrameTransactionError,null))},fadeInWizardInsteadOfPcs:function(){var t=this;return n.when(n("#dialog").fadeIn(b)).then(n(v).fadeOut(w))},setNewPayment:function(t){var u=this,e=u.Model.PaymentInstrumentId,o=u.Model.SubscriptionId,f;e!=t&&(n(r).addClass(i),n(l).removeClass(i),n.wizard&&(n.wizard().showProgress(),n.wizard().disableComplete()),n("input[name=subscriptionId]").val(o),n("input[name=newPaymentInstrumentId]").val(t),f=n("#setPaymentForm"),auxAjax({url:f.attr("action"),type:"POST",data:f.serialize(),success:function(r){u.enableWizard();typeof r=="string"&&r.match("/Error/500")?n.wizard&&n.wizard().showErrorInNotificationBar(u.Resources.BillingFrameTransactionError,null):(u.Model.PaymentInstrumentId=t,u.Model.ChangePaymentInstrumentUrl=r.changePaymentInstrumentUrl,u.showPaymentBriefFormat(r.usedPaymentInstrumentBrief),n("input[name=paymentInstrumentId]").val(t),n(h).removeClass(i),n(s).addClass(i))},error:function(){u.enableWizard();n.wizard&&n.wizard().showErrorInNotificationBar(u.Resources.BillingFrameTransactionError,null)}}))},enableWizard:function(){n.wizard&&n.wizard().hideProgress();n(l).addClass(i);n(r).removeClass(i);n.wizard&&n.wizard().enableComplete()},showPaymentBriefFormat:function(t){var u,f,r;t.PaymentInstrumentId!=null&&(n(e).children().empty(),r=(t.Brand!=""?t.Brand+" - ":"")+t.FriendlyName,u=n("<div class='pi-entry-name' />"),t.IconFile!=null&&(f=n("<img />").attr("src","/Content/aux-pre/Images/"+t.IconFile).attr("alt",r),u.append(f)),r=n("<span />").text(r),u.append(r),n(e).append(u).removeClass(i))}}}(jQuery,this);Subscriptions.Index={IsNewSignup:"true",SignupUrl:null,init:function(){this.setupWizard();$(".add-new-subscription").click(function(){$.auxAnalytics.track.addSubscription()});$(".subscription-note").click(function(){dcsSetVar("WT.z_iLinks","view statement","WT.z_iLinks_actionoffer","view-substatement","WT.z_iLinks_targetcampaign","src-actsub")});$(".add-support-options").click(function(){$.auxAnalytics.track.selectSupportOptions()})},setupWizard:function(){for(var i,t,r=$("a.invoke-wizard"),n=0;n<r.length;n++)t=[{URL:r[n].href,State:"incomplete"}],$(r[n]).wizard({steps:t,readyToProceed:0,refreshOnFinish:0});for(i=$("a.invoke-custom-wizard"),n=0;n<i.length;n++)t=[{URL:i[n].href,State:"incomplete",Features:"close"}],$(i[n]).wizard({steps:t,readyToProceed:0,refreshOnFinish:0})}},function(n,t){"use strict";var i="hide";t.Subscriptions.EditDetails={EditSubscriptionDetailsStatus:{},Resources:{},Model:{},DivSelector:"#edit-subscription",FormSelector:"#editDetailsForm",FriendlyNameSelector:"#FriendlyName",ServiceAdminEmailSelector:"#ServiceAdminEmail",WizardButtonCompleteSelector:"#wizard-button-complete",WizardButtonCloseSelector:"#wizard-button-close",FriendlyNameFieldFormSelector:"input[name='FriendlyName']",ServiceAdminEmailFieldFormSelector:"input[name='EditSubscriptionServiceAdminModel.ServiceAdminEmail']",OriginalFriendlyNameFieldFormSelector:"input[name='OriginalFriendlyName']",OriginalServiceAdminEmailSelector:"input[name='OriginalServiceAdminEmail']",OrgIdChoiceFieldsSelector:".orgId-choice-fields",showWizardHideProgress:function(){n.wizard().hideProgress();n.wizard().enableComplete();n(this.DivSelector).fadeIn("fast")},getTextBoxValueChanged:function(t,i){var r=this,f=n.Deferred(),u=n(t);return u.unbind().die(),u.keyup(function(u){r.timerFunction!=null&&window.clearTimeout(r.timerFunction);var f=u.keyCode!=9?t:null;return r.timerFunction=window.setTimeout(function(){n(r.FormSelector).valid()?n.wizard().enableComplete():n.wizard().disableComplete()},i),!0}),f},setupValidateOnTextChange:function(){this.getTextBoxValueChanged(this.FriendlyNameSelector,200);this.getTextBoxValueChanged(this.ServiceAdminEmailSelector,200)},init:function(){var t=this,r,u;this.setupValidateOnTextChange();n.isInWizard(this.DivSelector)&&(n.wizard().enableComplete(),n.wizard().waitToAdvance(),n(this.FormSelector).bind("submit.ed",function(r){r.preventDefault();var u=n(this),f=n(t.WizardButtonCompleteSelector),e=n(t.WizardButtonCloseSelector);u.find(t.OriginalFriendlyNameFieldFormSelector).val().trim()===u.find(t.FriendlyNameFieldFormSelector).val().trim()&&(u.find(t.ServiceAdminEmailFieldFormSelector).val()===undefined||u.find(t.ServiceAdminEmailFieldFormSelector).val()!=undefined&&u.find(t.OriginalServiceAdminEmailSelector).val()!=undefined&&u.find(t.OriginalServiceAdminEmailSelector).val().trim()===u.find(t.ServiceAdminEmailFieldFormSelector).val().trim()&&n(t.OrgIdChoiceFieldsSelector).hasClass(i))?(u.unbind("submit.ed"),f.unbind("click.ed"),e.unbind("click.ed"),n.wizard().close()):auxAjax({url:u.attr("action"),type:"POST",data:u.serialize(),success:function(r){switch(r){case t.EditSubscriptionDetailsStatus.InvalidData:n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null);t.showWizardHideProgress();break;case t.EditSubscriptionDetailsStatus.EmailNotLiveId:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.InvalidServiceAdminMicrosoftAccount,null);break;case t.EditSubscriptionDetailsStatus.EmailNotValidLiveOrOrgId:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.InvalidServiceAdminAccount,null);break;case t.EditSubscriptionDetailsStatus.EmailNotValidOrgIdWhenOrgIdOnly:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.InvalidServiceAdminAccountOrgIdOnly,null);break;case t.EditSubscriptionDetailsStatus.EmailBothLiveAndOrgId:t.showWizardHideProgress();n(t.OrgIdChoiceFieldsSelector).removeClass(i);break;case t.EditSubscriptionDetailsStatus.ErrorFriendlyName:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.NameInvalidFormat,null);break;case t.EditSubscriptionDetailsStatus.UnknownError:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null);case t.EditSubscriptionDetailsStatus.ErrorRenewalState:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null);break;case t.EditSubscriptionDetailsStatus.SubscriptionNotFound:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.InvalidSubscription,null);case t.EditSubscriptionDetailsStatus.ErrorProvisioning:t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null);break;default:u.unbind("submit.ed");f.unbind("click.ed");e.unbind("click.ed");document.location=t.Model.ReturnUrl}}})}),r=n(this.WizardButtonCompleteSelector),u=n(this.WizardButtonCloseSelector),r.unbind("click"),r.bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-accteditsub");n.wizard().showProgress();n.wizard().disableComplete();n(t.DivSelector).fadeOut("fast");n(t.FormSelector).submit()}),u.unbind("click.ed"),u.bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-accteditsub");n(this).unbind("click.ed")}))}}}(jQuery,this);Subscriptions.ChangeUnits={_STATUS_BAR:"#status-bar",_FORM:"#setPaymentForm",_NEW_INSTANCE_COUNT:"#instance-count-new",_INVOICE_TAX:"#invoice-tax",_INVOICE_TOTAL:"#invoice-total",maxUnits:999,calcInvoiceTimerId:null,Model:{},Resources:{},FwLinks:{},setupKeyboardSupport:function(){var n=this;$(n._NEW_INSTANCE_COUNT).keyup(function(t){var i=t.keyCode!=9?n._NEW_INSTANCE_COUNT:null;return n.calcInvoiceTimerId!=null&&window.clearTimeout(n.calcInvoiceTimerId),n.calcInvoiceTimerId=window.setTimeout(function(){n.doCalcEstimatedInvoice(i)},500),!0})},setupWizardFeatures:function(){var n=this;$(n._NEW_INSTANCE_COUNT).focus().select();$("#wizard-button-complete").unbind("click");$("#wizard-button-complete").unbind("click.cu");$("#wizard-button-complete").bind("click.cu",function(){n.setNewUnitsCount()});$("#wizard-button-close").unbind("click.cu");$("#wizard-button-close").bind("click.cu",function(){n.close()})},init:function(){this.setupKeyboardSupport();this.setupWizardFeatures()},enableWizard:function(){$.wizard().hideProgress();$(".wizard-progress").remove();$.wizard().enableComplete()},close:function(){var n=$.wizard();n!=null&&(n.readyToProceed=1,n.complete());$("#wizard-button-complete").unbind("click.cu");$("#wizard-button-close").unbind("click.cu")},calcEstimatedInvoice:function(){var n=$("#estimateInvoiceForm");return auxAjax({url:n.attr("action"),type:"POST",data:n.serialize()})},displayInvoiceChanges:function(n){$(this._INVOICE_TAX).text(n.DisplayInvoiceTax);$(this._INVOICE_TOTAL).text(n.DisplayInvoiceTotal)},disableSubmitButton:function(){$.wizard().disableComplete()},enableSubmitButton:function(){$.wizard().enableComplete()},validateInput:function(n){var t=-1,i;try{t=parseInt(n.val())}catch(r){t=-1}return i=t>=this.Model.CurrentInstanceCount&&t<=this.maxUnits,i?(n.removeClass("instance-count-inline-error"),this.enableSubmitButton()):(n.addClass("instance-count-inline-error"),this.disableSubmitButton()),{valid:i,fieldValue:t}},doCalcEstimatedInvoice:function(n){var t=this,u,f,i;$.wizard().hideNotificationBar();var e=$("#changeServiceUnitsForm").validate(),r=$(t._NEW_INSTANCE_COUNT),o=t.validateInput(r);o.valid!=!1&&(u=e.form(),u?(f=r.val(),$("#instanceCount").val(f),i=$.wizard().spinner("#wizard-button-complete, "+t._NEW_INSTANCE_COUNT),$.when(t.calcEstimatedInvoice()).then(function(n){t.displayInvoiceChanges(n)}).then(function(n){i.resolve(n)}).then(function(){t.enableSubmitButton();n!=null&&$(n).focus()}).fail(function(){i.resolve();n!=null&&$(n).focus();$.wizard()&&$.wizard().showErrorInNotificationBar(t.Resources.BillingFrameTransactionError,t.FwLinks.SupportLink)})):t.disableSubmitButton())},setNewUnitsCount:function(){var n=this,i=$(n._NEW_INSTANCE_COUNT).val(),t;i!=n.Model.CurrentInstancesCount?($("#change-unit-dialog").hide(),$.wizard()!=null&&($.wizard().disableComplete(),$.wizard().showProgress(),$.wizard().hideNotificationBar()),$("input[name=subscriptionId]").val(n.Model.SubscriptionId),$("input[name=newInstanceCount]").val(i),t=$(n._FORM),auxAjax({url:t.attr("action"),type:"POST",data:t.serialize(),success:function(t){t.contactSupport?($.wizard().showErrorInNotificationBar(n.Resources.CreditCheckRequired,n.FwLinks.SupportLink),n.enableWizard()):(n.close(),t.returnUrl&&(document.location=t.returnUrl))},error:function(){$("#change-unit-dialog").show();$.wizard()&&($.wizard().showErrorInNotificationBar(n.Resources.BillingFrameTransactionError,n.FwLinks.SupportLink),n.enableWizard())}})):n.close()}};Subscriptions.ChangePaymentMethod={_THE_PCS_CONTAINER:"#the-pcs-container",_THE_PCS:"#the-pcs",_DROPDOWN:"#paymentInstrumentDropDown",_EDIT_PI:"#editpiLink",_NEW_INVOICE:"#new-invoice",_ADD_PAYMENT_METHOD:"#add-payment-method",_WARNING:"div.warning-message.warning-message-change-payment",_WARNING_INVOICE:"div.warning-message.warning-message-invoice",_PCS_INLINE:!1,_FADE_OUT_INTERVAL:350,_FADE_IN_INTERVAL:250,spinner:null,Model:{},Resources:{},FwLinks:{},init:function(){var n=this;$(this._WARNING).hide();$(this._WARNING_INVOICE).hide();$("#wizard-button-complete").unbind("click");$("#wizard-button-complete").unbind("click.cpm");$("#wizard-button-complete").bind("click.cpm",function(t){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-acctchangepay");n.setNewPaymentInstrumentForSubscription(t)});$("#wizard-button-close").unbind("click.cpm");$("#wizard-button-close").bind("click.cpm",function(t){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-acctchangepay");n.close(t)});$("#editpiLink").click(function(){dcsSetVar("WT.z_iLinks","Edit Button","WT.z_iLinks_actionoffer","Edit-PayMethod","WT.z_iLinks_targetcampaign","src-acctchangepay")});$(n._ADD_PAYMENT_METHOD).bind("click",function(t){n.addPaymentMethod(t)});$(n._NEW_INVOICE).bind("click",function(t){n.addInvoice(t)});$(n._EDIT_PI).bind("click",function(t){n.editCurrentPaymentInstrument(t)});$(n._DROPDOWN).paymentInstrumentsDropDown({visibleRowsCount:-1,onCreateEntry:function(n){if(n!=undefined){var t=(n.PaymentInstrument.Brand!=""?n.PaymentInstrument.Brand+" - ":"")+n.PaymentInstrument.FriendlyName,i=$("<div class='pi-entry-name' />"),r=$("<img />").attr("src","/Content/aux-pre/Images/"+n.PaymentInstrument.IconFile).attr("alt",t),t=$("<span />").text(t);return i.append(r),i.append(t),i}}});$(n._DROPDOWN).paymentInstrumentsDropDown("open").paymentInstrumentsDropDown("focus");n.updatePaymentInstrumentsDropDown();$(n._DROPDOWN).bind("selectionChanged",function(t,i){if(i.newItem!=null){var r=i.newItem.PaymentInstrument.PaymentInstrumentId,u=n.Model.CurrentlyUsedPaymentInstrument.PaymentInstrument.PaymentInstrumentId;r!==u?(n.Model.IsOms===!1&&$(n._WARNING).show(),i.newItem.PaymentInstrument.IsInvoice?$(n._WARNING_INVOICE).show():$(n._WARNING_INVOICE).hide()):($(n._WARNING).hide(),$(n._WARNING_INVOICE).hide())}})},enableWizard:function(){$.wizard()!=null&&$.wizard().hideProgress();$(".wizard-progress").remove();$("#change-payment-method-dialog").show();$.wizard().enableComplete()},close:function(){var n=this,t;$(n._DROPDOWN).paymentInstrumentsDropDown("destroy");$(n._ADD_PAYMENT_METHOD).unbind("click");$(n._NEW_INVOICE).unbind("click");$(n._EDIT_PI).unbind("click");t=$.wizard();t!=null&&(t.readyToProceed=1,t.complete());$("#wizard-button-complete").unbind("click.cpm");$("#wizard-button-close").unbind("click.cpm")},_exchangeDataSync:function(n){var t=this;n!=null&&(n.status=="Success"?t.ensurePaymentInstrumentsListUpdated(n.result):$.wizard().showErrorInNotificationBar(t.Resources.BillingFrameTransactionError,null));t.spinner!=null&&t.spinner.resolve();t.fadeInWizardInsteadOfPcs()},launchPcsFrame:function(n){var t=this;t.spinner=$.wizard().spinner();loadIframe(n,!0)},fadeInWizardInsteadOfPcs:function(){var n=this;return $.when($("#dialog").fadeIn(n._FADE_IN_INTERVAL)).then($(n._THE_PCS_CONTAINER).fadeOut(n._FADE_OUT_INTERVAL))},fadeInPcsInsteadOfWizard:function(){var n=this;return $.when($(n._THE_PCS_CONTAINER).fadeIn(n._FADE_IN_INTERVAL)).then($("#dialog").fadeOut(n._FADE_OUT_INTERVAL))},getPaymentInstrumentsOnFile:function(n){var t=this,u=t.Model.AvailablePaymentInstruments,r=t.Model.GetPaymentInstrumentUrl+"?piid="+encodeURIComponent(n),i=$.wizard().spinner();auxAjax({url:r,type:"POST",dataType:"json",success:function(n){$(t._DROPDOWN).paymentInstrumentsDropDown("appendItem",n);n.PaymentInstrument.IsInvoice===!0&&$(t._NEW_INVOICE).wizardButton().disable().hide();i.resolve()},error:function(){i.resolve();$.wizard()&&$.wizard().showErrorInNotificationBar(t.Resources.BillingFrameTransactionError,null)}})},ensurePaymentInstrumentsListUpdated:function(n){var t=this,r=n.paymentInstrumentId,u=t.Model.AvailablePaymentInstruments,f=!1,e;for(i=0;i<u.length;i++)if(u[i].PaymentInstrument.PaymentInstrumentIdOriginal==r){f=!0;break}f||(e=r,t.getPaymentInstrumentsOnFile(e))},setNewPaymentInstrumentForSubscription:function(){var n=this,r=$(n._DROPDOWN).paymentInstrumentsDropDown("getSelectedItem"),i=r.PaymentInstrument.PaymentInstrumentId,u=n.Model.CurrentlyUsedPaymentInstrument.PaymentInstrument.PaymentInstrumentId,f=n.Model.SubscriptionId,t;u!=i?($("#change-payment-method-dialog").hide(),$.wizard()!=null&&($.wizard().disableComplete(),$.wizard().showProgress()),$("input[name=subscriptionId]").val(f),$("input[name=newPaymentInstrumentId]").val(i),t=$("#setPaymentForm"),auxAjax({url:t.attr("action"),type:"POST",data:t.serialize(),success:function(t){typeof t=="string"&&t.match("/Error/500")?(n.enableWizard(),$.wizard().showErrorInNotificationBar(n.Resources.BillingFrameTransactionError,null)):($.wizard()!=null&&$.wizard().waitToAdvance(0),n.close(),t.returnUrl&&(document.location=t.returnUrl))},error:function(){n.enableWizard();$.wizard().showErrorInNotificationBar(n.Resources.BillingFrameTransactionError,null)}})):n.close()},editCurrentPaymentInstrument:function(){var n=this,r=n.Model.AvailablePaymentInstruments,t=$(n._DROPDOWN).paymentInstrumentsDropDown("getSelectedIndex"),i;return t>=0&&t<r.length&&(i=r[t].EditLink,i!=""&&n.launchPcsFrame(i)),!1},addInvoice:function(){var n=this,t=n.Model.AddInvoicePcsUrl;return t!=""&&n.launchPcsFrame(t),!1},addPaymentMethod:function(){var n=this,t=n.Model.AddPaymentInstrumentUrl;return n.launchPcsFrame(t),!1},updatePaymentInstrumentsDropDown:function(){var n=this,t=n.Model.AvailablePaymentInstruments,r=n.Model.CurrentlyUsedPaymentInstrument.PaymentInstrument.PaymentInstrumentId;for($(n._DROPDOWN).paymentInstrumentsDropDown("setItems",t),i=0;i<t.length;i++)if(t[i].PaymentInstrument.PaymentInstrumentId==r){$(n._DROPDOWN).paymentInstrumentsDropDown("setSelectedIndex",i);break}}},function(n,t){"use strict";t.Subscriptions.Cancel={Model:{},Resources:{},errorMessage:"",init:function(){var i=this,s="Other",f=n(".cancel-subscription-section"),r=f.find(".cancel-subscription-reason-section"),e=f.find("input[name = PerformAction]"),o=r.find("select#CancellationReason"),u=r.find(".reason-detail"),t=u.find("#CancellationReasonDetail");n.isInWizard("#cancel-subscription")&&(n.wizard().enableComplete(),n.wizard().waitToAdvance(),e.unbind("change"),e.bind("change",function(){this.value==="true"?(n.wizard().disableComplete(),r.removeClass("hide")):(r.addClass("hide"),n.wizard().enableComplete())}),o.unbind("change keyup"),o.bind("change keyup",function(){n(this).find("option:selected").val().length===0?(n.wizard().disableComplete(),u.addClass("hide")):n(this).find("option:selected").val()===s?(n.trim(t.val()).length===0?n.wizard().disableComplete():n.wizard().enableComplete(),t.attr("placeholder",i.Resources.RequiredCancellationReasonField).unbind("keyup"),t.bind("keyup",function(){n.trim(t.val()).length===0?n.wizard().disableComplete():n.wizard().enableComplete()}),u.removeClass("hide")):(t.attr("placeholder",i.Resources.MoreDetailCancellationReasonField).unbind("keyup"),u.removeClass("hide"),n.wizard().enableComplete())}),n("#cancel-subscription form").bind("submit.cs",function(t){t.preventDefault();n("#cancel-subscription").fadeOut("fast");n.wizard().disableComplete();n.wizard().showProgress();var r=n(this);auxAjax({url:r.attr("action"),type:"POST",data:r.serialize(),success:function(t){if(t.success==!0){var r=n.wizard();n.wizard().waitToAdvance(0);n("#wizard-button-complete").unbind("click.cs");n("#wizard-button-close").unbind("click.ed");n("#cancel-subscription form").unbind("submit.cs");t.returnUrl&&(document.location=t.returnUrl);r.complete()}else i.showWizardHideProgress(),n.wizard().showErrorInNotificationBar(i.Resources.GenericError,null)}})}),n("#wizard-button-complete").unbind("click"),n("#wizard-button-complete").bind("click.cs",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-acctcancelsub");n.wizard().showProgress();n.wizard().disableComplete();n("#cancel-subscription").fadeOut("fast");n("#cancel-subscription form").submit()}),n("#wizard-button-close").unbind("click.ed"),n("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-acctcancelsub");n(this).unbind("click.ed")}))},showWizardHideProgress:function(){n.wizard().hideProgress();n.wizard().enableComplete();n("#cancel-subscription").fadeIn("fast")},copyTextToField:function(n,t,i){n.length>0&&t.val(n);i.val("")}}}(jQuery,this);-function(n,t){"use strict";var y="hide",h=".activate-azure-container form",it=".activate-azure-container form input[name=PerformAction]",rt=".activate-azure-container form input[name=PerformAction][value=true]",ut=".activate-azure-container form input[name=PerformAction][value=false]",c=".activate-azure-container form input[name=PaymentInstrumentId]",f=".activate-azure-container",e=".wizard",l="#wizard-content",o=".wizard #wizard-content .wizard-step",p=".wizard #notification-bar",w="important-notification",b="#wizard-button-close",a="#dialog",k="#wizard-buttons",u=".activate-azure-container .friendlyName",ft=".activate-azure-container .select-activate-container",d=".step-number",g=".complete-step",nt=".content",v=".activate-azure-container .sms-challenge-container",et=".activate-azure-container #confirmChallenge",tt=".activate-azure-container .pi-container",s=".activate-azure-container .pi-container .pcs-iframe-container",i=".activate-azure-container .button-container .button",ot=".activate-azure-container .button-container .button .button-text",st=".activate-azure-container .smsChallengeBaloon",ht=".activate-azure-container .piSectionBaloon",r={stepSelectOption:"SelectOptionToUpgrade",stepSms:"Sms",stepPi:"Pi",stepUpgrade:"Upgrade",stepBanned:"Banned"},ct={1:r.stepSelectOption,2:r.stepSms,3:r.stepPi,4:r.stepUpgrade,100:r.stepBanned};t.Subscriptions.ActivateAzure={Resources:{},Model:{},Url:{},Widget:{},DialogPosition:"",CurrentStep:0,StepNumberForUI:0,WizardHeight:0,WizardStepHeight:0,WizardWidth:0,WizardContentWidth:0,WizardStepWidth:0,buttonAction:null,init:function(){var t=this,i=n(b);n.isInWizard("#activate-azure")&&(t.saveWizardSettings(),n.wizard().enableClose(),i.unbind("click.ed"),i.bind("click.ed",function(){t.beforeWizardIsClosed()}),t.initializeBalloon(st,this.Resources.MobileVerificationHelp,this.Resources.Help),t.initializeBalloon(ht,this.Resources.PaymentInformationHelp,this.Resources.Help),t.CurrentStep=1,t.executeCurrentStep())},executeCurrentStep:function(){var t=this,i=n(ft),s=n(et),e=n(it),l=n(rt),o;switch(ct[t.CurrentStep]){case r.stepSelectOption:t.getTextBoxValueChanged(u,200);t.showElementSelector(i);t.StepNumberForUI=0;t.Model.RiskStatus.SmsChallengeBanned?(t.CurrentStep=100,t.executeCurrentStep()):t.Model.RiskStatus.SmsChallengeRequired?(l.attr("checked","checked"),t.setButtonEventforSmsStep(),t.buttonAction=t.setButtonEventforSmsStep):!t.Model.RiskStatus.SmsChallengeRequired&&t.Model.RiskStatus.PIChallengeRequired?(l.attr("checked","checked"),t.setButtonEventforPiStep(),t.buttonAction=t.setButtonEventforPiStep):(n(ut).attr("checked","checked"),t.disableElementSelector(n(u)),t.enableCancelButton(),t.buttonAction=t.setButtonEventforUpgradeStep);e.each(function(i,r){n(r).off("change");n(r).on("change",function(){t.setSubscriptionNameStatus(n(this).val())})});break;case r.stepSms:if(t.StepNumberForUI=0,t.hideElementSelector(i),t.updateButtonToUpgrade(),t.disableButton(),t.showSmsSection(),t.Model.RiskStatus.PIChallengeRequired){t.showPiContainer();s.on("smsChallengeCompleted",function(i){i.stopPropagation!==undefined&&i.stopPropagation();t.showPartialSmsSection();n.wizard().hideNotificationBar();t.CurrentStep++;t.executeCurrentStep()})}else{t.hidePiContainer();t.setButtonEventforUpgradeStep();s.on("smsChallengeCompleted",function(i){i.stopPropagation!==undefined&&i.stopPropagation();n.wizard().hideNotificationBar();t.showPartialSmsSection();t.enableButton()})}break;case r.stepPi:n(c).val(null);t.hideElementSelector(i);t.Model.RiskStatus.SmsChallengeRequired||(t.hideSmsSection(),t.showPiContainer());t.updateButtonToUpgrade();t.disableButton();t.showPCSContainer();break;case r.stepUpgrade:n("#activate-azure").fadeOut("fast");n.wizard().showProgress();n.wizard().disableClose();n.wizard().hideNotificationBar();t.disableButton();o=n(h);auxAjax({url:o.attr("action"),type:"POST",data:o.serialize(),success:function(i){i&&i.success==!0?(t.beforeWizardIsClosed(),document.location=t.Model.ReturnUrl):(n("#activate-azure").fadeIn("fast"),n.wizard().enableClose(),n.wizard().hideProgress(),i&&i.showSmsSection?(n.wizard().showErrorInNotificationBar(t.Resources.UpgradeReenterMobileVerification),t.removePCSIframe(),n(f).find("#confirmCodeDiv").hide(),n(f).find("#sendChallenge").prop("disabled",!1).css("opacity",1),n(f).find("#confirmChallenge").prop("disabled",!1).css("opacity",1),n(f).find("#smsChallengeForm input#phoneNumberText").val("").focus(),n(f).find("#smsChallengeForm input#confirmationText").val("").removeClass("input-success-watermark"),t.CurrentStep=2,t.executeCurrentStep()):i&&i.showPiSection?(n.wizard().showErrorInNotificationBar(t.Resources.UpgradeReenterPaymentInstrument),t.StepNumberForUI--,t.CurrentStep=3,t.executeCurrentStep()):(n.wizard().showErrorInNotificationBar(t.Resources.UpgradeFailed),t.enableCancelButton()))}});break;case r.stepBanned:n.wizard().showErrorInNotificationBar(t.Resources.UnauthorizeSms);t.enableCancelButton();t.disableElementSelector(e);break;default:n.wizard().showErrorInNotificationBar(t.Resources.GenericError);t.enableCancelButton();t.disableElementSelector(e)}},showSmsSection:function(){var t=this,i=n(v);i.find(d).text(++t.StepNumberForUI);t.hideElementSelector(i.find(g));t.showElementSelector(i.find(nt));t.showElementSelector(i)},enableCancelButton:function(){var t=this;n.wizard().enableClose();n.wizard().hideProgress();t.updateButtonToCancel();t.enableButton()},showPartialSmsSection:function(){var t=this,i=n(v);t.hideElementSelector(i.find(nt));t.showElementSelector(i.find(g))},hideSmsSection:function(){this.hideElementSelector(n(v))},showPCSContainer:function(){var n=this;n.expandPISection();n.setButtonEventForPi()},showPiContainer:function(){var t=this,i=n(tt);i.find(d).text(++t.StepNumberForUI);t.showElementSelector(i)},hidePiContainer:function(){this.hideElementSelector(n(tt))},setButtonEventforSmsStep:function(){var t=this,r=n(i);t.enableElementSelector(n(u));t.updateButtonToNext();t.enableButton();r.off("click");r.on("click",function(n){n.preventDefault();t.CurrentStep++;t.executeCurrentStep()})},setButtonEventforPiStep:function(){var t=this,r=n(i);t.enableElementSelector(n(u));t.updateButtonToNext();t.enableButton();r.off("click");r.on("click",function(n){n.preventDefault();t.CurrentStep=t.CurrentStep+2;t.executeCurrentStep()})},setButtonEventforUpgradeStep:function(){var t=this,r=n(i);t.enableElementSelector(n(u));t.updateButtonToUpgrade();t.enableButton();r.off("click");r.on("click",function(n){n.preventDefault();t.CurrentStep=4;t.executeCurrentStep()})},setButtonEventForPi:function(){var t=this,r=n(i);r.off("click");r.on("click",function(){n.wizard().hideNotificationBar();t.disableButton(n(i));t.addPI()})},expandPISection:function(){var t=this,i=n.noop;t.removePCSIframe();t.loadPcsIframe(i)},removePCSIframe:function(){var t=n(s);t.data("auxPcsv2")&&t.auxPcsv2("destroy")},loadPcsIframe:function(t){var i=this,r=i.Model.PcsAddUrl,u,f;i.removePCSIframe();i.Model.AccountIdForPcs&&(u={},u.accountid=i.Model.AccountIdForPcs,r=appendQueryString(r,u));f=n.extend({},{pcsUrl:r,loadingImageUrl:this.Widget.PcsV2.LoadingImageUrl,waitText:this.Widget.PcsV2.GenericWait,navigaton:function(n){i.onPcsNavigationRequired.call(i,n)},error:function(n){i.onPcsError.call(i,n)},loaded:function(){i.onPcsLoaded.call(i,t)},heightChanged:function(n){i.heightChanged.call(i,n)}});n(s).auxPcsv2(f)},onPcsLoaded:function(t){var i=this;t&&t();i.enableButton();n(a).css("position","absolute")},onPcsError:function(t){var i=this,r=this.Widget.PcsV2.ErrorCodes,u=n(s);n.wizard().hideProgress();u.data("auxPcsv2")&&u.auxPcsv2("destroy");t===r.NotLoggedIn||t===r.SessionExpired?n.wizard().showErrorInNotificationBar(this.Resources.PcsSessionExpired):t===r.DisagreeWithConsent?document.location=i.Model.ReturnUrl:n.wizard().showErrorInNotificationBar(this.Resources.PaymentIntrumentFailedForUpgrade);i.updateButtonToCancel();i.enableButton()},addPI:function(){var t=this,i=n(s);i.data("auxPcsv2")&&i.auxPcsv2("performNext").done(function(r){n.wizard().showProgress();n(c).val(r.piid);i.auxPcsv2("destroy");t.CurrentStep++;t.executeCurrentStep()}).fail(function(){n(c).val(null);n.wizard().hideProgress();t.enableButton()})},getTextBoxValueChanged:function(t,i){var r=this,f=n.Deferred(),u=n(t);u.unbind().die();u.off("input");u.on("input",function(u){r.timerFunction!=null&&window.clearTimeout(r.timerFunction);var f=u.keyCode!=9?t:null;return r.timerFunction=window.setTimeout(function(){n(h).valid()?r.enableButton():r.disableButton()},i),!0});return f},setSubscriptionNameStatus:function(t){var i=this,r=n(u);t==="true"?(i.enableElementSelector(r),i.buttonAction()):(i.disableElementSelector(r),i.enableCancelButton())},initializeBalloon:function(t,i,r){n(t).fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:r,balloonOptions:{title:null,content:i}})},updateButtonToNext:function(){var n=this;n.updateTextAndTitleButton(n.Resources.Next)},updateButtonToUpgrade:function(){var n=this;n.updateTextAndTitleButton(n.Resources.UpgradeNow)},updateButtonToCancel:function(){var t=this,r=n(i);t.updateTextAndTitleButton(t.Resources.Cancel);r.off("click");r.on("click",function(n){n.preventDefault();t.onWizardNoActionAndClose()})},updateTextAndTitleButton:function(t){n(i).attr("title",t);n(ot).text(t)},enableButton:function(){this.enableElementSelector(n(i))},disableButton:function(){this.disableElementSelector(n(i))},enableElementSelector:function(n){n.attr("disabled",!1)},disableElementSelector:function(n){n.attr("disabled","disabled")},hideElementSelector:function(n){n.addClass(y)},showElementSelector:function(n){n.removeClass(y)},onWizardNoActionAndClose:function(){this.beforeWizardIsClosed();n.wizard().close()},beforeWizardIsClosed:function(){n(i).off("click");n(h).off("submit");n(b).unbind("click.ed");this.restoreWizardSettings()},heightChanged:function(t){var i=t+260;n(o).height(i-70);n(e).height(i)},restoreWizardSettings:function(){var t=this,i=n(e),r=n(o);i.height(t.WizardHeight);r.height(t.WizardStepHeight);i.width(t.WizardWidth);r.width(t.WizardStepWidth);n(l).width(t.WizardContentWidth);n(a).css("position",t.DialogPosition);n(p).removeClass(w);t.showElementSelector(n(k))},saveWizardSettings:function(){var t=this,i=670;t.hideElementSelector(n(k));t.WizardHeight=n(e).height();t.WizardStepHeight=n(o).height();t.WizardWidth=n(e).width();t.WizardContentWidth=n(l).width();t.WizardStepWidth=n(o).width();n(e).width(i);n(l).width(i);n(o).width(i-60);t.DialogPosition=n(a).css("position");n(p).addClass(w)}}}(jQuery,this);Subscriptions.ChangeRenewalDetails={ChangeRenewalDetailsStatus:{},Resources:{},Model:{},PageSelector:"#change-renewal",FormSelector:"#changeRenewalForm",RenewalCheckboxSelector:"#renewCheckbox",OriginalRenewValueSelector:"#originalRenewValue",NewRenewValueSelector:"#newRenewValue",CommitmentAmountSelector:"#monetary-commitment-amount",MonetaryCommitmentSectionSelector:"#change-renewal-mc",showWizardHideProgress:function(){$.wizard().hideProgress();$.wizard().enableComplete();$(this.PageSelector).fadeIn("fast")},monitorRenewalCheckbox:function(){var n=this;$(this.RenewalCheckboxSelector).change(function(){var u=$(n.OriginalRenewValueSelector).val()==="true",t=$(n.RenewalCheckboxSelector).prop("checked"),i=$(n.NewRenewValueSelector),r=$(n.MonetaryCommitmentSectionSelector);u===t?i.val(""):i.val(t);r&&r.find("input, select").prop("disabled",!t)})},initializeMcSectionState:function(){var t=$(this.RenewalCheckboxSelector).prop("checked"),n=$(this.MonetaryCommitmentSectionSelector);n&&n.find("input, select").prop("disabled",!t)},monitorCommitmentAmount:function(){this.monitorTextBoxChange(Subscriptions.MonetaryCommitment.estimateMonetaryCommitmentChanges,Subscriptions.MonetaryCommitment.displayMonetaryCommitmentChanges,this.CommitmentAmountSelector,"commitmentAmount",750)},monitorTextBoxChange:function(n,t,i,r,u){var f=this;$.when(f.getTextBoxValueChanged(function(){f.monitorTextBoxChange(n,t,i,r,u)},i,u).then(function(u,e){var o,s;f.propValueChange(r,u)?(o=i+", #add-payment-method, #new-invoice, #duration, #paymentTime",$.wizard().getButton("complete").isEnabled()&&(o+=", #wizard-button-complete"),s=$.wizard().spinner(o),$.when(n.call(f)).then(function(n){t.call(f,n)}).then(function(n){s.resolve(n)}).then(function(){f.allow2Proceed()}).then(function(){e!=null&&$(e).focus()}).fail(function(){s.reject();e!=null&&$(e).focus()})):f.allow2Proceed()}).fail(function(n){Subscriptions.MonetaryCommitment.showCommitmentAmountError();$.wizard().disableComplete();n!=null&&$(n).focus()}))},propValueChange:function(n,t){var i=!1;return $("input:hidden[name="+n+"]").each(function(n,r){var u=$(r),f=u.val();u.val(t);i||t===f||(i=!0)}),i},getTextBoxValueChanged:function(n,t,i){var r=this,u=$.Deferred(),f=$(t);return f.unbind().die(),f.keyup(function(f){r.timerFunction!=null&&window.clearTimeout(r.timerFunction);var e=function(){if($(r.FormSelector).valid()){var i=$(t).val();u.resolve(i,o)}else u.reject(o);n.call(r)},o=f.keyCode!=9?t:null;return f.keyCode===undefined?e():r.timerFunction=window.setTimeout(e,i),!0}),u},allow2Proceed:function(){if(Subscriptions.MonetaryCommitment.hideCommitmentAmountError(),this.PaymentInstrumentRequired){var n=$(this._DROPDOWN).paymentInstrumentsDropDown("getSelectedIndex");$(this.FormSelector).valid()&&n>-1?$.wizard().enableComplete():$.wizard().disableComplete()}else $(this.FormSelector).valid()?$.wizard().enableComplete():$.wizard().disableComplete()},setupWizardSubmit:function(){var n=this;$.isInWizard(n.PageSelector)&&($.wizard().enableComplete(),$.wizard().waitToAdvance(),$(n.FormSelector).bind("submit.ed",function(t){t.preventDefault();var i=$(this);auxAjax({url:i.attr("action"),type:"POST",data:i.serialize(),success:function(t){switch(t){case n.ChangeRenewalDetailsStatus.InvalidData:$.wizard().showErrorInNotificationBar(n.Resources.GenericError,null);n.showWizardHideProgress();break;case n.ChangeRenewalDetailsStatus.ErrorRenewalState:n.showWizardHideProgress();$.wizard().showErrorInNotificationBar(n.Resources.GenericError,null);break;case n.ChangeRenewalDetailsStatus.ErrorMonetaryCommitment:n.showWizardHideProgress();$.wizard().showErrorInNotificationBar(n.Resources.GenericError,null);break;case n.ChangeRenewalDetailsStatus.UnknownError:n.showWizardHideProgress();$.wizard().showErrorInNotificationBar(n.Resources.GenericError,null);break;case n.ChangeRenewalDetailsStatus.SubscriptionNotFound:n.showWizardHideProgress();$.wizard().showErrorInNotificationBar(n.Resources.InvalidSubscription,null);break;default:$(n.FormSelector).unbind("submit.ed");$("#wizard-button-complete").unbind("click.ed");$("#wizard-button-close").unbind("click.ed");document.location=n.Model.ReturnUrl}}})}),$("#wizard-button-complete").unbind("click"),$("#wizard-button-complete").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-accteditsub");$.wizard().showProgress();$.wizard().disableComplete();$(n.PageSelector).fadeOut("fast");$(n.FormSelector).submit()}),$("#wizard-button-close").unbind("click.ed"),$("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-accteditsub");$(this).unbind("click.ed")}))},init:function(){this.setupWizardSubmit();this.initializeMcSectionState();this.monitorRenewalCheckbox();this.monitorCommitmentAmount()}};Subscriptions.AddFunds={Resources:{},Model:{},PageSelector:"#add-funds-dialog",FormSelector:"#changeCommitmentAmountForm",CommitmentAmountSelector:"#monetary-commitment-amount",PaymentTimeSelector:"#mc-payment-time",DurationSelector:"#mc-duration",showWizardHideProgress:function(){$.wizard().hideProgress();$.wizard().enableComplete();$(this.PageSelector).fadeIn("fast")},monitorCommitmentAmount:function(){this.monitorTextBoxChange(Subscriptions.MonetaryCommitment.estimateMonetaryCommitmentChanges,Subscriptions.MonetaryCommitment.displayMonetaryCommitmentChanges,this.CommitmentAmountSelector,"commitmentAmount",750)},hideUnusedFields:function(){$(this.PaymentTimeSelector).hide();$(this.DurationSelector).hide()},validateInput:function(){var n=$(this.CommitmentAmountSelector),t=-1,i;try{t=parseFloat(n.val())}catch(r){t=-1}return i=t>=this.Model.CurrentCommitmentAmount,i?(n.removeClass("instance-count-inline-error"),$.wizard().enableComplete()):(n.addClass("instance-count-inline-error"),$.wizard().disableComplete()),i},monitorTextBoxChange:function(n,t,i,r,u){var f=this;$.when(this.getTextBoxValueChanged(function(){f.monitorTextBoxChange(n,t,i,r,u)},i,u).then(function(u,e){var o,s;f.propValueChange(r,u)?f.validateInput()?(o=i+", #add-payment-method, #new-invoice, #duration, #paymentTime",$.wizard().getButton("complete").isEnabled()&&(o+=", #wizard-button-complete"),s=$.wizard().spinner(o),$.when(n.call(f)).then(function(n){t.call(f,n)}).then(function(n){s.resolve(n)}).then(function(){f.allow2Proceed()}).then(function(){e!=null&&$(e).focus()}).fail(function(){s.reject();e!=null&&$(e).focus()})):Subscriptions.MonetaryCommitment.showCommitmentAmountError(f.Model.CurrentCommitmentAmount):f.allow2Proceed()}).fail(function(n){Subscriptions.MonetaryCommitment.showCommitmentAmountError(f.Model.CurrentCommitmentAmount);$.wizard().disableComplete();n!=null&&$(n).focus()}))},propValueChange:function(n,t){var i=!1;return $("input:hidden[name="+n+"]").each(function(n,r){var u=$(r),f=u.val();u.val(t);i||t===f||(i=!0)}),i},getTextBoxValueChanged:function(n,t,i){var r=this,u=$.Deferred(),f=$(t);return f.unbind().die(),f.keyup(function(f){r.timerFunction!=null&&window.clearTimeout(r.timerFunction);var e=f.keyCode!=9?t:null;return r.timerFunction=window.setTimeout(function(){if($(r.FormSelector).valid()){var i=$(t).val();u.resolve(i,e)}else u.reject(e);n.call(r)},i),!0}),u},allow2Proceed:function(){if(Subscriptions.MonetaryCommitment.hideCommitmentAmountError(),this.PaymentInstrumentRequired){var n=$(this._DROPDOWN).paymentInstrumentsDropDown("getSelectedIndex");$(this.FormSelector).valid()&&n>-1?$.wizard().enableComplete():$.wizard().disableComplete()}else $(this.FormSelector).valid()?$.wizard().enableComplete():$.wizard().disableComplete()},setupWizardSubmit:function(){var n=this;$.isInWizard(this.PageSelector)&&($.wizard().enableComplete(),$.wizard().waitToAdvance(),$(this.FormSelector).bind("submit.ed",function(t){t.preventDefault();var i=$(this);auxAjax({url:i.attr("action"),type:"POST",data:i.serialize(),success:function(t){t.success?($(n.FormSelector).unbind("submit.ed"),$("#wizard-button-complete").unbind("click.ed"),$("#wizard-button-close").unbind("click.ed"),document.location=n.Model.ReturnUrl):(n.showWizardHideProgress(),$.wizard().showErrorInNotificationBar(n.Resources.GenericError,null))}})}),$("#wizard-button-complete").unbind("click"),$("#wizard-button-complete").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-accteditsub");$.wizard().showProgress();$.wizard().disableComplete();$(n.PageSelector).fadeOut("fast");$(n.FormSelector).submit()}),$("#wizard-button-close").unbind("click.ed"),$("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-accteditsub");$(this).unbind("click.ed")}))},init:function(){this.hideUnusedFields();this.setupWizardSubmit();this.monitorCommitmentAmount()}},function(n,t){"use strict";var f,e="#reload-prepaid-balance-dialog",r="#reload-amount",h="#reload-tax",c="#reload-total-amount",rt="#payment-method",u="#prepaid-token-text",ut=".prepaid-token-container",ft=".prepaid-token-container .validate-prepaid-token-button",l=".prepaid-token-container .token-validation-message",a=".prepaid-token-container .token-validation-error-message",v=".prepaid-token-container .token-confirmation-message",y="PrepaidToken",p="CreditCard",i="hide",et,w="position",kt="absolute",b="#dialog",ot,st,ht,k="#wizard-content",d=".wizard",g=".wizard #wizard-content .wizard-step",dt=230,ct=".reload-prepaid-container .prepaid-credit-card-container",o=".prepaid-credit-card-container .pcs-iframe-container",lt="#checkbox-payment-credit-card",nt=".reload-finish-button",tt=".reload-next-button",at=".reload-finish-button-container",vt=".reload-next-button-container",gt=".reload-prepaid-container .prepaid-amount-tax-container",s=".reload-prepaid-container .recharge-payment-method select",ni=".reload-prepaid-container input, .reload-prepaid-container select",ti=".reload-prepaid-container .prepaid-tax-container input",yt="#paymentInstrumentBrief",pt=".reload-spinner",it=null,ii=750,ri=".recharge-amount-container",wt=".reload-prepaid-container .upgrade-recharge-container",ui=".reload-prepaid-container .recharge-after-upgrade",bt="#FriendlyName";t.Subscriptions.ReloadBalanceForPrepaidTokensAndCreditCard={Resources:{},Model:{},SubscriptionStatus:{},Url:{},paymentType:null,isAmountValid:!1,showWizardHideProgress:function(){n.wizard().hideProgress();n(e).fadeIn("fast")},setupWizardSubmit:function(){var t=this;if(n.isInWizard(e)){n.wizard().waitToAdvance();n(nt).on("click",function(){n.wizard().hideNotificationBar();n.wizard().showProgress();n(e).fadeOut("fast");t.disableFinishButton();t.setEnableStateOfSelectedFormElements(n(ni),!1);n(rt).val()===p?t.redirectToPaymentProvider(n(r).val(),null):t.redirectToPaymentProvider(null,t.getPrepaidToken())});n(tt).on("click",function(){n.wizard().hideNotificationBar();t.setEnableStateOfSelectedFormElements(n(s),!1);t.disableNextButton();t.addnewPI()});n("#wizard-button-close").unbind("click.ed");n("#wizard-button-close").bind("click.ed",function(){t.restoreWizardSettings();n(g).height(ht);n(this).unbind("click.ed")})}},redirectToPaymentProvider:function(i,r){var u=this;n.wizard().showProgress();u.disableFinishButton();n(e).fadeOut("fast");auxAjax({url:this.Url.ReloadUrl,type:"POST",success:function(i){i?i.success?(u.restoreWizardSettings(),n.wizard().close(),t.setTimeout(function(){t.location.reload()},1e3)):(u.showWizardHideProgress(),i.errorMessage?n.wizard().showErrorInNotificationBar(i.errorMessage,null):n.wizard().showErrorInNotificationBar(u.Resources.GenericError,null)):(u.showWizardHideProgress(),n.wizard().showErrorInNotificationBar(u.Resources.GenericError,null))},data:{amount:i,prepaidTokenCode:r,offerId:this.Model.OfferId,subscriptionId:this.Model.SubscriptionId,paymentType:this.paymentType,paymentInstrumentId:f},error:function(){u.showWizardHideProgress();n.wizard().showErrorInNotificationBar(u.Resources.GenericError,null)}})},restoreWizardSettings:function(){n(d).height(ot);n(k).height(st);n(b).css(w,et)},getPrepaidToken:function(){var t=n(u).val();return t&&(t=t.trim().toUpperCase()),t},showPrepaidTokenInput:function(){n(ut).removeClass(i);this.showFinishButton()},hidePrepaidTokenInput:function(){n(ut).addClass(i);this.hideFinishButton()},showCreditCardDetails:function(){this.expandPISection();n(ct).removeClass(i)},hideCreditCardDetails:function(){n(ct).addClass(i);this.hideNextButton()},expandPISection:function(){var i=this,r=n.noop,t=n(o);t.data("auxPcsv2")&&t.auxPcsv2("destroy");i.loadPcsIframe(r)},loadPcsIframe:function(t){var i=this,r=i.Model.PcsAddUrl,u=n(o),f,e;u.data("auxPcsv2")&&u.auxPcsv2("destroy");i.Model.AccountIdForPcs&&(f={},f.accountid=i.Model.AccountIdForPcs,r=appendQueryString(r,f));e=n.extend({},{pcsUrl:r,loadingImageUrl:this.Widget.PcsV2.LoadingImageUrl,waitText:this.Widget.PcsV2.GenericWait,navigaton:function(n){i.onPcsNavigationRequired.call(i,n)},error:function(n){i.onPcsError.call(i,n)},loaded:function(){i.onPcsLoaded.call(i,t)},heightChanged:function(n){i.heightChanged.call(i,n)}});u.auxPcsv2(e)},heightChanged:function(t){var i=t+dt;n(d).height(i);n(k).height(i)},onPcsLoaded:function(t){t&&t();this.showNextButton();et=n(b).css(w);n(b).css(w,kt)},onPcsError:function(t){var i=this.Widget.PcsV2.ErrorCodes;this.setEnableStateOfSelectedFormElements(n(s),!0);n.wizard().hideProgress();t===i.NotLoggedIn||t===i.SessionExpired?(n(o).auxPcsv2("destroy"),n.wizard().showErrorInNotificationBar(this.Resources.PcsSessionExpired)):t===i.DisagreeWithConsent?window.top.location.href=Url.Action(SubscriptionsController.Instance.Index).ToAbsoluteUrl():n.wizard().showErrorInNotificationBar(this.Resources.GenericError)},showRechargeAmountDetails:function(){this.hideNextButton();this.setEnableStateOfSelectedFormElements(n(ti),!1);n(r).val("");n(gt).removeClass(i);this.showFinishButton()},addnewPI:function(){var t=this,i=n(o);i.data("auxPcsv2")&&i.auxPcsv2("performNext").done(function(r){n.wizard().showProgress();f=r.piid;i.auxPcsv2("destroy");var u=t.setAddressOnAccount(f);u.done(function(i){i.success?t.getPaymentInstrument(f,function(i){n.wizard().hideProgress();t.restoreWizardSettings();i&&t.showPaymentInstrumentFriendlyName(i);t.showRechargeAmountDetails(i)},function(){n.wizard().hideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError)}):(n.wizard().hideProgress(),t.setEnableStateOfSelectedFormElements(n(s),!0),n.wizard().showErrorInNotificationBar(t.Resources.ClickToTryAgain))}).fail(function(){n.wizard().hideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError)})}).fail(function(){f=null;n.wizard().hideProgress();t.setEnableStateOfSelectedFormElements(n(s),!0);t.enableNextButton()})},showPaymentInstrumentFriendlyName:function(t){var u,f,r;t.PaymentInstrumentId!=null&&(n(yt).children().empty(),r=(t.Brand!=""?t.Brand+" - ":"")+t.FriendlyName,u=n("<div class='pi-entry-name' />"),t.IconFile!=null&&(f=n("<img />").attr("src","/Content/aux-pre/Images/"+t.IconFile).attr("alt",r),u.append(f)),r=n("<span />").text(r),u.append(r),n(yt).append(u).removeClass(i))},getPaymentInstrument:function(n,t,i){var r={},u;r.piid=n;u=appendQueryString(this.Url.GetPaymentInstrumentUrl,r);auxPost(u,function(n){var i;n&&(i=n.PaymentInstrument);t&&t(i)},function(){i&&i()})},setAddressOnAccount:function(n){return auxAjax({url:this.Url.SetAddressUrl,type:"POST",dataType:"json",data:{paymentInstrumentId:n}})},validatePrepaidToken:function(n){return auxAjax({url:this.Url.ValidateTokenUrl,type:"POST",dataType:"json",data:{prepaidTokenCode:n}})},showPrepaidTokenValidationMessage:function(t,r){var u=n(l),f=n(a),e=n(v);u.addClass(i);f.addClass(i);e.addClass(i);t?(u.text(r).removeClass(i),e.removeClass(i)):f.text(r).removeClass(i)},enableFinishButton:function(){this.setEnableStateOfSelectedFormElements(n(nt),!0)},disableFinishButton:function(){this.setEnableStateOfSelectedFormElements(n(nt),!1)},enableNextButton:function(){this.setEnableStateOfSelectedFormElements(n(tt),!0)},disableNextButton:function(){this.setEnableStateOfSelectedFormElements(n(tt),!1)},showNextButton:function(){n(vt).removeClass(i);this.enableNextButton()},hideNextButton:function(){n(vt).addClass(i)},showFinishButton:function(){n(at).removeClass(i)},hideFinishButton:function(){n(at).addClass(i)},initPaymentHandlers:function(){var t=this;n(rt).change(function(){var i=this.value;i===y?(n.wizard().hideNotificationBar(),t.hideCreditCardDetails(),t.restoreWizardSettings(),t.showPrepaidTokenInput(),t.paymentType=y):i===p&&(n.wizard().hideNotificationBar(),t.hidePrepaidTokenInput(),t.restoreWizardSettings(),t.showCreditCardDetails(),t.paymentType=p)});n(u).on("change keyup input",function(){var r=this.value?this.value.trim().length>0:!1;n(l).addClass(i);n(a).addClass(i);n(v).addClass(i);n(u).removeClass("fx-validation-valid");n(u).removeClass("fx-validation-invalid");n.wizard().hideNotificationBar();t.disableFinishButton();t.setEnableStateOfSelectedFormElements(n(ft),r)});n(ft).on("click",function(){n(u).removeClass("fx-validation-invalid").addClass("fx-validation-deferred-pending");var i=t.validatePrepaidToken(t.getPrepaidToken());i.done(function(i){i&&i.availableCreditsMessage?(n(u).removeClass("fx-validation-invalid").removeClass("fx-validation-deferred-pending").addClass("fx-validation-valid").addClass("fx-validation-deferred-valid"),t.showPrepaidTokenValidationMessage(!0,i.availableCreditsMessage),t.enableFinishButton(),n.wizard().hideNotificationBar()):(t.showPrepaidTokenValidationMessage(!1,t.Resources.GenericError),t.disableFinishButton(),n(u).removeClass("fx-validation-deferred-pending").addClass("fx-validation-invalid"))}).fail(function(n){t.showInvalidPrepaidToken(n)})})},showInvalidPrepaidToken:function(t){var r=null,f=this.Resources.GenericError;t&&t.responseText&&(r=n.parseJSON(t.responseText))&&r.message&&(f=r.message);n.wizard().showErrorInNotificationBar(f,null);this.disableFinishButton();n(u).removeClass("fx-validation-deferred-pending").addClass("fx-validation-invalid");n(l).addClass(i);n(a).addClass(i);n(v).addClass(i)},enableCompleteIfApplicable:function(){this.isAmountValid&&f&&n(lt).prop("checked")?this.enableFinishButton():this.disableFinishButton()},validatePrepaidAmount:function(){var t=this,f=parseInt(n(r).val(),10),i=n(r),u;return!i.val().trim()||isNaN(i.val())||f>t.Model.MaxAmount?(n.wizard().showErrorInNotificationBar(t.Resources.PrepaidAmountInvalid,null),i.addClass("instance-count-inline-error"),u=!1):f<t.Model.MinAmount?(n.wizard().showErrorInNotificationBar(t.Resources.MinimumPrepaidAmountInvalid.replace("{0}",t.Model.CurrencyFormat.replace("{0}",t.Model.MinAmount))),i.addClass("instance-count-inline-error"),u=!1):(n.wizard().hideNotificationBar(),i.removeClass("instance-count-inline-error"),u=!0),u},displayAmountChanges:function(t){n(h).val(t.tax);n(c).val(t.totalAmount);this.setEnableStateOfSelectedFormElements(n(r),!0);this.isAmountValid=!0},estimateAmountChanges:function(){return auxAjax({url:this.Url.GetReloadTaxAmountsUrl,type:"POST",dataType:"json",data:{subscriptionId:this.Model.SubscriptionId,amount:n(r).val(),paymentInstrumentId:f}})},estimateAmountChangesResult:function(){var t=this;t.setEnableStateOfSelectedFormElements(n(r),!1);n(h).val("");n(c).val("");t.showSpinner();n.when(t.estimateAmountChanges.call(t)).then(function(n){t.displayAmountChanges.call(t,n);t.hideSpinner();t.enableCompleteIfApplicable()}).fail(function(){n.wizard().showErrorInNotificationBar(t.Resources.ComputeTaxGenericError);t.setEnableStateOfSelectedFormElements(n(r),!0);t.hideSpinner()})},showSpinner:function(){n(pt).removeClass(i)},hideSpinner:function(){n(pt).addClass(i)},setEnableStateOfSelectedFormElements:function(n,t){t?n.attr("disabled",!1):n.attr("disabled","disabled")},initializeBalloon:function(t,i){n(t).fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:i}})},initializePrepaidTokenFlow:function(n){n.PrepaidTokensSupported!==!1&&(this.initPaymentHandlers(),this.paymentType=y,this.disableFinishButton(),this.initializeBalloon(".paymentMethodInformationBalloon",this.Resources.PaymentMethodHelp),this.initializeBalloon(".prepaidTokenInformationBalloon",this.Resources.PrepaidTokenHelp))},init:function(){var t=this,i=n(r);t.setupWizardSubmit();t.initializePrepaidTokenFlow(t.Model);n(i).bind("keyup",function(r){var e=i,o=parseInt(e.val(),10),f,u;t.isAmountValid=!1;it!=null&&window.clearTimeout(it);u=function(){f=t.validatePrepaidAmount();f?t.estimateAmountChangesResult():(n(h).val(""),n(c).val(""))};r.keyCode===undefined?u():it=window.setTimeout(u,ii);t.enableCompleteIfApplicable()});n(lt).on("change",function(){t.enableCompleteIfApplicable()});ot=n(d).height();st=n(k).height();ht=n(g).height();n(g).height("90%")}};t.Subscriptions.ReloadPrepaidBalance={Resources:{},Model:{},SubscriptionStatus:{},Url:{},showWizardHideProgress:function(){n.wizard().hideProgress();n.wizard().enableComplete();n(e).fadeIn("fast")},setupWizardSubmit:function(){var t=this;n.isInWizard(e)&&(n.wizard().enableComplete(),n.wizard().waitToAdvance(),n("#wizard-button-complete").unbind("click"),n("#wizard-button-complete").bind("click.ed",function(){t.redirectToPaymentProvider.call(t)}),n("#wizard-button-close").unbind("click.ed"),n("#wizard-button-close").bind("click.ed",function(){n(this).unbind("click.ed")}))},close:function(){n.wizard().close()},redirectToPaymentProvider:function(){var t=this,f=n(r).val(),o=n(bt).val(),u=n(wt),s=u.find("input[name = PerformAction]"),h=n(ui),i={};n.wizard().hideNotificationBar();n.wizard().showProgress();n.wizard().disableComplete();n(e).fadeOut("fast");i.piId=t.Model.PiId;i.offerId=t.Model.OfferId;i.subscriptionId=t.Model.SubscriptionId;i.amount=f;u.is(":visible")&&(i.performAction=s.prop("checked")?u.find("input[name = PerformAction]:checked").val():!1,i.friendlyName=o);auxAjax({url:this.Url.ReloadUrl.replace("{0}",f),type:"POST",success:function(i){i.rechargeStatus===t.UpgradeRechargeStatus.None?t.close():i.rechargeStatus===t.UpgradeRechargeStatus.Success&&i.redirectionUrl?document.location=i.redirectionUrl:(i.rechargeStatus===t.UpgradeRechargeStatus.RechargeFailed&&(n(u).addClass("hide"),n(h).removeClass("hide")),i.errorMessage?n.wizard().showErrorInNotificationBar(i.errorMessage,null):n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null),t.showWizardHideProgress())},data:i,error:function(){t.showWizardHideProgress();n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null)}})},validatePrepaidAmount:function(){var t=this,u=parseInt(n(r).val(),10),i=n(r);!i.val().trim()||isNaN(i.val())||u>t.Model.MaxAmount?(n.wizard().showErrorInNotificationBar(t.Resources.PrepaidAmountInvalid,null),i.addClass("instance-count-inline-error"),n.wizard().disableComplete()):u<t.Model.MinAmount?(n.wizard().showErrorInNotificationBar(t.Resources.MinimumPrepaidAmountInvalid.replace("{0}",t.Model.CurrencyFormat.replace("{0}",t.Model.MinAmount))),i.addClass("instance-count-inline-error"),n.wizard().disableComplete()):(n.wizard().hideNotificationBar(),i.removeClass("instance-count-inline-error"),n.wizard().enableComplete())},init:function(){var i=this,t=n(r),e=n(ri),u=n(bt),o=n(wt),f=o.find("input[name = PerformAction]"),t=n(r);i.Model.CreditCheckRequired&&t.attr("disabled","disabled");n(e).removeClass("hide");n(t).unbind("keyup change");n(t).bind("keyup change",function(){i.validatePrepaidAmount()});f.unbind("change");f.bind("change",function(){n.wizard().enableComplete();this.value==="true"?(n.wizard().hideNotificationBar(),n(u).removeAttr("disabled"),n(t).removeAttr("disabled"),i.validatePrepaidAmount()):(n.wizard().hideNotificationBar(),n(u).attr("disabled","disabled"),n(t).attr("disabled","disabled"))});this.setupWizardSubmit()}}}(jQuery,this),function(n,t){"use strict";t.Subscriptions.ChangeSpendingLimit={Model:{},Resources:{},FwLinks:{},ChangeSpendingSelectorStr:".change-spending-limit",FormSelectorStr:".change-spending-limit form",init:function(){var t=this;n.isInWizard(this.ChangeSpendingSelectorStr)&&(n.wizard().enableComplete(),n.wizard().waitToAdvance(),n(this.FormSelectorStr).submit(function(i){i.preventDefault();var r=n(this);auxAjax({url:r.attr("action"),type:"POST",data:r.serialize(),success:function(i){if(i.success==!0){var r=n.wizard();n.wizard().waitToAdvance(0);i.returnUrl&&(document.location=i.returnUrl);r.complete()}else t.showWizardHideProgress(),n.wizard().showErrorInNotificationBar(t.Resources.GenericError,null)}})}),n("#wizard-button-complete").click(function(){var i=n(t.ChangeSpendingSelectorStr);n.wizard().showProgress();n.wizard().disableComplete();i.fadeOut("fast");i.find("form").submit()}))},showWizardHideProgress:function(){n.wizard().hideProgress();n.wizard().enableComplete();n(this.ChangeSpendingSelectorStr).fadeIn("fast")}}}(jQuery,this);Subscriptions.PartnerInformation={Resources:{},Model:{},Url:{},pageSelector:"#partner-information",partnerIdHelpSelector:".partner-id-help",partnerIdTextSelector:"#partner-id-text",partnerIdValidateButtonSelector:"#partner-id-validate-button",partnerNameSelector:"#partner-name-text",wizardCompleteButtonSelector:"#wizard-button-complete",currentPartnerId:null,currentPartnerName:null,initializeBalloon:function(n,t){$(n).fxBalloonIcon({url:{icon:"../../Content/Images/fx.balloonicon.icon-help.png",iconHover:"../../Content/Images/fx.balloonicon.icon-help-hvr.png"},altText:"Help",balloonOptions:{title:null,content:t}})},setEnableStateOfSelectedElements:function(n,t){t?n.attr("disabled",!1):n.attr("disabled","disabled")},getPartnerId:function(){var n=$(this.partnerIdTextSelector).val();return n&&(n=n.trim().toUpperCase()),n},validatePartnerId:function(n){return auxAjax({url:this.Url.ValidatePartnerIdUrl,type:"POST",dataType:"json",data:{partnerId:n}})},updatePartnerName:function(n){this.currentPartnerName=n;$(this.partnerNameSelector).text(n)},hideValidationMessages:function(){$(this.partnerIdTextSelector).removeClass("fx-validation-invalid").removeClass("fx-validation-valid").removeClass("fx-validation-deferred-valid");$.wizard().hideNotificationBar()},showInvalidPartnerId:function(n){var i=this.Resources.SubscriptionPartnerError,t;n&&n.responseText&&(t=$.parseJSON(n.responseText),t.message&&(i=t.message));$.wizard().showErrorInNotificationBar(i,null);$.wizard().disableComplete();$(this.partnerIdTextSelector).removeClass("fx-validation-deferred-pending").addClass("fx-validation-invalid")},showWizardOnCommitError:function(n){var t=this.Resources.GenericError;n&&n.errorMessage&&(t=n.errorMessage);$.wizard().hideProgress();$.wizard().enableComplete();$.wizard().showErrorInNotificationBar(t,null);$(this.pageSelector).fadeIn("fast")},commitChanges:function(){var n=this;this.currentPartnerId=this.getPartnerId();this.currentPartnerId!=this.Model.PartnerId?auxAjax({url:this.Url.UpdatePartnerIdUrl,type:"POST",dataType:"json",data:{subscriptionId:this.Model.SubscriptionId,partnerId:this.currentPartnerId},error:function(){n.showWizardOnCommitError(null)},success:function(t){t&&t.success?(n.removeEventHandlers(),$.wizard().close()):n.showWizardOnCommitError(null)}}):(this.removeEventHandlers(),$.wizard().close())},removeEventHandlers:function(){$(this.partnerIdTextSelector).off("change keyup input");$(this.partnerIdValidateButtonSelector).off("click");$(this.wizardCompleteButtonSelector).off("click")},initializeEventHandlers:function(){var n=this;$(this.partnerIdTextSelector).on("change keyup input",function(){n.hideValidationMessages();var t=this.value?this.value.trim().length>0:!1;n.setEnableStateOfSelectedElements($(n.partnerIdValidateButtonSelector),t);t?$.wizard().disableComplete():$.wizard().enableComplete()});$(this.partnerIdValidateButtonSelector).on("click",function(){n.hideValidationMessages();$(n.partnerIdTextSelector).addClass("fx-validation-deferred-pending");n.currentPartnerId=n.getPartnerId();n.updatePartnerName("");var t=n.validatePartnerId(n.getPartnerId());t.done(function(t){t&&t.success?($(n.partnerIdTextSelector).removeClass("fx-validation-deferred-pending").addClass("fx-validation-valid").addClass("fx-validation-deferred-valid"),$.wizard().enableComplete(),n.updatePartnerName(t.name)):n.showInvalidPartnerId(null)}).fail(function(t){n.showInvalidPartnerId(t)})});$(this.wizardCompleteButtonSelector).on("click",function(){$.wizard().hideNotificationBar();$.wizard().showProgress();$.wizard().disableComplete();$(n.pageSelector).fadeOut("fast");n.commitChanges()})},init:function(){this.currentPartnerId=this.Model.PartnerId;this.currentPartnerName=this.Model.PartnerName;$.isInWizard(this.pageSelector)&&($.wizard().enableComplete(),$.wizard().waitToAdvance(),this.initializeBalloon(this.partnerIdHelpSelector,this.Resources.SubscriptionPartnerIdHelp),this.initializeEventHandlers())}};BetaFeatures.SignupForBetaFeature={FwLinks:{},Resources:{UnableToSubmitActivationRequest:"",InvalidQuickAccessToken:"",FeatureActivationWithTokenFailed:""},Url:{Index:"",AddActivationRequest:"",RedeemToken:"",GetSubscriptions:""},Model:{RdfeFeatureId:"",AllowTokens:!1,AllowQueue:!1,HtmlDescription:""},setupPage:function(){this.loadSubscriptions();this.setupTitle();this.setupClickEventHandler();this.setupSignupSubscriptionEventHandler()},setupTitle:function(){var n=$(this.Model.HtmlDescription).find("*").andSelf().filter(function(){return $(this).data("feature-friendly-name-container")!==undefined}),t;t=n.length>0?$(n[0]).text():this.Model.RdfeFeatureId;$("#feature-name-title").text(t)},loadSubscriptions:function(){var n=this,t=this.Resources.UnableToLoadSubscriptions,n=this;$.wizard().showProgress();auxPostWithRetry(n.getSubscriptionLoadUrl(),3,1e4,function(t){return t.length==0?!1:(n.insertSubscriptions(t),$.wizard().enableComplete(),$.wizard().hideProgress(),$("#request-for-feature-activation-content").show(),$("#beta-signup-dialog").show(),!0)},function(){$.wizard().hideProgress();$("#no-subscriptions-for-feature-activation-content").show();$("#beta-signup-dialog").show()})},refreshPage:function(){document.location=this.Url.Index},redeemTokenHandler:function(n){var t=this;n?this.refreshPage():($.wizard().enableComplete(),$("#beta-signup-dialog").show(),$.wizard().hideProgress(),$.wizard().showErrorInNotificationBar(this.Resources.FeatureActivationWithTokenFailed,t.FwLinks.SupportLink))},activationRequestTokenHandler:function(n){var i=this,t=0;n&&(t=3e4);setTimeout(function(){i.refreshPage()},t)},getSubmitUrl:function(){var n,t,u=this,i=$.trim($("#token").val()),r={featureId:this.Model.RdfeFeatureId,subscriptionId:$("#subscription-selector").val()};return this.Model.AllowTokens&&i&&i!=""?(r.token=i,n=appendQueryString(this.Url.RedeemToken,r),t=function(n){u.redeemTokenHandler(n)}):(n=appendQueryString(this.Url.AddActivationRequest,r),t=function(n){u.activationRequestTokenHandler(n)}),{url:n,successHandler:t}},getSubscriptionLoadUrl:function(){var n={featureId:this.Model.RdfeFeatureId};return appendQueryString(this.Url.GetSubscriptions,n)},insertSubscriptions:function(n){$.each(n,function(){var n=$("<option>",{value:this.SubscriptionId}).text(this.FriendlyName);$("#subscription-selector").append(n)});n.length>0&&$.wizard().enableComplete()},setupClickEventHandler:function(){var t=this.Resources.UnableToSubmitActivationRequest,n=this;$("#wizard-button-complete").bind("click.ed",function(){var r=$.trim($("#token").val()),i;!n.Model.AllowTokens||n.Model.AllowQueue||r&&r!==""?($.wizard().hideNotificationBar(),$.wizard().disableComplete(),$("#beta-signup-dialog").hide(),$.wizard().showProgress(),i=n.getSubmitUrl(),auxPost(i.url,function(n){i.successHandler(n)},function(){$.wizard().enableComplete();$("#beta-signup-dialog").show();$.wizard().hideProgress();$.wizard().showErrorInNotificationBar(t,null)})):$.wizard().showErrorInNotificationBar(n.Resources.InvalidQuickAccessToken)})},setupSignupSubscriptionEventHandler:function(){$("#no-subscriptions-for-feature-activation-content").find("a.get-subscription").bind("click.ed",function(){return window.location=$(this).attr("href"),!1})}};BetaFeatures.Index={setupWizard:function(n,t,i){var r={featureId:t},u=appendQueryString(i,r),f=[{URL:u,State:"incomplete",WaitToAdvance:1}];n.wizard({steps:f})}};timeoutStartCookieName="aux-TimeoutStart";isLongTimeoutCookieName="aux-IsLongTimeout";WebTrends.prototype.dcsGetId=function(){var n,t;this.enabled&&document.cookie.indexOf(this.fpc+"=")==-1&&document.cookie.indexOf("WTLOPTOUT=")==-1?(n=document.createElement("script"),n.type="text/javascript",n.async=!0,n.src="//"+this.domain+"/"+this.dcsid+"/wtid.js?callback=dcsCallback",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(n,t)):dcsCallback()};WebTrends.prototype.dcsGetCookie=function(n){for(var s=document.cookie.split("; "),i=[],r=0,t=0,h=n.length,l=s.length,f,u,e,c,o,t=0;t<l;t++)f=s[t],f.substring(0,h+1)==n+"="&&(i[r++]=f);if(u=i.length,u>0){if(r=0,u>1&&n==this.fpc)for(e=new Date(0),t=0;t<u;t++)c=parseInt(this.dcsGetCrumb(i[t],"lv")),o=new Date(c),o>e&&(e.setTime(o.getTime()),r=t);return unescape(i[r].substring(h+1))}return null};WebTrends.prototype.dcsGetCrumb=function(n,t,i){for(var u,f=n.split(i||":"),r=0;r<f.length;r++)if(u=f[r].split("="),t==u[0])return u[1];return null};WebTrends.prototype.dcsGetIdCrumb=function(n,t){for(var u=n.substring(0,n.indexOf(":lv=")),i=u.split("="),r=0;r<i.length;r++)if(t==i[0])return i[1];return null};WebTrends.prototype.dcsIsFpcSet=function(n,t,i,r){var u=this.dcsGetCookie(n);return u?t==this.dcsGetIdCrumb(u,"id")&&i==this.dcsGetCrumb(u,"lv")&&r==this.dcsGetCrumb(u,"ss")?0:3:2};WebTrends.prototype.dcsFPC=function(){var l,i,e,o,r,c;if(document.cookie.indexOf("WTLOPTOUT=")==-1){var n=this.WT,u=this.fpc,t=new Date,f=t.getTimezoneOffset()*6e4+this.timezone*36e5;if(t.setTime(t.getTime()+f),l=new Date(t.getTime()+63072e6),i=new Date(t.getTime()),n.co_f=n.vtid=n.vtvs=n.vt_f=n.vt_f_a=n.vt_f_s=n.vt_f_d=n.vt_f_tlh=n.vt_f_tlv="",document.cookie.indexOf(u+"=")==-1){if(typeof this.gWtId!="undefined"&&this.gWtId!="")n.co_f=this.gWtId;else if(typeof this.gTempWtId!="undefined"&&this.gTempWtId!="")n.co_f=this.gTempWtId,n.vt_f="1";else{for(n.co_f="2",e=t.getTime().toString(),o=2;o<=32-e.length;o++)n.co_f+=Math.floor(Math.random()*16).toString(16);n.co_f+=e;n.vt_f="1"}typeof gWtAccountRollup=="undefined"&&(n.vt_f_a="1");n.vt_f_s=n.vt_f_d="1";n.vt_f_tlh=n.vt_f_tlv="0"}else{var s=this.dcsGetCookie(u),h=this.dcsGetIdCrumb(s,"id"),a=parseInt(this.dcsGetCrumb(s,"lv")),v=parseInt(this.dcsGetCrumb(s,"ss"));if(h==null||h=="null"||isNaN(a)||isNaN(v))return;n.co_f=h;r=new Date(a);n.vt_f_tlh=Math.floor((r.getTime()-f)/1e3);i.setTime(v);(t.getTime()>r.getTime()+18e5||t.getTime()>i.getTime()+288e5)&&(n.vt_f_tlv=Math.floor((i.getTime()-f)/1e3),i.setTime(t.getTime()),n.vt_f_s="1");(t.getDay()!=r.getDay()||t.getMonth()!=r.getMonth()||t.getYear()!=r.getYear())&&(n.vt_f_d="1")}n.co_f=escape(n.co_f);n.vtid=typeof this.vtid=="undefined"?n.co_f:this.vtid||"";n.vtvs=(i.getTime()-f).toString();var w="; expires="+l.toGMTString(),y=t.getTime().toString(),p=i.getTime().toString();document.cookie=u+"=id="+n.co_f+":lv="+y+":ss="+p+w+"; path=/"+(this.fpcdom!=""?"; domain="+this.fpcdom:"");c=this.dcsIsFpcSet(u,n.co_f,y,p);c!=0&&(n.co_f=n.vtvs=n.vt_f_s=n.vt_f_d=n.vt_f_tlh=n.vt_f_tlv="",typeof this.vtid=="undefined"&&(n.vtid=""),n.vt_f=n.vt_f_a=c)}};WebTrends.prototype.dcsQP=function(n){var u,i,t,r;if(typeof n=="undefined")return"";if(u=location.search.substring(1),u!="")for(i=u.split("&"),t=0;t<i.length;t++)if(r=i[t].indexOf("="),r!=-1&&i[t].substring(0,r)==n)return this.qp[this.qp.length]=(t==0?"":"&")+i[t],i[t].substring(r+1);return""};WebTrends.prototype.dcsEvt=function(n,t){for(var i=n.target||n.srcElement;i.tagName&&i.tagName.toLowerCase()!=t.toLowerCase();)i=i.parentElement||i.parentNode;return i};WebTrends.prototype.dcsNavigation=function(n){for(var i="",u="",e=this.dcsSplit(this.navigationtag),o=e.length,t,f,r=0;r<o;r++)if(f=e[r],f.length&&(t=this.dcsEvt(n,f),i=t.getAttribute&&t.getAttribute("id")?t.getAttribute("id"):"",u=t.className||"",i.length||u.length))break;return i.length?i:u};WebTrends.prototype.dcsBind=function(n,t){typeof t=="function"&&document.body&&(document.body.addEventListener?document.body.addEventListener(n,t.wtbind(this),!0):document.body.attachEvent&&document.body.attachEvent("on"+n,t.wtbind(this)))};WebTrends.prototype.dcsET=function(){var n=navigator.appVersion.indexOf("MSIE")!=-1?"click":"mousedown";this.dcsBind(n,this.dcsFormButton);this.dcsBind("submit",this.dcsFormButton);this.dcsBind(n,this.dcsMSLinkTrack);this.dcsBind(n,this.dcsMSImageMap);this.trackanchor==!0&&this.dcsBind(n,this.dcsAnchor)};WebTrends.prototype.dcsMultiTrack=function(){var n=dcsMultiTrack.arguments?dcsMultiTrack.arguments:arguments,t;n.length%2==0&&(this.dcsSetProps(n),t=new Date,this.DCS.dcsdat=t.getTime(),this.dcsFPC(),this.dcsTag(),this.DCS.dcssip=window.location.hostname,this.DCS.dcsuri=window.location.pathname)};WebTrends.prototype.dcsJSONTrack=function(n,t){var i,r,u;for(i in n)typeof i!="undefined"&&typeof n[i]!="undefined"&&(r=[],r[0]=i.toString(),r[1]=n[i].toString(),this.dcsSetProps(r));for(i in t)typeof i!="undefined"&&typeof t[i]!="undefined"&&(r=[],r[0]=i.toString(),r[1]=t[i].toString(),this.dcsSetProps(r),this.DCSdir.ClearVars=this.DCSdir.ClearVars+","+i);u=new Date;this.DCS.dcsdat=u.getTime();this.dcsFPC();this.dcsTag();this.DCS.dcssip=window.location.hostname;this.DCS.dcsuri=window.location.pathname};WebTrends.prototype.dcsCleanUp=function(){this.DCS={};this.WT={};this.DCSext={};arguments.length%2==0&&this.dcsSetProps(arguments)};WebTrends.prototype.dcsSetProps=function(n){for(var t=0;t<n.length;t+=2)n[t].indexOf("WT.")==0?this.WT[n[t].substring(3)]=n[t+1]:n[t].indexOf("DCS.")==0?this.DCS[n[t].substring(4)]=n[t+1]:n[t].indexOf("DCSext.")==0?this.DCSext[n[t].substring(7)]=n[t+1]:n[t].indexOf("DCSdir.")==0&&(this.DCSdir[n[t].substring(7)]=n[t+1])};WebTrends.prototype.dcsSplit=function(n){for(var t=n.toLowerCase().split(","),r=t.length,i=0;i<r;i++)t[i]=t[i].replace(/^\s*/,"").replace(/\s*$/,"");return t};WebTrends.prototype.dcsFormButton=function(n){var u,r,t,i;if(n=n||window.event||"",n&&(typeof n.which!="number"||n.which==1))for(u=["INPUT","BUTTON"],r=0;r<u.length;r++)if(t=this.dcsEvt(n,u[r]),i=t.type||"",(i&&(i=="submit"||i=="image"||i=="button"||i=="reset")||i=="text"&&(n.which||n.keyCode)==13)&&!this.dcsMSLinkTrackException(t)){var f="",e="",o=0;t.form?(f=t.form.action||window.location.pathname,e=t.form.id||t.form.name||t.form.className||"Unknown",o=t.form.method&&t.form.method.toLowerCase()=="post"?"27":"26"):(f=window.location.pathname,e=t.name||t.id||"Unknown",o=u[r].toLowerCase()=="input"?"28":"29");f&&e&&n.keyCode!=9&&this.dcsMultiTrack("DCS.dcsuri",f,"WT.ti","FormButton:"+e,"WT.dl",1,"WT.nv",this.dcsNavigation(n),"DCSext.wtNavigation",this.dcsNavigation(n));this.WT.ti=this.WT.dl=this.WT.nv="";break}};WebTrends.prototype.dcsEvi=function(){var t=this,r=t.evi,i=r.qp,n=t.dcsGetCookie(r.cookie);n&&(r.crumb.length>0&&r.sep.length>0&&(n=t.dcsGetCrumb(n,r.crumb,r.sep)),n&&(i.indexOf("WT.")==0?t.WT[i.substring(3)]=n:i.indexOf("DCS.")==0?t.DCS[i.substring(4)]=n:i.indexOf("DCSext.")==0?t.DCSext[i.substring(7)]=n:t.DCSext[i]=n))};WebTrends.prototype.dcsAdv=function(){this.trackevents&&typeof this.dcsET=="function"&&(window.addEventListener?window.addEventListener("load",this.dcsET.wtbind(this),!1):window.attachEvent&&window.attachEvent("onload",this.dcsET.wtbind(this)));this.dcsFPC();this.dcsEvi();this.dcsMSNvr()};WebTrends.prototype.dcsVar=function(){var u=new Date,n=this.WT,t=this.DCS,e,r,o,s,h,f,i;if(n.tz=parseInt(u.getTimezoneOffset()/-60)||"0",n.bh=u.getHours()||"0",n.ul=navigator.appName=="Netscape"?navigator.language:navigator.userLanguage,typeof screen=="object"&&(n.cd=navigator.appName=="Netscape"?screen.pixelDepth:screen.colorDepth,n.sr=screen.width+"x"+screen.height),typeof navigator.javaEnabled()=="boolean"&&(n.jo=navigator.javaEnabled()?"Yes":"No"),document.title&&(window.RegExp?(e=new RegExp("^"+window.location.protocol+"//"+window.location.hostname+"\\s-\\s"),n.ti=document.title.replace(e,"")):n.ti=document.title),n.js="Yes",n.jv=function(){var n=navigator.userAgent.toLowerCase(),i=parseInt(navigator.appVersion),y=n.indexOf("mac")!=-1,r=n.indexOf("firefox")!=-1,u=n.indexOf("firefox/0.")!=-1,f=n.indexOf("firefox/1.0")!=-1,e=n.indexOf("firefox/1.5")!=-1,o=n.indexOf("firefox/2.0")!=-1,p=r&&!u&&!f&!e&!o,s=!r&&n.indexOf("mozilla")!=-1&&n.indexOf("compatible")==-1,w=s&&i==4,b=s&&i>=5,h=n.indexOf("msie")!=-1&&n.indexOf("opera")==-1,c=h&&i==4&&n.indexOf("msie 4")!=-1,l=h&&!c,k=n.indexOf("opera")!=-1,a=n.indexOf("opera 5")!=-1||n.indexOf("opera/5")!=-1,v=n.indexOf("opera 6")!=-1||n.indexOf("opera/6")!=-1,d=k&&!a&&!v,t="1.1";return p?t="1.8":o?t="1.7":e?t="1.6":u||f||b||d?t="1.5":y&&l||v?t="1.4":l||w||a?t="1.3":c&&(t="1.2"),t}(),n.ct="unknown",document.body&&document.body.addBehavior)try{document.body.addBehavior("#default#clientCaps");n.ct=document.body.connectionType||"unknown";document.body.addBehavior("#default#homePage");n.hp=document.body.isHomePage(location.href)?"1":"0"}catch(c){}if(n.bs=document.all?document.body?document.body.offsetWidth+"x"+document.body.offsetHeight:"unknown":window.innerWidth+"x"+window.innerHeight,this.i18n&&(n.le=typeof document.defaultCharset=="string"?document.defaultCharset:typeof document.characterSet=="string"?document.characterSet:"unknown"),n.tv="8.6.2",n.dl="0",n.ssl=window.location.protocol.indexOf("https:")==0?"1":"0",t.dcsdat=u.getTime(),t.dcssip=window.location.hostname,t.dcsuri=window.location.pathname,n.es=t.dcssip+t.dcsuri,window.location.search&&(t.dcsqry=window.location.search,this.qp.length>0))for(i=0;i<this.qp.length;i++)r=t.dcsqry.indexOf(this.qp[i]),r!=-1&&(o=t.dcsqry.substring(0,r),s=t.dcsqry.substring(r+this.qp[i].length,t.dcsqry.length),t.dcsqry=o+s);if(t.dcsqry)for(h=t.dcsqry.toLowerCase(),f=this.paidsearchparams.length?this.paidsearchparams.toLowerCase().split(","):[],i=0;i<f.length;i++)if(h.indexOf(f[i]+"=")!=-1){n.srch="1";break}window.document.referrer!=""&&window.document.referrer!="-"&&(navigator.appName=="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)<4||(t.dcsref=window.document.referrer))};WebTrends.prototype.dcsEscape=function(n,t){if(typeof n!="undefined"){if(t!=""){n=n.toString();for(var i in t)t[i]instanceof RegExp&&(n=n.replace(t[i],i));return n}return escape(n)}};WebTrends.prototype.dcsA=function(n,t){var r,e,i,u,f,o,s;if(this.i18n&&this.exre!=""&&!this.exre.test(n)){if(n=="dcsqry"){for(r="",e=t.substring(1).split("&"),i=0;i<e.length;i++)u=e[i],f=u.indexOf("="),f!=-1&&(o=u.substring(0,f),s=u.substring(f+1),i!=0&&(r+="%26"),r+=o+"="+this.dcsEncode(s));t=t.substring(0,1)+r}else t=this.dcsEncode(t);return"&"+n+"="+t}return"&"+n+"="+this.dcsEscape(t,this.re)};WebTrends.prototype.dcsEncode=function(n){if(typeof n!="undefined")return typeof encodeURIComponent=="function"?encodeURIComponent(n):escape(n)};WebTrends.prototype.dcsCreateImage=function(n){document.images?(this.images[this.index]=new Image,this.images[this.index].src=n,this.index++):document.write('<IMG ALT="" BORDER="0" NAME="DCSIMG" WIDTH="1" HEIGHT="1" SRC="'+n+'">')};WebTrends.prototype.dcsMeta=function(){var t,u,i;if(document.all?t=document.all.tags("meta"):document.documentElement&&(t=document.getElementsByTagName("meta")),typeof t!="undefined")for(u=t.length,i=0;i<u;i++){var n=t.item(i).name,r=t.item(i).content,f=t.item(i).httpEquiv;n.length>0&&(n.toUpperCase().indexOf("WT.")==0?this.WT[n.substring(3)]=r:n.toUpperCase().indexOf("DCSEXT.")==0?this.DCSext[n.substring(7)]=r:n.toUpperCase().indexOf("DCSDIR.")==0?this.DCSdir[n.substring(7)]=r:n.toUpperCase().indexOf("DCS.")==0&&(this.DCS[n.substring(4)]=r))}this.dcsMSVar()};WebTrends.prototype.dcsTag=function(){var n,s,e,r;if(document.cookie.indexOf("WTLOPTOUT=")==-1){var t=this.WT,u=this.DCS,f=this.DCSext,o=this.i18n,i="http"+(window.location.protocol.indexOf("https:")==0?"s":"")+"://"+this.domain+(this.dcsid==""?"":"/"+this.dcsid)+"/dcs.gif?";o&&(t.dep="");for(n in u)u[n]&&typeof u[n]!="function"&&(i+=this.dcsA(n,u[n]));for(s=["co_f","vtid","vtvs","vt_f_tlv"],e=0;e<s.length;e++)r=s[e],t[r]&&(i+=this.dcsA("WT."+r,t[r]),delete t[r]);for(n in t)t[n]&&typeof t[n]!="function"&&(i+=this.dcsA("WT."+n,t[n]));for(n in f)f[n]&&typeof f[n]!="function"&&(o&&(t.dep=t.dep.length==0?n:t.dep+";"+n),i+=this.dcsA(n,f[n]));o&&t.dep.length>0&&(i+=this.dcsA("WT.dep",t.dep));i.length>2048&&navigator.userAgent.indexOf("MSIE")>=0&&(i=i.substring(0,2040)+"&WT.tu=1");this.dcsCreateImage(i);this.WT.ad="";this.dcsMSSplitTag(i);this.dcsMSClearVars()}};WebTrends.prototype.dcsCollect=function(){this.enabled&&(this.dcsVar(),this.dcsMeta(),this.dcsAdv(),this.dcsTag())};WebTrends.prototype.dcsDQ=function(){for(var n,t=this.q;t.length>0;){n=t.shift();switch(n.cmd.toLowerCase()){case"collect":n.args&&this.dcsSetProps(n.args);this.dcsCollect();break;case"multitrack":n.args?this.dcsMultiTrack.apply(this,n.args):this.dcsMultiTrack()}}};Function.prototype.wtbind=function(n){var t=this;return function(){return t.apply(n,arguments)}};WebTrends.prototype.dcsMSVar=function(){this.DCSext.wtEvtSrc=typeof this.DCSdir.ReferrerAsURI!="undefined"&&this.DCSdir.ReferrerAsURI&&typeof this.DCS.dcsref!="undefined"&&this.DCS.dcsref?this.DCS.dcsref.match(/(?:\w+:\/\/)?([^?\s]+)\??/)[1]:this.DCS.dcssip+this.DCS.dcsuri;typeof this.WT.sp!="undefined"&&(this.WT.sv_sp=this.WT.sp);typeof this.WT.z_gTrackExceptions!="undefined"&&(this.DCSdir.gTrackExceptions=this.WT.z_gTrackExceptions);this.WT.z_locale=this.dcsMSLocaleScrape();this.dcsGetCookie("MC1")!=null&&(this.WT.dcsvid=this.dcsGetCrumb(this.dcsGetCookie("MC1"),"GUID","&"));this.WT.z_anonid=this.dcsMSGetCrumb("A","I","&");this.WT.z_rioid=typeof wt_GetCurrentCellCode!="undefined"?wt_GetCurrentCellCode():this.dcsGetCookie("R");this.WT.z_MUID=this.dcsGetCookie("MUID");this.domain2=typeof this.DCSdir.OnPremiseSDC!="undefined"?this.DCSdir.OnPremiseSDC:"";this.dcsid2=typeof this.DCSdir.OnPremiseDCSID!="undefined"?this.DCSdir.OnPremiseSDC:this.dcsid;typeof this.WT.sp!="undefined"&&(this.WT.sv_sp=this.WT.sp,typeof this.DCSext.wt_pt!="undefined"&&(this.DCSext.wt_sppt=this.WT.sp+this.DCSext.wt_pt,this.DCSext.wt_sppt=this.DCSext.wt_sppt.toLowerCase()))};WebTrends.prototype.dcsMSLocaleScrape=function(){this.WT.z_locale=this.dcsMSLocaleFromString(this.WT.z_locale);var n=this.dcsMSLocaleFromString(this.DCS.dcsuri),t=this.dcsMSLocaleFromString(this.DCS.dcsqry),i=this.dcsMSLocaleFromString(this.DCSext.wt_maglocale),r=this.dcsMSLocaleFromString(this.DCSext.oo_ul),u=this.dcsMSLocaleFromString(this.DCSext.dsplc),f=this.dcsMSLocaleFromString(this.DCSext.msintl_locale);return this.WT.z_locale||n||t||i||r||u||f};WebTrends.prototype.dcsMSLocaleFromString=function(n){var i=/\b\w\w[-\.\/ _]\w\w\b/,t="";return i.test(n)&&(t=n.match(i)+"",t=t.replace(/[-\.\/ _]/,"-"),t=t.toLowerCase()),t};WebTrends.prototype.dcsMSSplitTag=function(n){typeof this.domain2!="undefined"&&this.domain2!=""&&(n=n.replace(this.domain,this.domain2),n=n.replace(this.dcsid,this.dcsid2),this.dcsCreateImage(n))};WebTrends.prototype.dcsMSClearVars=function(){var n,t;if(this.DCSdir.ClearVars)for(n=this.DCSdir.ClearVars.split(","),n=n.concat("WT.z_ea_name","WT.z_ea_actionoffer","WT.z_ea_campaign","WT.mc_id","WT.mc_ev","WT.si_n","WT.si_x","WT.si_p","WT.z_convert","WT.ad","WT.ac","WT.tx_u","WT.tx_s","WT.tx_e","WT.tx_i","WT.tx_id","WT.tx_it","WT.tx_cartid","WT.si_cs"),t=0;t<n.length;t++)n[t].indexOf("WT.")==0?this.WT[n[t].substring(3)]="":n[t].indexOf("DCS.")==0?this.DCS[n[t].substring(4)]="":n[t].indexOf("DCSext.")==0&&(this.DCSext[n[t].substring(7)]="")};WebTrends.prototype.dcsMSDrillDir=function(){var u=5,n=window.location.pathname.substring(window.location.pathname.indexOf("/")+1,window.location.pathname.lastIndexOf("/")+1).toLowerCase(),i,t,r;if(n=="")n="/";else for(i=n.split("/"),n="",t=1;t<i.length&&t<=u;t++){for(n+="/",r=0;r<t;r++)n+=i[r]+"/";t!=u&&t!=i.length-1&&(n+=";")}return n};WebTrends.prototype.dcsIsOnsite=function(n){var i,r,t;if(n.length>0){if(n=n.toLowerCase(),n==window.location.hostname.toLowerCase())return!0;if(typeof this.onsitedoms.test=="function")return this.onsitedoms.test(n);if(this.onsitedoms.length>0)for(i=this.dcsSplit(this.onsitedoms),r=i.length,t=0;t<r;t++)if(n==i[t])return!0}return!1};WebTrends.prototype.dcsMSLinkTrack=function(n){var t,r;if(n=n||window.event||"",n&&(typeof n.which!="number"||n.which==1)&&(t=this.dcsEvt(n,"A"),r=this.dcsEvt(n,"IMG"),t.href&&t.protocol&&t.protocol.indexOf("http")!=-1&&!this.dcsMSLinkTrackException(t))){(t.onclick||t.onmousedown)&&this.dcsMSSetVarCap(t);var u=t.hostname?t.hostname.split(":")[0]:"",f=t.search?t.search.substring(t.search.indexOf("?")+1,t.search.length):"",e=t.pathname?t.pathname.indexOf("/")!=0?"/"+t.pathname:t.pathname:"/",i="";i=r.alt?r.alt:document.all?t.title||t.innerText||t.innerHTML||"":t.title||t.text||t.innerHTML||"";u=this.DCS.setvar_dcssip||u;e=this.DCS.setvar_dcsuri||e;f=this.DCS.setvar_dcsqry||f;i=this.WT.setvar_ti||i;i=this.dcsTrim(i);this.WT.mc_id=this.WT.setvar_mc_id||"";this.WT.sp=this.WT.ad=this.DCS.setvar_dcsuri=this.DCS.setvar_dcssip=this.DCS.setvar_dcsqry=this.WT.setvar_ti=this.WT.setvar_mc_id="";t.attributes.getNamedItem("cid")&&(this.DCSext.wt_linkid=t.attributes.getNamedItem("cid").value);this.dcsMultiTrack("DCS.dcssip",u,"DCS.dcsuri",e,"DCS.dcsqry",this.trimoffsiteparams?"":f,"DCS.dcsref",window.location,"WT.ti","Link:"+i,"WT.dl","1","WT.nv",this.dcsNavigation(n),"DCSext.wtNavigation",this.dcsNavigation(n),"WT.sp","","WT.ad","");this.DCS.dcsref=this.WT.ti=this.WT.dl=this.WT.nv=""}};WebTrends.prototype.dcsMSImageMap=function(n){var t,r;if(n=n||window.event||"",n&&(typeof n.which!="number"||n.which==1)&&(t=this.dcsEvt(n,"AREA"),r=this.dcsEvt(n,"IMG"),t.href&&t.protocol&&t.protocol.indexOf("http")!=-1&&!this.dcsMSLinkTrackException(t))){(t.onclick||t.onmousedown)&&this.dcsMSSetVarCap(t);var u=t.hostname?t.hostname.split(":")[0]:"",f=t.search?t.search.substring(t.search.indexOf("?")+1,t.search.length):"",e=t.pathname?t.pathname.indexOf("/")!=0?"/"+t.pathname:t.pathname:"/",i="";i=r.alt?r.alt:document.all?t.title||t.innerText||t.innerHTML||"":t.title||t.text||t.innerHTML||"";u=this.DCS.setvar_dcssip||u;e=this.DCS.setvar_dcsuri||e;f=this.DCS.setvar_dcsqry||f;i=this.WT.setvar_ti||i;i=this.dcsTrim(i);this.WT.mc_id=this.WT.setvar_mc_id||"";this.WT.sp=this.WT.ad=this.DCS.setvar_dcsuri=this.DCS.setvar_dcssip=this.DCS.setvar_dcsqry=this.WT.setvar_ti=this.WT.setvar_mc_id="";t.attributes.getNamedItem("cid")&&(this.DCSext.wt_linkid=t.attributes.getNamedItem("cid").value);this.dcsMultiTrack("DCS.dcssip",u,"DCS.dcsuri",e,"DCS.dcsqry",this.trimoffsiteparams?"":f,"DCS.dcsref",window.location,"WT.ti","Img Map:"+i,"WT.dl","1","WT.nv",this.dcsNavigation(n),"DCSext.wtNavigation",this.dcsNavigation(n),"WT.sp","","WT.ad","");this.DCS.dcsref=this.WT.ti=this.WT.dl=this.WT.nv=""}};WebTrends.prototype.dcsAnchor=function(n){var t,i,u,r;n=n||window.event||"";n&&(typeof n.which!="number"||n.which==1)&&(t=this.dcsEvt(n,"A"),t.href&&!this.dcsMSLinkTrackException(t)&&(i=t.hostname?t.hostname.split(":")[0]:"",this.dcsIsOnsite(i)&&t.hash&&t.hash!=""&&t.hash!="#"&&(u=t.search?t.search.substring(t.search.indexOf("?")+1,t.search.length):"",r=t.pathname?t.pathname.indexOf("/")!=0?"/"+t.pathname:t.pathname:"/",this.dcsMultiTrack("DCS.dcssip",i,"DCS.dcsuri",r+t.hash,"WT.ti","Anchor:"+t.hash,"WT.dl","1","WT.nv",this.dcsNavigation(n)))))};WebTrends.prototype.dcsMSLinkTrackException=function(n){var t,u,f,i,r;try{if(t=0,this.DCSdir.gTrackExceptions)for(u=this.DCSdir.gTrackExceptions.split(",");t!=1;){if(n.tagName&&n.tagName=="body")return t=1,!1;if(n.className)for(f=String(n.className).split(" "),i=0;i<u.length;i++)for(r=0;r<f.length;r++)if(f[r]==u[i])return t=1,!0;n=n.parentNode}else return!1}catch(e){}};WebTrends.prototype.dcsMSSetVar=function(){var t=dcsSetVar.arguments?dcsSetVar.arguments:arguments,n;if(t.length%2==0)for(n=0;n<t.length;n+=2)t[n].indexOf("WT.")==0?this.dcsMSSetVarValidate(t[n])?this.WT["setvar_"+t[n].substring(3)]=t[n+1]:this.WT[t[n].substring(3)]=t[n+1]:t[n].indexOf("DCS.")==0?this.dcsMSSetVarValidate(t[n])?this.DCS["setvar_"+t[n].substring(4)]=t[n+1]:this.DCS[t[n].substring(4)]=t[n+1]:t[n].indexOf("DCSext.")==0?this.dcsMSSetVarValidate(t[n])?this.DCSext["setvar_"+t[n].substring(7)]=t[n+1]:this.DCSext[t[n].substring(7)]=t[n+1]:t[n].indexOf("DCSdir.")==0&&(this.dcsMSSetVarValidate(t[n])?this.DCSdir["setvar_"+t[n].substring(7)]=t[n+1]:this.DCSdir[t[n].substring(7)]=t[n+1])};WebTrends.prototype.dcsMSSetVarCap=function(n){var r,t;n.onclick?r=n.onclick.toString():n.onmousedown&&(r=n.onmousedown.toString());var u=r.substring(r.indexOf("dcsSetVar(")+10,r.length)||r.substring(r.indexOf("_tag.dcsMSSetVar(")+16,r.length),f=u.substring(0,u.indexOf(");")).replace(/\s"/gi,"").replace(/"/gi,"").replace(/'/gi,""),i=f.split(",");if(i.length!=-1)for(t=0;t<i.length;t+=2)i[t].indexOf("WT.")==0?this.dcsMSSetVarValidate(i[t])?this.WT["setvar_"+i[t].substring(3)]=i[t+1]:this.WT[i[t].substring(3)]=i[t+1]:i[t].indexOf("DCS.")==0?this.dcsMSSetVarValidate(i[t])?this.DCS["setvar_"+i[t].substring(4)]=i[t+1]:this.DCS[i[t].substring(4)]=i[t+1]:i[t].indexOf("DCSext.")==0?this.dcsMSSetVarValidate(i[t])?this.DCSext["setvar_"+i[t].substring(7)]=i[t+1]:this.DCSext[i[t].substring(7)]=i[t+1]:i[t].indexOf("DCSdir.")==0&&(this.dcsMSSetVarValidate(i[t])?this.DCSdir["setvar_"+i[t].substring(7)]=i[t+1]:this.DCSdir[i[t].substring(7)]=i[t+1])};WebTrends.prototype.dcsMSSetVarValidate=function(n){for(var t="DCS.dcssip,DCS.dcsuri,DCS.dcsqry,WT.ti,WT.mc_id",t=t.split(","),i=0;i<t.length;i++)if(t[i]==n)return 1;return 0};WebTrends.prototype.dcsMSNvr=function(){var r,f,n;if(document.cookie.indexOf("WTLOPTOUT=")==-1){var e=new Date,o=new Date(e.getTime()+63072e6),t={name:"WT_NVR",value:"",expiry:"; expires="+o.toGMTString(),path:"; path=/",domain:"; domain="+window.location.hostname},i=this.dcsMSNvrRead(t.name),u=this.dcsMSNvrProcess(i);if(u||this.dcsMSNvrFind(t.name,","))for(r=this.dcsMSNvrCompose(i,t),n=0;n<r.length;n++)document.cookie=r[n];if(u)for(f=document.cookie.indexOf(t.name+"=")!=-1?"1":"2",n=0;n<i.length;n++)i[n][1]&&(this.WT["vt_nvr"+(n+1)]=f)}};WebTrends.prototype.dcsMSNvrRead=function(n){for(var t=[],e=0,h=/,/g,u=this.dcsMSNvrGetCookie(n),f,i;u;){for(f=u.split(":"),i=0;i<f.length;i++){var o=f[i].split("="),r=parseInt(o[0]),s=o[1].replace(h,"|").split("|");typeof t[r]!="object"?t[r]=[s,!1]:t[r][0]=t[r][0].concat(s)}e++;u=this.dcsMSNvrGetCookie(n+e)}return t};WebTrends.prototype.dcsMSNvrFind=function(n,t){for(var r=!1,u=0,i=this.dcsMSNvrGetCookie(n);i;){if(i.indexOf(t)!=-1){r=!0;break}u++;i=this.dcsMSNvrGetCookie(n+u)}return r};WebTrends.prototype.dcsMSNvrGetCookie=function(n){var r=document.cookie.indexOf(n+"="),i,t;return r!=-1?(i=r+n.length+1,t=document.cookie.indexOf(";",i),t==-1&&(t=document.cookie.length),document.cookie.substring(i,t)):null};WebTrends.prototype.dcsMSNvrProcess=function(n){var f=!1,i=0,u=[],e=window.location.pathname,r=e.substring(e.indexOf("/")+1,e.lastIndexOf("/")).toLowerCase(),c={"%09":/\t/g,"%20":/ /g,"%2C":/,/g,"%3B":/;/g},o=new String(r),s,h,t;for(s in c)o=o.replace(c[s],s);if(r=o,r.length>1&&(u=r.split("/",3),i=u.length,r=u.join("/")),n.length>0)if(h=!1,n.length>i){for(t=0;t<n[i][0].length;t++)if(n[i][0][t]==r){h=!0;break}h||(n[i][0][n[i][0].length]=r,n[i][1]=!0,f=!0)}else{for(t=0;t<i+1;t++)typeof n[t]!="object"&&(n[t]=[[t==0?"/":u.slice(0,t).join("/")],!0]);f=!0}else{for(t=0;t<i+1;t++)n[t]=[[t==0?"/":u.slice(0,t).join("/")],!0];f=!0}return f};WebTrends.prototype.dcsMSNvrCompose=function(n,t){for(var f,i,s=[],e=[],r=0,o=!1,u=0;u<n.length&&!o;u++)for(e=n[u][0],f=u+"=",i=0;i<e.length&&!o;i++)f+=(i==0?"":"|")+e[i],(t.name+r).length+t.value.length+f.length+1<=4e3?(t.value.length>0&&i==0&&(t.value+=":"),t.value+=f):t.value.length>0&&(s[r]=t.name+(r||"")+"="+t.value+t.expiry+t.path+t.domain,t.value=u+"="+e[i],++r>9&&(o=!0)),f="";return o||(s[r]=t.name+(r||"")+"="+t.value+t.expiry+t.path+t.domain),s};WebTrends.prototype.dcsMSGetCrumb=function(n,t,i){var r=this.dcsGetCookie(n),u,f;return r!=null&&(u=r.indexOf(t+"="),u!=-1)?(f=r.indexOf(i,u),f!=-1?r.substring(u+t.length+i.length,f):r.substring(u+t.length+i.length,r.length)):null};WebTrends.prototype.dcsTrim=function(n){while(n.substring(0,1)==" ")n=n.substring(1,n.length);while(n.substring(n.length-1,n.length)==" ")n=n.substring(0,n.length-1);return n};_tag=new WebTrends;_tag.dcsGetId();var WT=_tag.WT,DCS=_tag.DCS,DCSext=_tag.DCSext;(function(n){var i={"\\":"\\\\","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"'},t=function(n){var f="",t,r,u;if(typeof n=="string"&&n!=null&&n.length>0)for(t=0;t<n.length;t++)r=n.charAt(t),u=i[r],f+=typeof u=="string"?u:r;return f};n.JSON={};n.JSON.stringify=function(i){var u=typeof i,e,r,o,f;if(u!="object"||i===null)return u=="string"&&(i='"'+t(i)+'"'),String(i);o=[];f=i&&i.constructor==Array;for(e in i)(r=i[e],u=typeof r,u!="undefined"&&u!="function")&&(u=="string"?r='"'+t(r)+'"':u=="object"&&r!==null&&(r=n.JSON.stringify(r)),o.push((f?"":'"'+e+'":')+String(r)));return(f?"[":"{")+String(o)+(f?"]":"}")}})(Adform=window.Adform||{}),function(){function u(n){var t,i;if(n)t=n.width+"x"+n.height;else if(!n&&window.java)try{i=window.java.awt.Toolkit.getDefaultToolkit().getScreenSize();t=i.width+"x"+i.height}catch(r){}return t}function f(n){var t,f,r,i,u;if(n&&n.length>0)f=n["Shockwave Flash"],f&&f.description&&(r=f.description.match(/([0-9]+)(?=\.[0-9]+)/g),t=r[0]&&Number(r[0])==r[0]?r[0]:null);else{try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");t=i.GetVariable("$version")}catch(e){}if(!t)try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");t="WIN 6,0,21,0";i.AllowScriptAccess="always";t=i.GetVariable("$version")}catch(o){}if(!t)try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");t=i.GetVariable("$version")}catch(s){}t&&(u=t.match(/([0-9]+)(?=,[0-9]+,[0-9]+,[0-9]+)/g),t=u[0]&&Number(u[0])==u[0]?u[0]:null)}return t}var t=window;if(!t.Adform||!t.Adform.BrowserInfo){var i=t.screen,n=t.navigator,r=n.plugins;window.Adform=window.Adform||{};window.Adform.BrowserInfo||(window.Adform.BrowserInfo={language:n&&n.language?n.language:n&&n.browserLanguage?n.browserLanguage:"",screenSize:u(i),colorDepth:i?i.colorDepth:"",flashVersion:f(r)})}}(),function(){window.adf=window.adf||{};window.adf.fpc=window.adf.fpc||{setCookie:function(n,t,i,r){var f="",u;i&&(u=new Date,u.setTime(u.getTime()+i*864e5),f="; expires="+u.toGMTString());try{document.cookie=n+"="+t+f+"; path=/; "+(r?"domain="+r:"")}catch(e){}},readCookie:function(n){var u=n+"=",r=[],i,t;try{r=document.cookie.split(";")}catch(f){}for(i=0;i<r.length;i++){for(t=r[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(u)==0)return t.substring(u.length,t.length)}return null},isOptedOut:function(){return this.readCookie("adfoptout")=="1"},readCookieSafely:function(n){return this.isOptedOut()?null:this.readCookie(n)},setCookieSafely:function(n,t,i,r){this.isOptedOut()||this.setCookie(n,t,i,r)},eraseCookie:function(n,t){t?this.setCookie(n,"",-1,t):this.setCookie(n,"",-1)},setFPCookie:function(n,t){this.setCookieSafely("adfcid",n,60,t)},readFPCookie:function(){var n=this.readCookieSafely("adfcid");return typeof n=="undefined"||!n?0:n},getQSParam:function(n,t){var i,r,f,e,u;try{if((i=typeof t!="undefined"&&t?t:location.search,typeof i=="undefined"||!i)||(i[0]=="?"&&(i=i.substring(1)),r=i.split("&"),typeof r=="undefined"||!r))return null;for(f=0;f<r.length;f++)if(e=r[f],typeof e!="undefined"&&e&&(u=e.split("="),u!=null&&u.length>1&&u[0].toLowerCase()==n))return decodeURIComponent(u[1])}catch(o){}return null},processFirstPartyCookie:function(n){var f=this.getQSParam("uid"),i=this.getQSParam("rdir"),e=this.getQSParam("domain"),r=0,t=0,u;this.isOptedOut()?r=3:(t=this.readFPCookie(),t=typeof t!="undefined"&&t?t:f,t&&(this.setFPCookie(t,e),r=!1,u=this.readFPCookie(),r=u&&u==t?1:2));i=typeof i!="undefined"&&i?i.replace("{fpcid}",t).replace("{fpcon}",r):n;i&&this.redirectBack(i)},redirectBack:function(n){n&&(document.location.href=n)},optOutForNumberOfDays:function(n,t){this.setCookie("adfoptout","1",t,n);this.eraseCookie("adfcid",n)},optOut:function(n){this.optOutForNumberOfDays(n,730)}}}(),function(n,t,i){n.TrackingPixel||(n.TrackingPixel={imgs:[],loadPixel:function(n){var r=t.Image?new Image(1,1):i.createElement("img");r.src=n;this.imgs.push(r)}})}(Adform=window.Adform||{},window,document),function(){window.Adform=window.Adform||{};window.Adform.Tracking=window.Adform.Tracking||{};window.Adform.Tracking.Params=window.Adform.Tracking.Params||{};window.Adform.Tracking.Params.Debug="";window.Adform.Tracking.Params.HttpHost="track.adform.net";window.Adform.Tracking.Vars=window.Adform.Tracking.Vars||{};window.Adform.Tracking.Vars.Custom=window.Adform.Tracking.Vars.Custom||{};window.Adform.Tracking.Vars.toString=function(){for(var r="",n="",u="",f=5,i=["ADF__Sale","ADF__OrderID","ADF__TD","ADF__BasketSize","ADF__Email","ADF__FName","ADF__LName","ADF__Addr1","ADF__Addr2","ADF__Phone","ADF__ZIP","ADF__Country","ADF__var1","ADF__var2","ADF__var3","ADF__var4","ADF__var5","ADF__var6","ADF__var7","ADF__var8","ADF__var9","ADF__var10"],t=0;t<i.length;t++)try{r=this[i[t].substring(f)].toString()||window[i[t]].toString()||"";u=r.toLowerCase().indexOf("<insert")>-1?"":encodeURIComponent(r.toString().replace(/\||@@/g,""));n+=u!=""?i[t].substring(f)+"="+u+"|":""}catch(e){}return n!=""&&(n=n.substring(0,n.length-1)),n};window.Adform.BrowserInfo=window.Adform.BrowserInfo||{language:"",screenSize:"",colorDepth:"",flashVersion:""};window.Adform.Tracking={Vars:window.Adform.Tracking.Vars,Params:window.Adform.Tracking.Params,Products:[],Steps:{View:1,Basket:2,Purchase:3},addProduct:function(n){var t={};typeof n.pid!="undefined"&&(t.pid=n.pid);typeof n.productid!="undefined"&&(t.pid=n.productid);typeof n.weight!="undefined"&&(t.weight=n.weight);typeof n.step!="undefined"&&(t.step=n.step);typeof n.name!="undefined"&&(t.pnm=n.name);typeof n.productname!="undefined"&&(t.pnm=n.productname);typeof n.group!="undefined"&&(t.pgr=n.group);typeof n.categoryname!="undefined"&&(t.pgr=n.categoryname);typeof n.categoryid!="undefined"&&(t.cid=n.categoryid);typeof n.productsales!="undefined"&&(t.psl=n.productsales);typeof n.productcount!="undefined"&&(t.pcnt=n.productcount);typeof n.custom!="undefined"&&(t.cvr=n.custom);this.getCustomVars(n,t,"sv",255);this.getCustomVars(n,t,"svn",255);window.Adform.Tracking.Order!=null?(window.Adform.Tracking.Order.itms=window.Adform.Tracking.Order.itms||[],window.Adform.Tracking.Order.itms.push(t)):window.Adform.Tracking.Products.push(t);typeof window.Adform.Tracking.Vars.Order!="undefined"&&window.Adform.Tracking.Vars.Order!=null?(window.Adform.Tracking.Vars.Order.products=window.Adform.Tracking.Vars.Order.products||[],window.Adform.Tracking.Vars.Order.products.push(n)):(window.Adform.Tracking.Vars.Products=window.Adform.Tracking.Vars.Products||[],window.Adform.Tracking.Vars.Products.push(n))},createOrder:function(n){var t={};typeof n.sales!="undefined"&&(t.sl=n.sales);typeof n.orderid!="undefined"&&(t.id=n.orderid);typeof n.email!="undefined"&&(t.email=n.email);typeof n.firstname!="undefined"&&(t.fn=n.firstname);typeof n.lastname!="undefined"&&(t.ln=n.lastname);typeof n.address1!="undefined"&&(t.adr1=n.address1);typeof n.address2!="undefined"&&(t.adr2=n.address2);typeof n.phone!="undefined"&&(t.phn=n.phone);typeof n.zip!="undefined"&&(t.zip=n.zip);typeof n.country!="undefined"&&(t.cntr=n.country);typeof n.basketsize!="undefined"&&(t.bsz=n.basketsize);typeof n.agegroup!="undefined"&&(t.age=n.agegroup);typeof n.gender!="undefined"&&(t.gen=n.gender);typeof n.currency!="undefined"&&(t.cur=n.currency);typeof n.productgroup!="undefined"&&(t.pgr=n.productgroup);typeof n.orderstatus!="undefined"&&(t.ost=n.orderstatus);this.getCustomVars(n,t,"var",10);this.getCustomVars(n,t,"sv",255);this.getCustomVars(n,t,"svn",255);window.Adform.Tracking.Order=t;window.Adform.Tracking.Vars.Order=n},getCustomVars:function(n,t,i,r){var f,e,u;for(f in n)f.toLowerCase().indexOf(i)==0&&(e=f.slice(i.length),u=parseInt(e),u.toString()==e&&u>0&&u<=r&&(t[i+u.toString()]=n[f]))},PointDebug:function(n,t){var i=Adform.Tracking.Params.Debug,r,u,f;i!=""&&(r=-1,u=-1,i!=""&&(r=parseInt(i.substring(0,i.indexOf(",")),10),u=i.substring(i.indexOf(",")+1)),r==t&&(f=window.open("http://www.adform.com/en/LogpointDebug.asp?ttuid="+u+"&q="+encodeURIComponent(n).substring(0,1900),"","toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=1,resizable=1,width=800,height=400,top=0,left=0"),f&&f.focus()))},CheckEscape:function(n){return(n.indexOf("%")!=-1?n:encodeURIComponent(n)).replace(/\+/g,"%2B")},GetQueryVar:function(n){var u,i,t,r;try{for(u=window.location.search.substring(1),i=u.split("&"),t=0;t<i.length;t++)if(r=i[t].split("="),r[0].toLowerCase()==n)return r[1]}catch(f){}return""},CreateIframeElement:function(n,t){try{if("\v"=="v")document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("afterBegin",'<iframe src="'+n+'" width="0" height="0" scrolling="no" frameborder="0" style="border:0px;width:0px;height:0px;position:absolute"><\/iframe>');else if(document.createElement&&document.body&&document.body.appendChild){var i=document.createElement("iframe");i.style.position="absolute";i.style.border="0px";i.style.width="0px";i.style.height="0px";i.src=n;document.body.appendChild(i)}else document.body||(t?++t:t=1,t<50&&window.setTimeout("window.Adform.Tracking.CreateIframeElement('"+n+"', "+t+")",20))}catch(r){}},LoadScript:function(n){if(document.createElement&&document.getElementsByTagName){var t=document.createElement("script"),i=document.getElementsByTagName("head");if(t&&i.length)return t.src=n,i[0].appendChild(t),!0}return!1},Track:function(n,t,i,r){var a=encodeURIComponent(Adform.BrowserInfo.language+"|"+Adform.BrowserInfo.language+"|"+Adform.BrowserInfo.screenSize),v=encodeURIComponent("0|0|"+Adform.BrowserInfo.colorDepth+"|0|"+Adform.BrowserInfo.flashVersion+"|0|0|0|0|0"),f=(document.location.protocol=="https:"?"https://":"http://")+Adform.Tracking.Params.HttpHost,s="",c,h,b,e,o,l;try{s=top.document.referrer}catch(k){s=document.referrer}window.Adform.Tracking.Params.PageName=window.Adform.Tracking.Params.PageName||window.ADFPageName||"";window.Adform.Tracking.Params.Divider=window.Adform.Tracking.Params.Divider||window.ADFdivider||"|";window.Adform.Tracking.Vars.Sale=window.Adform.Tracking.Vars.Sale||window.ADF__Sale||"";window.Adform.Tracking.Vars.OrderID=window.Adform.Tracking.Vars.OrderID||window.ADF__OrderID||"";window.Adform.Tracking.Vars.SubOrders=window.Adform.Tracking.Vars.SubOrders||window.ADF__SubOrders||"";var y=Math.floor(1e12*Math.random()),p=typeof t=="undefined"?"":t,w=typeof i=="undefined"||!i.toLowerCase?window.Adform.Tracking.Vars.toString()+"@@"+encodeURIComponent(window.Adform.Tracking.Vars.SubOrders):i+"@@",u=[];this.PushIfNotEmpty(u,this.JoinIfNotEmpty("ADFPageName",this.CheckEscape(window.Adform.Tracking.Params.PageName)));this.PushIfNotEmpty(u,this.JoinIfNotEmpty("ADFdivider",this.CheckEscape(window.Adform.Tracking.Params.Divider)));this.PushIfNotEmpty(u,this.JoinIfNotEmpty("ADFsysvars",w));this.PushIfNotEmpty(u,this.JoinIfNotEmpty("ord",y));this.PushIfNotEmpty(u,this.JoinIfNotEmpty("Set1",a));this.PushIfNotEmpty(u,this.JoinIfNotEmpty("Set2",v));this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("CPref",s));this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("iprodgrp",window.Adform.Tracking.Vars.InterestProductGroup));this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("iprod",window.Adform.Tracking.Vars.InterestProduct));this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("iprodwght",window.Adform.Tracking.Vars.InterestProductWeight));c=e;typeof r=="undefined"||r==""?(u.push("ADFtpmode=2"),this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("ADFsale",window.Adform.Tracking.Vars.Sale)),this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("ADForderid",window.Adform.Tracking.Vars.OrderID)),this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("ADFSubOrders",window.Adform.Tracking.Vars.SubOrders))):this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("rdir",r));h=!0;for(b in window.Adform.Tracking.Vars.Custom)h=!1;try{this.PushIfNotEmpty(u,this.JoinIf("adfcustvars",encodeURIComponent(window.Adform.JSON.stringify(window.Adform.Tracking.Vars.Custom)),function(){return!h}));this.PushIfNotEmpty(u,this.JoinIf("ecpr",encodeURIComponent(window.Adform.JSON.stringify(window.Adform.Tracking.Products)),function(){return window.Adform.Tracking.Products.length>0}));this.PushIfNotEmpty(u,this.JoinIf("itm",encodeURIComponent(window.Adform.JSON.stringify(window.Adform.Tracking.Order)),function(){return window.Adform.Tracking.Order!=null}));this.PushIfNotEmpty(u,this.JoinAndEncodeIfNotEmpty("loc",window.location.href.substring(0,Math.min(99,window.location.href.length))))}catch(k){}e=n?f+"/Serving/TrackPoint/?pm="+n+"&lid="+p+"&"+u.join("&"):f+"/Banners/Invisible.gif";o=!1;try{o=!this.LoadScript(e)}catch(k){o=!0}o&&(l=typeof Image=="undefined"?document.createElement("img"):new window.Image,l.src=c);try{this.PointDebug(decodeURIComponent(e),n)}catch(k){}if(this.GetQueryVar("adfcm")!="")try{window.Adform.CMData=window.Adform.CMData||{};window.Adform.CMData.protocolAndHost=f;window.Adform.CMData.hashKey=this.GetQueryVar("adfhash");document.write('<script type="text/javascript" src="'+f+'/logpoint/utils/ADFClickMap.js"><\/script>')}catch(k){}},JoinIf:function(n,t,i){return i()?n+"="+t:""},JoinIfNotEmpty:function(n,t){return this.JoinIf(n,t,function(){return t!=null&&t!=""})},JoinAndEncodeIfNotEmpty:function(n,t){return this.JoinIf(n,encodeURIComponent(t),function(){return t!=null&&t!=""})},PushIfNotEmpty:function(n,t){t!=null&&t!=""&&n.push(t)},TrackClean:function(n,t,i,r){this.Track(n,t,i,r);Adform.Tracking.Vars.var1="";Adform.Tracking.Vars.var2="";Adform.Tracking.Vars.var3="";Adform.Tracking.Vars.var4="";Adform.Tracking.Vars.var5="";Adform.Tracking.Vars.var6="";Adform.Tracking.Vars.var7="";Adform.Tracking.Vars.var8="";Adform.Tracking.Vars.var9="";Adform.Tracking.Vars.var10="";Adform.Tracking.Vars.Sale="";Adform.Tracking.Vars.OrderID="";Adform.Tracking.Vars.SubOrders="";Adform.Tracking.Products=[];Adform.Tracking.Order=null}};window.Adform.Tracking.fpc=window.adf.fpc||{};window.adf=window.Adform.Tracking;window.adf.track=window.Adform.Tracking.TrackClean;window.adf.createItem=window.adf.createOrder;window.adf.addSubItem=window.adf.addProduct}(),function(n,t){"use strict";var i=0,u=!1,e=!1,r="hide",h="disable",c="item-disable",b=".overlay-item-disable",k=".spinner-page",l=".spinner",f=".alert-container",a=".general-error-message-container",d=".alert-help-message-container",v=".alert-info-message-container",y=".summary-message",o=".action-options",g=".action-options-add-alert",s=".add-alert",p=".add-alert-container",w=".alert-list-container";t.Alert.Index={Model:{},Url:{},Resources:{},init:function(){var t=this,h=n(f),l=h.find(o),c=l.find(s),y=h.find(w),d=h.find(v),b=h.find(p);this.showContainer(!1,n(k));y.children("ul").children("li").size()>0&&this.showContainer(!0,y);this.showContainer(!0,l);i=t.Model.NumberOfRemainingAlerts;this.showAddAlertLinkBaseOnRemainingAlerts();this.showContainer(!0,d);c.on("click",function(n){n.preventDefault();e===!0&&(t.showContainer(!1,h.find(a)),e=!1);t.showAddAlertContainer(t.Model.SubscriptionId)});c.on("UpdatePageAfterAddingAlert",function(f,o){f.stopPropagation!==undefined&&f.stopPropagation();b.addClass(r).children().remove();u=!1;o.success===!1?(t.showErrorMessage(!0,t.Resources.ErrorMessageWhenAddingAlert),e=!0):(n(w).removeClass(r).children("ul").append(o),i--);t.disableAlertLink(!1);t.showAddAlertLinkBaseOnRemainingAlerts()});c.on("UpdatePageAfterDiscardAddingAlert",function(n){n.stopPropagation!==undefined&&n.stopPropagation();b.addClass(r).children().remove();u=!1;t.disableAlertLink(!1);t.showAddAlertLinkBaseOnRemainingAlerts()});c.on("UpdatePageAfterRemovingAlert",function(n){n.stopPropagation!==undefined&&n.stopPropagation();i++;t.showAddAlertLinkBaseOnRemainingAlerts()});c.on("HideContainerAndShowGeneralErrorPage",function(n){n.stopPropagation!==undefined&&n.stopPropagation();t.hideContainerAndShowErrorMessage(!0,h.children(),t.Resources.GenericError)})},showAddAlertLinkBaseOnRemainingAlerts:function(){var t=this,o=n(f),s=o.find(v),r=o.find(d),e=s.find(y);i<=0?(this.showContainer(!1,r),this.showAddAlertLink(!1)):i===t.Model.MaxNumberOfAlerts?(this.showContainer(!0,r),u||this.showAddAlertLink(!0)):(this.showContainer(!1,r),u||this.showAddAlertLink(!0));i===1?e.text(t.Resources.OneRemainingAlertMessage):i===0?e.text(t.Resources.NoRemainingAlertMessage.replace("{0}",t.Model.MaxNumberOfAlerts)):e.text(t.Resources.RemainingAlertMessage.replace("{0}",i))},showAddAlertLink:function(t){this.showContainer(t,n(f).find(o).find(s))},showAddAlertContainer:function(t){var i=this,c=n(f),h=c.find(p),a=c.find(o).find(s).find(l);this.disableAlertLink(!0);u=!1;auxPost(i.Url.AddAlertUrl,function(n){n?(i.showContainer(!1,a),i.showAddAlertLink(!1),h.html(n).removeClass(r),u=!0):(e=!0,i.hideContainerAndShowErrorMessage(!0,h,i.Resources.GenericError),i.disableAlertLink(!1))},function(){e=!0;i.hideContainerAndShowErrorMessage(!0,h,i.Resources.GenericError);i.disableAlertLink(!1)},{subscriptionId:t})},disableAlertLink:function(t){var r=n(f).find(o).find(g),u=r.find(b),i=r.find(s),e=i.find(l);t?(u.addClass(c),i.addClass(h),this.showContainer(!0,e)):(u.removeClass(c),i.removeClass(h),this.showContainer(!1,e))},hideContainerAndShowErrorMessage:function(n,t,i){this.showContainer(!n,t);n?this.showErrorMessage(!0,i):this.showErrorMessage(!1)},showErrorMessage:function(t,i){var u=n(f).find(a);t?(u.find(y).text(i),u.removeClass(r)):u.addClass(r)},showContainer:function(n,t){n?t.removeClass(r):t.addClass(r)}}}(jQuery,this),function(n,t){"use strict";var u="hide",l="original-value",r=".threshold-section",f="label[for='Alert_Threshold']",e="label[for='Alert_EmailRecipient2']",w="input[name='Threshold']",s="item-disable",b="data-val-number",k=".overlay-item-disable",a="type-selector",d=".alert-item-",o=".form-element",i=".alert-form-container > form",h=".save",v=".discard",c=".type-selector",y=".save-spinner",p=".discard-spinner";t.Alert.Form={Model:{},Resources:{},Callback:{},init:function(){var t=this,r="."+t.Model.AddAlert,u="."+t.Model.UpdateAlert,f=n(i);n.each(["data-val-required","data-val-length","data-val-regex","data-val-combinedlength","data-val-equalto"],function(t,i){n("["+i+"]").each(function(t,r){var u=n(r);u.attr(i,MsPortalFx.Base.Utilities.htmlDecode(u.attr(i)))})});t.Model.AddOrUpdateAction===t.Model.AddAlert?t.initAddAlert(r):t.Model.AddOrUpdateAction===t.Model.UpdateAlert?t.initUpdateAlert(u,t.Model.AlertNotificationId):n(this.Callback.AddAlertButtonSelectorStr).trigger(this.Callback.HideContainerAndShowGeneralErrorPage)},initAddAlert:function(t){var s=this,u=n(i+t),b=u.find(o),w=u.find(h+t),k=u.find(v+t),g=u.find(y),l=u.find(c),d;this.updateDataValNumber(u);b.on("change keyup",function(){var t=n(this),o=t.parents(i);t.hasClass(a)&&s.updateThresholdSection(t,o.find(f),o.find(r),o.find(e));d=MsPortalFx.UI.Validation.validateContainer(u);w.attr("disabled",!d)});s.updateThresholdSection(l,l.parents(i).find(f),l.parents(i).find(r),l.parents(i).find(e));l.children("option").length<=1&&l.prop("disabled",!0);w.on("click",function(t){t.preventDefault();s.disableFieldsContainerAndShowSpinner(!0,u,g);u.find("button").prop("disabled",!0);s.removeClickHandlerOnAddAlert(w,k,b);l.prop("disabled",!1);auxAjax({url:u.attr("action"),type:"POST",data:u.serialize(),success:function(t){n(s.Callback.AddAlertButtonSelectorStr).trigger(s.Callback.UpdatePageAfterAddingAlert,t)},error:function(){n(s.Callback.AddAlertButtonSelectorStr).trigger(s.Callback.UpdatePageAfterAddingAlert,!1)}})});k.on("click",function(t){t.preventDefault();var i=u.find(p);s.removeClickHandlerOnAddAlert(w,k,b);n(s.Callback.AddAlertButtonSelectorStr).trigger(s.Callback.UpdatePageAfterDiscardAddingAlert)})},removeClickHandlerOnAddAlert:function(n,t,i){n.off("click");t.off("click");i.off("change keyup")},initUpdateAlert:function(t,u){var s=this,w=d+u,k=t+w,a=n(i+k),nt=a.find(o),g=a.find(h+k),rt=a.find(v+k),it=a.find(y),tt=a.find(c),b=n(s.Callback.AlertListItemExpandAlertSummary.replace("{0}",w));this.updateDataValNumber(a);a.find(c).each(function(){var t=n(this),u=t.parents(i);s.updateThresholdSection(t,u.find(f),u.find(r),u.find(e));t.children("option").length<=1&&t.prop("disabled",!0)});this.addEventToFormElements(nt,a,g);g.on("click",function(t){t.preventDefault();nt.off("change keyup");a.find("button").prop("disabled",!0);b.trigger(s.Callback.DisableCurrentListItem,{disable:!0,alertItemClassStrSelector:w});s.disableFieldsContainerAndShowSpinner(!0,a,it);b.trigger(s.Callback.ShowErrorMessageOnAlertListItem,{showErrorMessage:!1,alertItemClassStrSelector:w});tt.children("option").length<=1&&tt.prop("disabled",!1);auxAjax({url:a.attr("action"),type:"POST",data:a.serialize(),success:function(t){t.success===!0?(b.trigger(s.Callback.CollapseAlertListItemDetail),b.trigger(s.Callback.UpdateAlertListItemSummary,{formSelector:a,threshold:t.threshold,alertItemClassStrSelector:w}),a.find(o).each(function(){var t=n(this);t.data(l,t.val())})):b.trigger(s.Callback.ShowErrorMessageOnAlertListItem,{showErrorMessage:!0,errorMessage:s.Resources.ErrorMessageWhenUpdatingAlert,alertItemClassStrSelector:w});s.addEventToFormElements(nt,a,g);tt.children("option").length<=1&&tt.prop("disabled",!0);b.trigger(s.Callback.DisableCurrentListItem,{disable:!1,alertItemClassStrSelector:w});s.disableFieldsContainerAndShowSpinner(!1,a,it);a.find("button").prop("disabled",!1);s.validateUpdateAlertForm(a,nt,g)},error:function(){n(s.Callback.AddAlertButtonSelectorStr).trigger(s.Callback.HideContainerAndShowGeneralErrorPage)}})});rt.on("click",function(t){t.preventDefault();var r=n(i+k),u=r.find(p);b.trigger(s.Callback.ShowErrorMessageOnAlertListItem,{showErrorMessage:!1,alertItemClassStrSelector:w});s.disableFieldsContainerAndShowSpinner(!0,r,u);s.restoreFormFieldOriginalValues(r);s.disableFieldsContainerAndShowSpinner(!1,r,u);b.trigger(s.Callback.CollapseAlertListItemDetail)});g.on("RestoreFormFieldOriginalValues",function(t,i){t.stopPropagation!==undefined&&t.stopPropagation();s.restoreFormFieldOriginalValues(n(i))});g.on("DisableFormButtons",function(t,r){var u=n(r.currentAlertListItemSelector).find(i+k),f=u.find(o),e=u.find(h+k);u.find("button").prop("disabled",r.disable);r.disable===!0?f.off("change keyup"):(s.addEventToFormElements(f,u,e),s.validateUpdateAlertForm(u,f,e))})},addEventToFormElements:function(t,u,o){var s=this;t.on("change keyup",function(){var h=n(this),c=h.parents(i);h.hasClass(a)&&s.updateThresholdSection(h,c.find(f),c.find(r),c.find(e));s.validateUpdateAlertForm(u,t,o)})},restoreFormFieldOriginalValues:function(t){var u=this,i=t.find(o),s=t.find(h);i.each(function(){var t=n(this);t.val(t.data(l))});u.updateThresholdSection(t.find(c),t.find(f),t.find(r),t.find(e));this.validateUpdateAlertForm(t,i,s)},validateUpdateAlertForm:function(t,i,f){var e,o=!1;e=MsPortalFx.UI.Validation.validateContainer(t);e?(i.each(function(){var t=n(this);t.parents(r).hasClass(u)||t.val()==t.data(l)||(o=!0)}),f.attr("disabled",!o)):f.attr("disabled",!0)},updateThresholdSection:function(t,i,r,f){var e=this,s=t.find("option:selected").val(),o;switch(s){case e.AlertCategoryType.MonetaryCredits:i.text(e.Resources.AmountRemaining);f.text(e.Resources.EmailRecipient2);o=!0;break;case e.AlertCategoryType.BillingTotal:i.text(e.Resources.AmountSpent);f.text(e.Resources.EmailRecipient2);o=!0;break;case e.AlertCategoryType.SubscriptionBalance:i.text(e.Resources.AmountRemaining);f.text(e.Resources.EmailRecipient2);o=!0;break;case e.AlertCategoryType.ReloadExpiry:f.text(e.Resources.PartnerEmail);o=!1;break;case e.AlertCategoryType.ReloadBalance:f.text(e.Resources.PartnerEmail);o=!1;break;default:n(this.Callback.AddAlertButtonSelectorStr).trigger(this.Callback.HideContainerAndShowGeneralErrorPage)}o===!0?r.removeClass(u):r.addClass(u)},updateDataValNumber:function(n){n.find(w).attr(b,this.Resources.InvalidAmount)},disableFieldsContainerAndShowSpinner:function(n,t,i){var r=t.children(k);n?(t.addClass(s),r.addClass(s)):(t.removeClass(s),r.removeClass(s));this.showSpinner(n,i)},showSpinner:function(n,t){n?t.removeClass(u):t.addClass(u)}}}(jQuery,this),function(n,t){"use strict";var e=!1,o=!1,r="hide",c="hiddenVisibility",u="active",w="Threshold",l="li.threshold-column",b="Type",a="item-disable-remove",f="item-disable",k=".overlay-item-disable",d="../../Content/Images/fx.balloonicon.icon-help.png",g="../../Content/Images/fx.balloonicon.icon-help-hvr.png'",i="li.alert-list-item-container",s=".alert-item-",v=".expand-alert",nt="li.expand-alert-summary",y=".expand-alert-detail",p="a.remove-notification",tt=".spinner",h=".error-message-container",it=".summary-message",rt=".form-element",ut=".summary",ft=".accept",et=".reject",ot=".remove-alert-confirmation-message",st=".status-description",ht=".type-selector";t.Alert.ListItem={Model:{},Url:{},Resources:{},init:function(){var t=this,f=n(i),r=f.find(nt),e=n(i+s+t.Model.NotificationId),c=e.find(l);this.initializeBalloons();this.initRemoveAlertClickEvent(t.Model.NotificationId);t.updateThresholdFieldVisibility(t.Model.AlertType,c);r.off("click");r.on("click",function(i){i.preventDefault();var r=n(this);r.toggleClass(u);r.parents(v).next(y).toggleClass(u,function(){var i=n(this);i.hasClass(u)||n(i.find(t.Callback.SaveAlertButtonSelectorStr)).trigger(t.Callback.RestoreFormFieldOriginalValues,i.find("form"))})});r.off("CollapseAlertListItemDetail");r.on("CollapseAlertListItemDetail",function(t){t.stopPropagation();n(this).toggleClass(u).parents(v).next(y).toggleClass(u)});r.off("UpdateAlertListItemSummary");r.on("UpdateAlertListItemSummary",function(r,u){var e;r.stopPropagation();var o=n(i+u.alertItemClassStrSelector),s=n(u.formSelector),h=s.find(rt),f,c;for(e=0;e<h.length;++e)f=n(h[e]),c=f.attr("name")==w?u.threshold:f.attr("name")==b?f.find("option:selected").text():f.val(),o.find("."+f.attr("name")).text(c);o.find(st).text(t.Resources.NotSent);t.updateThresholdFieldVisibility(s.find(ht).val(),o.find(l))});r.off("DisableCurrentListItem");r.on("DisableCurrentListItem",function(r,u){r.stopPropagation();var f=n(i+u.alertItemClassStrSelector);t.disableListItem(u.disable,f)});r.off("ShowErrorMessageOnAlertListItem");r.on("ShowErrorMessageOnAlertListItem",function(r,u){r.stopPropagation();var f=n(i+u.alertItemClassStrSelector).find(h);u.showErrorMessage===!1&&o===!0?(o=!1,t.showErrorMessage(!1,f)):u.showErrorMessage===!0&&(o=!0,t.showErrorMessage(!0,f,u.errorMessage))})},initRemoveAlertClickEvent:function(t){var f=this,c=s+t,o=n(i+c),u=o.find(ot),l=o.find(h);n(i).find(p+c).on("click",function(n){n.preventDefault();e===!0&&(e=!1,f.showErrorMessage(!1,l));f.disableListItem(!0,o);u.removeClass(r)});u.find(ft).on("click",function(n){n.preventDefault();u.addClass(r);f.removeAlert(t)});u.find(et).on("click",function(n){n.preventDefault();u.addClass(r);f.disableListItem(!1,o)})},removeAlert:function(t){var r=this,f=s+t,c=n(i),u=n(i+f),o=u.children(tt),l=u.find(h),a=c.find(p+f);this.disableListItemOnRemoveAlert(!0,u,o);auxPost(r.Url.RemoveAlertUrl,function(t){t.success===!0?(u.remove(),n(r.Callback.AddAlertButtonSelectorStr).trigger(r.Callback.UpdatePageAfterRemovingAlert,!0)):(r.disableListItemOnRemoveAlert(!1,u,o),r.disableListItem(!1,u),r.showErrorMessage(!0,l,r.Resources.ErrorMessageWhenRemovingAlert),e=!0)},function(){n(r.Callback.AddAlertButtonSelectorStr).trigger(r.Callback.HideContainerAndShowGeneralErrorPage)},{notificationId:t})},disableListItemOnRemoveAlert:function(t,i,r){var u=this;t?i.addClass(a):i.removeClass(a);n(i.find(u.Callback.SaveAlertButtonSelectorStr)).trigger(u.Callback.DisableFormButtons,{disable:t,currentAlertListItemSelector:i});this.showSpinner(t,r)},disableListItem:function(n,t){var i=t.find(ut),r=t.children(k);n?(i.addClass(f),r.addClass(f)):(i.removeClass(f),r.removeClass(f))},updateThresholdFieldVisibility:function(n,t){var i=this;n===i.AlertCategoryType.ReloadBalance||n===i.AlertCategoryType.ReloadExpiry?t.addClass(c):t.removeClass(c)},showSpinner:function(n,t){n?t.removeClass(r):t.addClass(r)},showErrorMessage:function(n,t,i){n?(t.find(it).text(i),t.removeClass(r)):t.addClass(r)},initializeBalloons:function(){n(".status-help-balloon").fxBalloonIcon({url:{icon:d,iconHover:g},altText:this.Resources.Help,balloonOptions:{title:null,content:this.Resources.AlertStatusHelp}})}}}(jQuery,this),function(n,t){"use strict";t.CustomerFeedback={Url:{},init:function(){var r=this,i=n(".feedback textarea"),t=n("#customer-feedback-container");n(".customer-feedback-complete button").on("click",function(){auxPost(r.Url.PostFeedbackUrl,function(){},function(){},{url:document.location.href,feedback:i.val()});t.removeClass("shown")});n(".feedback-link").on("click",function(){i.val("");t.addClass("shown")});n(".customer-feedback-close button").on("click",function(){t.removeClass("shown")})}}}(jQuery,this),function(n,t){"use strict";t.Address.Change={Model:{},Resources:{},_FormSelector:"#editAddressForm",_WizardContent:"#wizard-content",_Wizard:".wizard",_MpcsContainer:"#the-mpcs-container",_PcsAddress:"#the-pcs-address",_MostRecentHeight:null,_HideProgress:!0,_PcsDomain:"",_IsValid:!1,_WizardPadding:80,_Deferred:null,_PerformingNext:!1,init:function(){var i=this,r;i._HideProgress=!0;i.hideWizardShowProgress();t.addEventListener?(this._addEventListenerFunction=function(n){i._onMessageFromPcs.call(i,n)},t.addEventListener("message",this._addEventListenerFunction,!1)):t.attachEvent&&(this._attachEventFunction=function(n){i._onMessageFromPcs.call(i,n)},t.attachEvent("onmessage",this._attachEventFunction));r=i.Resources.iframeUrl.match(/^https?:\/\/[^:\/]*/i);r&&r.length===1&&(i._PcsDomain=r[0]);i.loadPcs();i.setupValidateOnTextChange();n(i._FormSelector).valid()?i._IsValid=!0:i._isValid=!1;n("#wizard-button-complete").unbind("click");n("#wizard-button-complete").bind("click.cs",function(){dcsSetVar("WT.z_iLinks","Next Screen Button","WT.z_iLinks_actionoffer","Next-Continue","WT.z_iLinks_targetcampaign","src-acctchangeaddress");i.hideWizardShowProgress();i.validateData()});n("#wizard-button-close").unbind("click.ed");n("#wizard-button-close").bind("click.ed",function(){dcsSetVar("WT.z_iLinks","Close Screen Button","WT.z_iLinks_actionoffer","Cancel-Abandon","WT.z_iLinks_targetcampaign","src-acctchangeaddress");n(this).unbind("click.ed");i._MostRecentHeight=null});n(i._FormSelector).bind("submit.ed",function(n){n.preventDefault()});n("#Phone").keydown(function(t){n.inArray(t.keyCode,[8,9,27,13,110,190])!==-1||t.keyCode==65&&t.ctrlKey===!0||t.keyCode>=35&&t.keyCode<=39||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()})},loadPcs:function(){var t=this,i=n(t._PcsAddress,n(t._MpcsContainer));i.attr("src",t.Resources.iframeUrl);i.load(function(){setTimeout(function(){t._HideProgress&&(t.showWizardHideProgress(),t._HideProgress=!1)})})},showWizardHideProgress:function(){n.wizard().hideProgress();n(this._MpcsContainer).show();n.wizard().enableComplete()},hideWizardShowProgress:function(){n(this._MpcsContainer).hide();n.wizard().showProgress();n.wizard().disableComplete()},pcsPerformNext:function(){var u=this,t,i,r;return this._PerformingNext!==!0?(this._PerformingNext=!0,this._Deferred=n.Deferred(),t=this._Deferred.promise(),t.always(function(){u._PerformingNext=!1}),i={Method:"Next",Callback:"NextCallback",Parameter:""},r=JSON.stringify(i),this._postMessageToPCS(r),t):this._Deferred?this._Deferred.promise():void 0},_postMessageToPCS:function(t){var i=n(this._PcsAddress,n(this._MpcsContainer))[0].contentWindow;i&&i.postMessage(t,"*")},_handlePcsMessage:function(n){n.method==="pcs_onheightchange"?this._onPcsHeightChange(n):n.method==="pcs_onsuccess"?this._onPcsSuccess(n):n.method==="pcs_onpagerenderednotify"&&this._onPcsRenderedNotify(n)},_handlePcsApiCallback:function(n){this.PCSAPIReturnHandler[n.method]&&this.PCSAPIReturnHandler[n.method](this,n)},_onPcsRenderedNotify:function(n){n.errorcode&&n.errorcode!==""&&this._Deferred&&this._Deferred.reject();this._initialHeightSet=!1;this._PerformingNext=!1;this.showWizardHideProgress()},PCSAPIReturnHandler:{NextCallback:function(n,t){t.Result==="invalid"&&(n._deferred&&n._deferred.reject(),n.showWizardHideProgress())}},_onPcsSuccess:function(t){var i=this,t=n.parseJSON(t.formdata),r="",u;t.AddressLine2&&(r=t.AddressLine2);u={Street1:t.AddressLine1,City:t.City,State:t.State,Postalcode:t.Zipcode,FriendlyName:"",UnitNumber:"",Street2:r,Street3:"",District:t.District,PhoneNumber:n("#Phone",n(this._MpcsContainer)).val(),Email:n("#Email",n(this._MpcsContainer)).val(),CompanyName:n("#CompanyName",n(this._MpcsContainer)).val(),FirstName:t.FirstName,LastName:t.LastName,CountryCode:i.Model.CountryCode,Id:i.Model.Id};n.ajax({url:n(i._FormSelector).attr("action"),type:"POST",data:JSON.stringify(u),dataType:"json",beforeSend:function(n){n.setRequestHeader("Content-Type","application/json")},success:function(t){if(t.success==!0){var r=n.wizard();n.wizard().waitToAdvance(0);n("#wizard-button-complete").unbind("click.cs");n("#wizard-button-close").unbind("click.ed");n("#cancel-subscription form").unbind("submit.cs");r.complete();i._MostRecentHeight=null;t.returnUrl&&(document.location=t.returnUrl)}else i._HideProgress=!0,i.loadPcs(),n.wizard().showErrorInNotificationBar(i.Resources.GenericError,null)},error:function(){i._HideProgress=!0;i.loadPcs();n.wizard().showErrorInNotificationBar(i.Resources.GenericError,null)}});i._PerformingNext=!1},_onPcsHeightChange:function(t){if(!t||t.height!==this._MostRecentHeight){this._MostRecentHeight=t.height;var i=t.height+this._WizardPadding;n(this._Wizard).height(i);n(this._WizardContent).height(i);n(this._PcsAddress,n(this._MpcsContainer)).height(t.height)}},_onMessageFromPcs:function(t){var i="";if("domain"in t&&(i=t.domain),"origin"in t&&(i=t.origin),this._PcsDomain&&i.toLowerCase()===this._PcsDomain.toLowerCase()){var r=n.parseJSON(t.data),u=r.type?r.type:"",f=n.parseJSON(r.data);typeof u=="string"&&(u.toLowerCase()==="message"?this._handlePcsMessage(f):u.toLowerCase()==="api_return"&&this._handlePcsApiCallback(f))}},validateData:function(){this.pcsPerformNext()},getTextBoxValueChanged:function(t,i){var r=this,f=n.Deferred(),u=n(t);return u.unbind().die(),u.keyup(function(u){r.timerFunction!=null&&window.clearTimeout(r.timerFunction);var f=u.keyCode!=9?t:null;return r.timerFunction=window.setTimeout(function(){n(r._FormSelector).valid()?r._IsValid=!0:r._isValid=!1},i),!0}),f},setupValidateOnTextChange:function(){this.getTextBoxValueChanged(n("#Email",n(this._MpcsContainer)),200);this.getTextBoxValueChanged(n("#Phone",n(this._MpcsContainer)),200);this.getTextBoxValueChanged(n("#CompanyName",n(this._MpcsContainer)),200)}}}(jQuery,this),function(n,t){"use strict";var i="#tenantPicker";t.Tenant.SelectList={Model:{},Url:{},init:function(){var r=this;n(t).ready(function(){n(i).itemListPicker({url:r.Url.updateTenantSelectedUrl,urlOnError:r.Url.urlOnError,list:r.Model.tenantList})})}}}(jQuery,this)