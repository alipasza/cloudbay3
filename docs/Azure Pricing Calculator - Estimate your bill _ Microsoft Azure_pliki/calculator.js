(function(n,t){var s,h=0,i=1,r=!1,u=!1,f=!1,e=0,o=0;t(function(){var n={websites:["free","shared","basic","standard"],mobile:["free","basic","standard"],cache:["basic","standard","premium"],"redis-cache":["basic","standard"],"notification-hubs":["free","basic","standard"],"virtual-machines-windows":["basic","standard"],"virtual-machines-linux":["basic","standard"],"virtual-machines-sql-server":["basic","standard"],"virtual-machines-biztalk-server":["basic","standard"],"virtual-machines-oracle-software":["basic","standard"],expressroute:["exchange","network"],"biztalk-services":["standard","free","developer","basic","premium"],storage:["lrs","zrs","grs","ragrs"],database:["basic","standard","premium"],hdinsight:["hadoop","hbase","storm"],"machine-learning":["studio","api-service"],"cloud-services":["basic","standard"],"app-service":["free","shared","basic","standard","premium"]};t.each(n,function(n,i){t.each(i,function(i,r){t(".buy-configure-"+n+"-"+r+" .service-tier-selector ."+r).addClass("active");i!==0&&t(".buy-configure-"+n+"-"+r+" .slider-div").data("excludefromtotal",!0)})});t(".service-tier-selector a").click(function(i){i.preventDefault();var r=t(this).parent().data("service"),u=n[r],f=t(this).attr("class").split(" active")[0];t.each(u,function(n,i){var u=".buy-configure-"+r+"-"+i;i==f?(t(u+" .slider-div").data("excludefromtotal",!1),t(u).show()):(t(u+" .slider-div").data("excludefromtotal",!0),t(u).hide())});refreshPricing()});t(".slider-div").each(function(){var n=initalizeMetrics(this);t(this).slider({orientation:"horizontal",range:"min",min:n.setMin,max:n.setMax,step:n.setStep,value:0,slide:function(i,r){n.pricePerTier=t(this).data("price");t(this).data("steplocation",r.value);n.currentStep=t(this).data("steplocation");var u=r.value,f=n.setType;t(this).attr("data-conversionfactor")&&(u=u/t(this).data("conversionfactor"),f=t(this).data("conversionunit"));t(this).parent().children(".slider-amount").html("<span class='current-slider-amount'>"+localizeNumber(u)+"<\/span><span class='slider-type'>"+f+"<\/span>");t(this).data("currentprice",updatePricing(n));refreshPricing()}})});t(".selector-abbr li").click(function(n){var s,l;if(n.preventDefault(),t(this).hasClass("active")!=!0){var u=t(this).parent().data("meter"),r="#"+t(this).parent().parent().parent().attr("id"),h=r+" .selector-name ."+t(this).attr("class"),i=r+" .slider-div",a=t(this).attr("class");if(u&&(i+="[data-name$='"+u+"']",h=r+" .selector-name[data-meter='"+u+"'] ."+t(this).attr("class")),u?(t(r+' .selector-abbr[data-meter="'+u+'"] > li').removeClass("active"),t(r+' .selector-name[data-meter="'+u+'"] > li').removeClass("active")):(t(r+" .selector-abbr > li").removeClass("active"),t(r+" .selector-name > li").removeClass("active")),t(this).addClass("active"),t(h).addClass("active"),t(i).data("price",t(this).data("price")),t(i).data("hourly",t(this).data("hourly")),t(i).data("selector-current",a),t(this).attr("data-conversionfactor")&&(t(i).data("conversionfactor",t(this).data("conversionfactor")),t(i).data("conversionunit",t(this).data("conversionunit"))),t(this).attr("data-min")&&t(this).attr("data-max")&&t(this).attr("data-step")){var o=t(this).data("min"),f=t(this).data("max"),c=t(this).data("step"),e=t(i).slider("value");t(i).data("min",o);t(i).data("max",f);t(i).data("step",c);t(i).slider("option",{min:o,max:f,step:c});e=e>f?f:o;t(i).slider("option","value",e);t(i).slider("option","slide").call(t(i),null,{handle:t(".ui-slider-handle",t(i)),value:e})}s=initalizeMetrics(i);l=updatePricing(s,0,s.currentlySelected);t(i).data("currentprice",l);refreshPricing()}else t(this).data("toggle")===!0&&t(this).parent().find(".default").click()});t(".wa-dropdown-currency").change(function(){changeCurrency(t(this).val());refreshPricing()});s="."+currencyMetrics.name;t(".current-currency").html(t(s).html());t("#currency_icons li").removeAttr("style");t(s).css("background-color","#f8f8f8");refreshPricing();t(".pricing-selection li").click(function(n){n.preventDefault();t(this).hasClass("current")||t(this).hasClass("ctrl-buy-configure-prepay")||(t(".pricing-selection li").removeClass("current"),t(this).addClass("current"),h=t(this).data("commitmenttier"),refreshPricing(),t(this).hasClass("ctrl-buy-configure-payg")?(u=!1,f=!1,r=!1,t(".ctrl-buy-configure-prepay").removeClass("current-prepay").css("visibility","hidden")):(t(this).hasClass("ctrl-buy-commitment6")?(u=!0,f=!1):(u=!1,f=!0),switchToPayAsYouGo=!0,t(".ctrl-buy-configure-prepay").css("visibility","visible"),refreshPricing()));t(this).hasClass("ctrl-buy-configure-prepay")&&!t(".ctrl-buy-configure-payg.current").length&&(r=r?!1:!0,t(this).toggleClass("current-prepay"));refreshPricing()})});initalizeMetrics=function(n){var n=t(n);return{setMin:n.data("min"),setMax:n.data("max"),setType:n.data("type"),setStep:n.data("step"),pricingTier:n.data("tier"),pricePerTier:n.data("price"),currentValue:n.data("currentprice"),currentStep:n.data("steplocation"),currentName:n.data("name"),currentlySelected:n.data("selector-current"),excludeFromCommitment:n.data("excludefrommc"),excludeFromTotal:n.data("excludefromtotal"),basePrice:n.data("base")}};updatePricing=function(n){var c=!0,r,i,e,s,o,h,l;if(n.pricingTier=="-9")return n.currentStep/3600*n.pricePerTier;if(n.pricingTier=="-8")return n.currentStep/1e3*n.pricePerTier;if(n.pricingTier=="-7")return i=n.pricePerTier.split(","),parseFloat(i[0])+parseFloat(n.currentStep*i[1]);if(n.pricingTier=="-5")return i=n.pricePerTier.split(","),t(".buy-configure-support .slider-caption").css("display","none"),currentSupportCaption=".buy-configure-support .caption-"+n.currentStep,t(currentSupportCaption).css("display","block"),n.currentStep>0?i[n.currentStep-1]:0;if(n.pricingTier=="-4")return n.currentStep*n.pricePerTier;if(n.pricingTier=="-3")return calculateDatabase(n.currentStep);if(n.pricingTier=="-2")return 0;if(n.pricingTier!="-1"&&(c=!1),c)return n.currentStep*n.pricePerTier;if(r=n.pricingTier,r=r.split(","),i=n.pricePerTier,i=i.split(","),(f||u)&&n.currentName!=="backup-meter1")e=n.currentStep*i[0],(i[0]==="0"||i[0]===0)&&n.currentStep>5&&(e=(n.currentStep-5)*i[1]);else for(e=0,o=0;o<r.length-1;o+=2)if(n.currentStep>=r[o]&&n.currentStep<=r[o+1])if(o>=2)for(s=o/2,e=i[s]*(n.currentStep-r[o-1]),h=o-2;h>=0;h-=2)l=r[h+1]-r[h],s=h/2,e+=i[s]*l;else s=0,e=n.currentStep*i[s];return n.basePrice&&(e=e+n.basePrice),e};refreshPricing=function(){totalPrice=0;t(".slider-div").each(function(){var i,n,r;n=1;t(this).parent().hasClass("link-master")&&(i="#"+t(this).parent().parent().attr("id")+" .link-slave .slider-div",n=t(i).data("steplocation"));r=t(this).data("excludefrommc");r||(totalPrice+=t(this).data("currentprice")*n)});checkDiscount(totalPrice);totalPrice=0;t(".slider-div").each(function(){var n=1,r=initalizeMetrics(this),e=updatePricing(r),u,f;r.excludeFromCommitment&&(u=i,i=1);t(this).data("currentprice",e);t(this).parent().hasClass("link-master")&&(f="#"+t(this).parent().parent().attr("id")+" .link-slave .slider-div",n=t(f).data("steplocation"));t(this).data("hourly")!==null&&t(this).parent().children(".slider-hourly").show().children(".value").html(costCalc(t(this).data("steplocation")*t(this).data("hourly")*i,!0,3));t(this).parent().children(".slider-total").html(costCalc(t(this).data("currentprice")*n*i,!0,2));t(this).data("tier")=="-2"&&t(this).parent().children(".slider-total").html(t(".localization-free").html());r.excludeFromTotal||(totalPrice+=t(this).data("currentprice")*n);r.excludeFromCommitment&&(o=t(this).data("currentprice")*n,i=u)});e=(totalPrice-o)*i+o;t("#buy-configure-summary").html(costCalc(e,!0,2));var c=t("#pricing-calc-buy-button").attr("href").split("?")[0],n,s="",h=1;u?r?(n="ms-azr-0038p",h=6):n="ms-azr-0037p":f?r?(n="ms-azr-0040p",h=12):n="ms-azr-0039p":n="ms-azr-0003p";u||f?e-o<500?(e=500,s="&commitmentAmount="+(e*h).toFixed(0)):s="&commitmentAmount="+((e-o)*h).toFixed(0):s="";t("#pricing-calc-buy-button").attr("href",c+"?offer="+n+s)};checkDiscount=function(n){i=1;currencyMetrics.name!="USD"&&(n=n*currencyMetrics.conversion);n>currencyMetrics.commitmentBase.firstTierLow&&(h===1?n<currencyMetrics.commitmentBase.secondTierLow?i=.8:n>currencyMetrics.commitmentBase.firstTierHigh&&n<currencyMetrics.commitmentBase.thirdTierLow?i=.77:n>currencyMetrics.commitmentBase.secondTierHigh&&(i=.73):h===2?n<currencyMetrics.commitmentBase.secondTierLow?i=.775:n>currencyMetrics.commitmentBase.firstTierHigh&&n<currencyMetrics.commitmentBase.thirdTierLow?i=.745:n>currencyMetrics.commitmentBase.thirdTierLow&&(i=.705):i=1);r&&n>=currencyMetrics.commitmentBase.firstTierLow&&(i=i-.025)};calculateDatabase=function(n){var r,i=5;return r=n==0?0:n>=1&&n<=i?4.995:n>=1+i&&n<=9+i?9.99+(n-(1+i))*3.996:n>=10+i&&n<=50+i?45.954+(n-(10+i))*1.998:125.874+(n-(50+i))*.999,n>1&&(t(".buy-configure-database .link-master .current-slider-amount").html(n-i),t(".buy-configure-database-small .current-slider-amount").html(n-i)),n>=1&&n<=i&&(t(".buy-configure-database-small .current-slider-amount").html("100"),t(".buy-configure-database-small .slider-type").html("MB"),t(".buy-configure-database .link-master .current-slider-amount").html("100"),t(".buy-configure-database .link-master .slider-type").html("MB")),r}})(window,jQuery)